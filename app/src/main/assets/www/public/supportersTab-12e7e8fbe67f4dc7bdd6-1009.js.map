{"version":3,"file":"supportersTab-12e7e8fbe67f4dc7bdd6-1009.js","mappings":"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","sources":["webpack://odysee.com/../ui/page/creatorMemberships/creatorArea/internal/supportersTab/view.jsx","webpack://odysee.com/../ui/page/creatorMemberships/creatorArea/internal/supportersTab/index.js"],"sourcesContent":["// @flow\nimport React from 'react';\nimport moment from 'moment';\n\nimport { buildURI } from 'util/lbryURI';\n\nimport ChannelThumbnail from 'component/channelThumbnail';\nimport Yrbl from 'component/yrbl';\nimport Button from 'component/button';\nimport ErrorBubble from 'component/common/error-bubble';\nimport UriIndicator from 'component/uriIndicator';\n\ntype Props = {\n  channelsToList: ?Array<ChannelClaim>,\n  switchToTiersTab: () => void,\n  // -- redux --\n  supportersList: ?SupportersList,\n  channelMembershipTiers: ?CreatorMemberships,\n  doResolveClaimIds: (claimIds: Array<string>) => void,\n  paymentsBySubscriber: { [channelId: string]: Array<MembershipPayment> }, // payments by id { [id]: [{ paymentobj }...] }\n};\n\nconst SupportersTab = (props: Props) => {\n  const {\n    channelsToList,\n    switchToTiersTab,\n    // -- redux --\n    supportersList,\n    channelMembershipTiers,\n    doResolveClaimIds,\n    paymentsBySubscriber,\n  } = props;\n\n  // const sl = [\n  //   {\n  //     subscriber_channel_name: '@iostest', || 'anonymous'\n  //     subscriber_channel_claim_id: 'b2de35a63ab37f9c4ec1c65f8135ed0306b7f67f', || ''\n  //     supported_channel_name: '@shirely',\n  //     membership_name: 'The worst',\n  //     price: 10,\n  //     currency: 'AR',\n  //     interval: 'Monthly',\n  //     joined_at: '2025-05-10T04:39:27.822Z',\n  //   },\n  // ];\n  //\n  // const supportersList = sl;\n\n  const getDateOfLastPayment = (payments) => {\n    const payment = payments.reverse().find((p) => p.status === 'submitted' || p.status === 'paid') || {};\n    if (payment.status === 'submitted') {\n      return payment.initiated_at;\n    } else {\n      return payment.completed_at;\n    }\n  };\n\n  const hasAnySupporters = React.useMemo(() => {\n    return Boolean(\n      channelsToList &&\n        channelsToList.some((channel) => {\n          const channelHasSupporters =\n            supportersList && supportersList.some((supporter) => channel.name === supporter.supported_channel_name);\n\n          return channelHasSupporters;\n        })\n    );\n  }, [channelsToList, supportersList]);\n\n  const isViewingSingleChannel = channelsToList && channelsToList.length === 1;\n\n  React.useEffect(() => {\n    if (supportersList) {\n      const supportersClaimIds = supportersList.map((channel) => channel.subscriber_channel_claim_id);\n      doResolveClaimIds(supportersClaimIds);\n    }\n  }, [supportersList, doResolveClaimIds]);\n\n  if (isViewingSingleChannel && !channelMembershipTiers) {\n    return (\n      <ErrorBubble\n        title={__(`This channel doesn't have any Tiers`)}\n        subtitle={__('To be able to begin receiving payments you have to add at least 1 Tier to your channel.')}\n        action={<Button button=\"primary\" label={__('Add a Tier')} onClick={switchToTiersTab} />}\n      />\n    );\n  }\n\n  if (!hasAnySupporters) {\n    return (\n      <Yrbl\n        title={isViewingSingleChannel ? __('This channel has no supporters yet') : __('No supporters yet')}\n        subtitle={__('Once you have supporters, they will appear here.')}\n      />\n    );\n  }\n\n  return (\n    <>\n      <div className=\"membership-table__wrapper\">\n        {channelsToList &&\n          channelsToList.map((listedChannelClaim) => {\n            const supportersForChannel = supportersList\n              ? supportersList\n                  .filter((supporter) => listedChannelClaim.name === supporter.supported_channel_name)\n                  .sort((a, b) => new Date(b.joined_at).getTime() - new Date(a.joined_at).getTime())\n              : [];\n\n            const supportersWithChannel = supportersForChannel\n              ? supportersForChannel.filter((supporter) => supporter.subscriber_channel_name !== 'anonymous')\n              : [];\n\n            const anonymousSupporters = supportersForChannel\n              ? supportersForChannel.filter((supporter) => supporter.subscriber_channel_name === 'anonymous')\n              : [];\n\n            const totalAnonSupport = anonymousSupporters.reduce((ac, cur) => {\n              const newac = ac + cur.price;\n              return newac;\n            }, 0);\n\n            return (\n              supportersWithChannel &&\n              supportersWithChannel.length > 0 && (\n                <React.Fragment key={listedChannelClaim.claim_id}>\n                  <div className=\"table-channel-header\">\n                    {(!isViewingSingleChannel || !channelMembershipTiers) && (\n                      <ChannelThumbnail xsmall uri={listedChannelClaim.canonical_url} />\n                    )}\n                    {(!isViewingSingleChannel || !channelMembershipTiers) &&\n                      (listedChannelClaim.value.title || listedChannelClaim.name)}\n                  </div>\n                  <div>\n                    {anonymousSupporters.length\n                      ? `${anonymousSupporters.length} anonymous supporters contributed $${(\n                          totalAnonSupport / 100\n                        ).toFixed(2)}!`\n                      : null}\n                  </div>\n\n                  <div className=\"membership-table__wrapper\">\n                    <table className=\"table\">\n                      <thead>\n                        <tr>\n                          <th className=\"channelName-header\" colSpan=\"2\">\n                            {__('Channel Name')}\n                          </th>\n                          <th>{__('Tier')}</th>\n                          <th>{__('Amount')}</th>\n                          <th>{__('Joined On')}</th>\n                          <th>{__('Latest Payment')}</th>\n                          <th>{__('Months Supporting')}</th>\n                        </tr>\n                      </thead>\n\n                      <tbody>\n                        {supportersWithChannel.map((supporter, i) => {\n                          const supporterUri =\n                            supporter.subscriber_channel_name === ''\n                              ? undefined\n                              : buildURI({\n                                  channelName: supporter.subscriber_channel_name,\n                                  channelClaimId: supporter.subscriber_channel_claim_id,\n                                });\n\n                          return (\n                            <tr key={i}>\n                              <td className=\"channelThumbnail\">\n                                {supporterUri ? (\n                                  <UriIndicator focusable={false} uri={supporterUri} link>\n                                    <ChannelThumbnail xsmall link uri={supporterUri} />\n                                  </UriIndicator>\n                                ) : (\n                                  // <ChannelThumbnail xsmall uri={supporterUri} />\n                                  __('Anonymous')\n                                )}\n                              </td>\n                              <td>\n                                <span dir=\"auto\" className=\"button__label\">\n                                  {supporter.subscriber_channel_name === '' ? (\n                                    __('Anonymous')\n                                  ) : (\n                                    <UriIndicator link uri={supporterUri} />\n                                  )}\n                                </span>\n                              </td>\n                              <td>{supporter.membership_name}</td>\n                              <td>${supporter.price / 100} USD / Month</td>\n                              <td>{moment(new Date(supporter.joined_at)).format('LL')}</td>\n                              <td>\n                                {paymentsBySubscriber[supporter.subscriber_channel_claim_id]\n                                  ? moment(\n                                      new Date(\n                                        getDateOfLastPayment(\n                                          paymentsBySubscriber[supporter.subscriber_channel_claim_id]\n                                        )\n                                      )\n                                    ).format('LL')\n                                  : ''}\n                              </td>\n                              <td>\n                                {/* need to put  */}\n                                {paymentsBySubscriber[supporter.subscriber_channel_claim_id] &&\n                                  paymentsBySubscriber[supporter.subscriber_channel_claim_id].filter(\n                                    (p) => p.status === 'paid' || p.status === 'submitted'\n                                  ).length}\n                              </td>\n                            </tr>\n                          );\n                        })}\n                      </tbody>\n                    </table>\n                  </div>\n                </React.Fragment>\n              )\n            );\n          })}\n      </div>\n    </>\n  );\n};\n\nexport default SupportersTab;\n","import { connect } from 'react-redux';\n\nimport { selectActiveChannelClaim } from 'redux/selectors/app';\nimport {\n  selectMySupportersList,\n  selectMembershipTiersForCreatorId,\n  selectIncomingPaymentsBySubscriber,\n} from 'redux/selectors/memberships';\nimport { doResolveClaimIds } from 'redux/actions/claims';\n\nimport SupportersTab from './view';\n\nconst select = (state) => {\n  const activeChannelClaim = selectActiveChannelClaim(state);\n\n  return {\n    channelMembershipTiers: activeChannelClaim && selectMembershipTiersForCreatorId(state, activeChannelClaim.claim_id),\n    supportersList: selectMySupportersList(state),\n    paymentsBySubscriber: selectIncomingPaymentsBySubscriber(state),\n  };\n};\n\nconst perform = {\n  doResolveClaimIds,\n};\n\nexport default connect(select, perform)(SupportersTab);\n"],"names":["props","channelsToList","switchToTiersTab","supportersList","channelMembershipTiers","doResolveClaimIds","paymentsBySubscriber","hasAnySupporters","React","Boolean","some","channel","supporter","name","supported_channel_name","isViewingSingleChannel","length","supportersClaimIds","map","subscriber_channel_claim_id","ErrorBubble","title","__","subtitle","action","Button","button","label","onClick","className","listedChannelClaim","supportersForChannel","filter","sort","a","b","Date","joined_at","getTime","supportersWithChannel","subscriber_channel_name","anonymousSupporters","totalAnonSupport","reduce","ac","cur","price","key","claim_id","ChannelThumbnail","xsmall","uri","canonical_url","value","concat","toFixed","colSpan","i","payments","payment","supporterUri","undefined","buildURI","channelName","channelClaimId","UriIndicator","focusable","link","dir","membership_name","moment","format","reverse","find","p","status","initiated_at","completed_at","Yrbl","perform","connect","state","activeChannelClaim","selectActiveChannelClaim","selectMembershipTiersForCreatorId","selectMySupportersList","selectIncomingPaymentsBySubscriber","SupportersTab"],"sourceRoot":""}