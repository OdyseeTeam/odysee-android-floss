{"version":3,"file":"featuredBanner-c72a6c68f1ffbda274be-1009.js","mappings":"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","sources":["webpack://odysee.com/../ui/component/featuredBanner/index.js","webpack://odysee.com/../ui/component/featuredBanner/view.jsx"],"sourcesContent":["import { connect } from 'react-redux';\nimport FeaturedBanner from './view';\n\nconst select = (state) => ({});\n\nconst perform = {};\n\nexport default connect(select, perform)(FeaturedBanner);\n","// @flow\nimport React from 'react';\nimport { useOnResize } from 'effects/use-on-resize';\nimport Icon from 'component/common/icon';\nimport * as ICONS from 'constants/icons';\nimport { NavLink } from 'react-router-dom';\nimport './style.lazy.scss';\n\ntype Props = {\n  homepageData: any,\n  authenticated: boolean,\n};\n\nexport default function FeaturedBanner(props: Props) {\n  const { homepageData, authenticated } = props;\n  const { featured } = homepageData;\n  const [marginLeft, setMarginLeft] = React.useState(0);\n  const [width, setWidth] = React.useState(0);\n  const [index, setIndex] = React.useState(1);\n  const [pause, setPause] = React.useState(false);\n  const [isMenuOpen, setIsMenuOpen] = React.useState(false);\n  // Use localStorage for Cordova to persist across app restarts, sessionStorage for web\n  const storage = window.cordova ? localStorage : sessionStorage;\n  const storageKey = 'bannerHidden';\n  const [localBannerHidden, setLocalBannerHidden] = React.useState(() => storage.getItem(storageKey) === 'true');\n  const wrapper = React.useRef(null);\n  const menuRef = React.useRef<?HTMLDivElement>(null);\n  const imageWidth = width >= 1600 ? 1700 : width >= 1150 ? 1150 : width >= 900 ? 900 : width >= 600 ? 600 : 400;\n\n  // Clear banner state when user logs out (for Cordova)\n  React.useEffect(() => {\n    if (window.cordova && !authenticated) {\n      // User logged out, clear the banner hidden state\n      localStorage.removeItem(storageKey);\n      setLocalBannerHidden(false);\n    }\n  }, [authenticated]);\n\n  React.useEffect(() => {\n    if (featured && width) {\n      const interval = setInterval(() => {\n        if (!pause) {\n          setIndex(index + 1 <= featured.items.length ? index + 1 : 1);\n        }\n      }, featured.transitionTime * 1000 + 1000);\n      return () => clearInterval(interval);\n    }\n  }, [featured, marginLeft, width, pause, index]);\n\n  React.useEffect(() => {\n    if (featured && width) {\n      setMarginLeft((index - 1) * (width * -1));\n    }\n  }, [featured, index, width]);\n\n  useOnResize(() => {\n    if (wrapper.current) {\n      setWidth(wrapper.current.offsetWidth);\n    }\n  });\n\n  React.useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      const node = menuRef.current;\n      if (node && event.target instanceof Node && !node.contains(event.target)) {\n        setIsMenuOpen(false);\n      }\n    };\n\n    if (isMenuOpen) {\n      document.addEventListener('click', handleClickOutside);\n    }\n\n    return () => {\n      document.removeEventListener('click', handleClickOutside);\n    };\n  }, [isMenuOpen]);\n\n  function getUriTo(uri) {\n    if (uri.includes('odysee.com')) {\n      uri = uri.substring(uri.indexOf('odysee.com') + 10);\n    }\n    let search;\n    if (uri.includes('?lid=')) {\n      search = uri.substring(uri.indexOf('?lid='));\n    }\n    return {\n      pathname: uri,\n      search: search || undefined,\n    };\n  }\n\n  function handleAnchor(e, uri) {\n    if (uri.charAt(0) !== '#') {\n      return;\n    }\n    e.preventDefault();\n    const anchor = document.getElementById(uri.substring(1));\n    if (anchor) {\n      window.scrollTo({\n        top: anchor && anchor.offsetTop,\n        behavior: 'smooth',\n      });\n    } else {\n      window.odysee.functions.history.push('$/portal/adventureaddict');\n    }\n  }\n\n  function toggleMenu(e) {\n    e.stopPropagation();\n    setIsMenuOpen(!isMenuOpen);\n  }\n\n  function removeBanner() {\n    setLocalBannerHidden(true);\n    storage.setItem(storageKey, 'true');\n    setIsMenuOpen(false);\n  }\n\n  if (localBannerHidden) return null;\n\n  return (\n    <div\n      className=\"featured-banner-wrapper\"\n      ref={wrapper}\n      onMouseEnter={() => setPause(true)}\n      onMouseLeave={() => setPause(false)}\n    >\n      <div className=\"featured-banner-rotator\" style={{ marginLeft: marginLeft }}>\n        {featured &&\n          featured.items.map((item, i) => {\n            return (\n              <NavLink\n                className=\"featured-banner-image\"\n                onClick={(e) => handleAnchor(e, item.url)}\n                to={getUriTo(item.url)}\n                target={!item.url.includes('odysee.com') ? '_blank' : undefined}\n                title={item.label}\n                key={i}\n                style={{ minWidth: width }}\n              >\n                <img\n                  src={'https://thumbnails.odycdn.com/optimize/s:' + imageWidth + ':0/quality:95/plain/' + item.image}\n                  style={{ width: width }}\n                />\n              </NavLink>\n            );\n          })}\n      </div>\n      <div className=\"banner-controls\">\n        <div className=\"banner-browse left\" onClick={() => setIndex(index > 1 ? index - 1 : featured.items.length)}>\n          ‹\n        </div>\n        <div className=\"banner-browse right\" onClick={() => setIndex(index < featured.items.length ? index + 1 : 1)}>\n          ›\n        </div>\n        <div className=\"banner-active-indicator\">\n          {featured &&\n            featured.items.map((item, i) => {\n              return (\n                <div\n                  key={i}\n                  className={i + 1 === index ? 'banner-active-indicator-active' : ''}\n                  onClick={() => setIndex(i + 1)}\n                />\n              );\n            })}\n        </div>\n        {authenticated && (\n          <div className=\"banner-context-menu\" ref={menuRef}>\n            <button className=\"banner-menu-button\" onClick={toggleMenu} aria-label=\"More options\">\n              <Icon icon={ICONS.MORE} />\n            </button>\n            {isMenuOpen && (\n              <div className=\"banner-menu-dropdown\">\n                <button className=\"banner-menu-item\" onClick={removeBanner}>\n                  Close the banner\n                </button>\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":["connect","state","props","homepageData","authenticated","featured","_React$useState2","_slicedToArray","React","marginLeft","setMarginLeft","_React$useState4","width","setWidth","_React$useState6","index","setIndex","_React$useState8","pause","setPause","_React$useState10","isMenuOpen","setIsMenuOpen","storage","window","cordova","localStorage","sessionStorage","storageKey","_React$useState12","getItem","localBannerHidden","setLocalBannerHidden","wrapper","menuRef","imageWidth","removeItem","interval","setInterval","items","length","transitionTime","clearInterval","useOnResize","current","offsetWidth","handleClickOutside","event","node","target","Node","contains","document","addEventListener","removeEventListener","className","ref","onMouseEnter","onMouseLeave","style","map","item","i","NavLink","onClick","e","uri","charAt","preventDefault","anchor","getElementById","substring","scrollTo","top","offsetTop","behavior","odysee","functions","history","push","handleAnchor","url","to","includes","indexOf","search","pathname","undefined","title","label","key","minWidth","src","image","stopPropagation","Icon","icon","ICONS","setItem"],"sourceRoot":""}