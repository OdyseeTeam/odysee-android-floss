{"version":3,"file":"featuredBanner-3620cf06af07dac6d6b0.js","mappings":"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","sources":["webpack://odysee.com/../ui/component/featuredBanner/index.js","webpack://odysee.com/../ui/component/featuredBanner/view.jsx"],"sourcesContent":["import { connect } from 'react-redux';\nimport * as SETTINGS from 'constants/settings';\nimport { selectClientSetting } from 'redux/selectors/settings';\nimport { doSetClientSetting } from 'redux/actions/settings';\nimport FeaturedBanner from './view';\n\nconst select = (state) => ({\n  homepageOrder: selectClientSetting(state, SETTINGS.HOMEPAGE_ORDER),\n});\n\nconst perform = {\n  doSetClientSetting,\n};\n\nexport default connect(select, perform)(FeaturedBanner);\n","// @flow\nimport React from 'react';\nimport { useOnResize } from 'effects/use-on-resize';\nimport Icon from 'component/common/icon';\nimport * as ICONS from 'constants/icons';\nimport * as SETTINGS from 'constants/settings';\nimport classnames from 'classnames';\nimport { NavLink } from 'react-router-dom';\nimport { useHistory } from 'react-router';\nimport './style.lazy.scss';\n\ntype HomepageOrder = { active: ?Array<string>, hidden: ?Array<string> };\n\ntype Props = {\n  homepageData: any,\n  homepageOrder: HomepageOrder,\n  authenticated: boolean,\n  // --- perform ---\n  doSetClientSetting: (key: string, value: any, push: boolean) => void,\n};\n\nexport default function FeaturedBanner(props: Props) {\n  const { homepageData, homepageOrder, authenticated, doSetClientSetting } = props;\n  const { featured, categories } = homepageData;\n  const [marginLeft, setMarginLeft] = React.useState(0);\n  const [width, setWidth] = React.useState(0);\n  const [index, setIndex] = React.useState(1);\n  const [pause, setPause] = React.useState(false);\n  const [kill, setKill] = React.useState(false);\n  const wrapper = React.useRef(null);\n  const imageWidth = width >= 1600 ? 1700 : width >= 1150 ? 1150 : 900;\n  const { push } = useHistory();\n\n  React.useEffect(() => {\n    if (featured && width) {\n      const interval = setInterval(() => {\n        if (!pause) {\n          setIndex(index + 1 <= featured.items.length ? index + 1 : 1);\n        }\n      }, featured.transitionTime * 1000 + 1000);\n      return () => clearInterval(interval);\n    }\n  }, [featured, marginLeft, width, pause, index]);\n\n  React.useEffect(() => {\n    if (featured && width) {\n      setMarginLeft((index - 1) * (width * -1));\n    }\n  }, [featured, index, width]);\n\n  useOnResize(() => {\n    if (wrapper.current) {\n      setWidth(wrapper.current.offsetWidth);\n    }\n  });\n\n  function getUriTo(uri) {\n    if (uri.includes('odysee.com')) {\n      uri = uri.substring(uri.indexOf('odysee.com') + 10);\n    }\n    let search;\n    if (uri.includes('?lid=')) {\n      search = uri.substring(uri.indexOf('?lid='));\n    }\n    return {\n      pathname: uri,\n      search: search || undefined,\n    };\n  }\n\n  function handleAnchor(e, uri) {\n    if (uri.charAt(0) !== '#') {\n      return;\n    }\n    e.preventDefault();\n    const anchor = document.getElementById(uri.substring(1));\n    if (anchor) {\n      window.scrollTo({\n        top: anchor && anchor.offsetTop,\n        behavior: 'smooth',\n      });\n    } else {\n      push('$/portal/adventureaddict');\n    }\n  }\n\n  const NON_CATEGORY = Object.freeze({\n    BANNER: { label: 'Banner' },\n    FOLLOWING: { label: 'Following' },\n    PORTALS: { label: 'Portals' },\n    FYP: { label: 'Recommended' },\n  });\n\n  function getInitialList(listId, savedOrder, homepageSections) {\n    const savedActiveOrder = savedOrder.active || [];\n    const savedHiddenOrder = savedOrder.hidden || [];\n    const sectionKeys = Object.keys(homepageSections);\n\n    let activeOrder: Array<string> = savedActiveOrder.filter((x) => sectionKeys.includes(x));\n    let hiddenOrder: Array<string> = savedHiddenOrder.filter((x) => sectionKeys.includes(x));\n\n    sectionKeys.forEach((key: string) => {\n      if (!activeOrder.includes(key) && !hiddenOrder.includes(key)) {\n        if (homepageSections[key].hideByDefault) {\n          hiddenOrder.push(key);\n        } else {\n          if (key === 'BANNER') {\n            // Skip\n          } else if (key === 'PORTALS') {\n            activeOrder.splice(2, 0, key);\n          } else {\n            activeOrder.push(key);\n          }\n        }\n      }\n    });\n    activeOrder = activeOrder.filter((x) => !hiddenOrder.includes(x));\n    return listId === 'ACTIVE' ? activeOrder : hiddenOrder;\n  }\n\n  function removeBanner() {\n    let orderToSave = homepageOrder;\n    if (orderToSave.active && orderToSave.active.includes('BANNER')) {\n      orderToSave.active.splice(orderToSave.active.indexOf('BANNER'), 1);\n      if (orderToSave.hidden) {\n        orderToSave.hidden.push('BANNER');\n      }\n    } else if (!orderToSave.hidden) {\n      const SECTIONS = { ...NON_CATEGORY, ...categories };\n      orderToSave = { active: [], hidden: [] };\n      orderToSave.active = getInitialList('ACTIVE', homepageOrder, SECTIONS);\n      orderToSave.hidden = getInitialList('HIDDEN', homepageOrder, SECTIONS);\n      orderToSave.hidden.push('BANNER');\n    } else if (orderToSave.hidden && !orderToSave.hidden.includes('BANNER')) {\n      orderToSave.hidden.push('BANNER');\n    }\n    doSetClientSetting(SETTINGS.HOMEPAGE_ORDER, orderToSave, true);\n    setKill(true);\n  }\n\n  return (\n    <div\n      className={classnames('featured-banner-wrapper', { kill: kill })}\n      ref={wrapper}\n      onMouseEnter={() => setPause(true)}\n      onMouseLeave={() => setPause(false)}\n    >\n      <div className=\"featured-banner-rotator\" style={{ marginLeft: marginLeft }}>\n        {featured &&\n          featured.items.map((item, i) => {\n            return (\n              <NavLink\n                className=\"featured-banner-image\"\n                onClick={(e) => handleAnchor(e, item.url)}\n                to={getUriTo(item.url)}\n                target={!item.url.includes('odysee.com') ? '_blank' : undefined}\n                title={item.label}\n                key={i}\n                style={{ minWidth: width }}\n              >\n                <img\n                  src={'https://thumbnails.odycdn.com/optimize/s:' + imageWidth + ':0/quality:95/plain/' + item.image}\n                  style={{ width: width }}\n                />\n              </NavLink>\n            );\n          })}\n      </div>\n      <div className=\"banner-controls\">\n        <div className=\"banner-browse left\" onClick={() => setIndex(index > 1 ? index - 1 : featured.items.length)}>\n          ‹\n        </div>\n        <div className=\"banner-browse right\" onClick={() => setIndex(index < featured.items.length ? index + 1 : 1)}>\n          ›\n        </div>\n        <div className=\"banner-active-indicator\">\n          {featured &&\n            featured.items.map((item, i) => {\n              return (\n                <div\n                  key={i}\n                  className={i + 1 === index ? 'banner-active-indicator-active' : ''}\n                  onClick={() => setIndex(i + 1)}\n                />\n              );\n            })}\n        </div>\n        {authenticated && (\n          <div className=\"featured-banner-remove\" onClick={() => removeBanner()}>\n            <Icon icon={ICONS.REMOVE} />\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":["perform","doSetClientSetting","connect","state","homepageOrder","selectClientSetting","SETTINGS","props","homepageData","authenticated","featured","categories","_React$useState2","_slicedToArray","React","marginLeft","setMarginLeft","_React$useState4","width","setWidth","_React$useState6","index","setIndex","_React$useState8","pause","setPause","_React$useState10","kill","setKill","wrapper","imageWidth","push","useHistory","interval","setInterval","items","length","transitionTime","clearInterval","useOnResize","current","offsetWidth","NON_CATEGORY","Object","freeze","BANNER","label","FOLLOWING","PORTALS","FYP","getInitialList","listId","savedOrder","homepageSections","savedActiveOrder","active","savedHiddenOrder","hidden","sectionKeys","keys","activeOrder","filter","x","includes","hiddenOrder","forEach","key","hideByDefault","splice","className","classnames","ref","onMouseEnter","onMouseLeave","style","map","item","i","NavLink","onClick","e","uri","charAt","preventDefault","anchor","document","getElementById","substring","window","scrollTo","top","offsetTop","behavior","handleAnchor","url","to","indexOf","search","pathname","undefined","target","title","minWidth","src","image","orderToSave","SECTIONS","_objectSpread","removeBanner","Icon","icon","ICONS"],"sourceRoot":""}