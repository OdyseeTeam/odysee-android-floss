/*! For license information please see comments-6669746b50beb524b71c-1009.js.LICENSE.txt */
"use strict";(self.webpackChunkodysee_com=self.webpackChunkodysee_com||[]).push([[8324,740],{93148:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Te});var r=n(24582),o=n(9767),a=n(7920),i=n(1987),c=n(17185),l=n(86102),u=n(33441),s=n(88374),m=n(29454),d=n(58210),f=n(70897),h=n(20983),p=n(86189),v=n(27086),b=n(81352),y=n(26617),g=n(88441),E=n(63400),C=n(10995),_=n(94720),S=n(15244),w=n(16395),O=n(16643),I=n(77369),T=n(21506),k=n(73249),A=n(17526),N=n(44908),L=n(66598),j=n.n(L),x=n(6922),R=n(29679),M=n(19775),P=n(95810),F=n(20206),U=n(69719),B=n(15184),D=n(91960),Z=n(71036).__,Y=["isReviewingStickerComment","disabled"];function H(){return H=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},H.apply(this,arguments)}function G(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var W=function(e){var t=e.activeChannelUrl,n=e.src,r=e.price,o=e.exchangeRate;return g.createElement("div",{className:"comment-create__sticker-preview"},g.createElement("div",{className:"comment-create__sticker-preview__info"},g.createElement(B.Z,{xsmall:!0,uri:t}),g.createElement(D.Z,{uri:t,link:!0,showAtSign:!0})),g.createElement("div",{className:"comment-create__sticker-preview__image"},g.createElement(U.Z,{src:n,waitLoad:!0,loading:"lazy"})),Boolean(r&&o)&&g.createElement(F.Z,{customPrices:{priceFiat:r,priceLBC:0!==Number(o)?r/Number(o):0},isFiat:!0}))},z=function(e){var t=e.isReviewingStickerComment,n=e.disabled,r=G(e,Y);return g.createElement(N.default,H({disabled:n},r,{title:Z("Stickers"),label:t?Z("Change"):void 0}))},$=n(68470),q=n(25542),V=["name","tab","activeTab","tipSelectorOpen","onClick"];function K(){return K=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},K.apply(this,arguments)}function J(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var Q=function(e){var t=e.activeChannelUrl,n=e.tipAmount,r=e.activeTab,o=e.message,a=e.isReviewingStickerComment,i=e.stickerPreviewComponent;return g.createElement("div",{className:"comment-create__support-comment-preview"},g.createElement($.Z,{amount:n,className:"comment-create__support-comment-preview__amount",isFiat:r===q.tA,size:2}),a?i:g.createElement(g.Fragment,null,g.createElement(B.Z,{xsmall:!0,uri:t}),g.createElement("div",null,g.createElement(D.Z,{uri:t,link:!0,showAtSign:!0}),g.createElement("div",null,o))))},X=function(e){var t=e.name,n=e.tab,r=e.activeTab,o=e.tipSelectorOpen,a=e.onClick,i=J(e,V);return(!o||r!==n)&&g.createElement(N.default,K({},i,{title:t,label:o?t:void 0,onClick:function(){return a(n)}}))},ee=n(32158),te=n(96284),ne=n(71036).__;const re=function(e){var t=e.fetchingChannels,n=e.myChannelClaims,r=void 0===n?[]:n,o=e.label,a=e.injected,i=void 0===a?[]:a,c=e.tiny,l=e.activeChannelClaimId,u=e.setActiveChannel;return g.createElement(g.Fragment,null,g.createElement(_.Wi,{name:"channel",label:!c&&(o||ne("Channel")),labelOnLeft:c,type:c?"select-tiny":"select",onChange:function(e){var t=e.target.value;u(t)},value:l,disabled:t},t?g.createElement("option",null,ne("Loading your channels...")):g.createElement(g.Fragment,null,r&&r.map((function(e){var t=e.name,n=e.claim_id;return g.createElement("option",{key:n,value:n},t)})),i&&i.map((function(e){return g.createElement("option",{key:e,value:e},e)})))))};var oe={setActiveChannel:f.ds};const ae=(0,r.$j)((function(e){return{myChannelClaims:(0,a.rtR)(e),fetchingChannels:(0,a.Y7j)(e),activeChannelClaimId:(0,s.zA)(e)}}),oe)(re);var ie=n(71036).__,ce=function(e){var t=e.isReply,n=e.isLivestream;return g.createElement("div",{className:"comment-create__label-wrapper"},g.createElement("span",{className:"comment-create__label"},ie(t?"Replying as":n?"Chat as":"Comment as")+" "),g.createElement(ae,{tiny:!0}))},le=function(e){var t=e.deletedComment,n=e.minAmount,r=e.minTip,o=e.minSuper,a=e.minUSDAmount,i=e.minUSDSuper,c=e.minUSDTip;return g.createElement(g.Fragment,null,t&&g.createElement("div",{className:"error__text"},ie("This comment has been deleted.")),(!!n||!!a)&&g.createElement("div",{className:"help--notice comment-create__min-amount-notice"},g.createElement("span",null,ie(r||c?"Comment minimum: ":"HyperChat minimum: ")),(!!r||!!o||!!c||!!i)&&g.createElement(g.Fragment,null,g.createElement(ee.Z,{tokens:{usd:g.createElement($.Z,{noFormat:!0,isFiat:!0,amount:a||.01})}},"%usd%")),g.createElement(te.default,{customTooltipText:r||c?ie("This channel requires a minimum tip for each comment."):o||i?ie("This channel requires a minimum amount for HyperChats to be visible."):"",className:"icon--help",icon:I.HELP,tooltip:!0,size:16})))},ue=n(85442),se=n(58680),me=n(10603),de=n(2320),fe=n(71036).__;function he(e){return he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},he(e)}function pe(){pe=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function u(e,t,n,o){var a=t&&t.prototype instanceof d?t:d,i=Object.create(a.prototype),c=new O(o||[]);return r(i,"_invoke",{value:C(e,n,c)}),i}function s(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var m={};function d(){}function f(){}function h(){}var p={};l(p,a,(function(){return this}));var v=Object.getPrototypeOf,b=v&&v(v(I([])));b&&b!==t&&n.call(b,a)&&(p=b);var y=h.prototype=d.prototype=Object.create(p);function g(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function o(r,a,i,c){var l=s(e[r],e,a);if("throw"!==l.type){var u=l.arg,m=u.value;return m&&"object"==he(m)&&n.call(m,"__await")?t.resolve(m.__await).then((function(e){o("next",e,i,c)}),(function(e){o("throw",e,i,c)})):t.resolve(m).then((function(e){u.value=e,i(u)}),(function(e){return o("throw",e,i,c)}))}c(l.arg)}var a;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){o(e,n,t,r)}))}return a=a?a.then(r,r):r()}})}function C(e,t,n){var r="suspendedStart";return function(o,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw a;return T()}for(n.method=o,n.arg=a;;){var i=n.delegate;if(i){var c=_(i,n);if(c){if(c===m)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=s(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function _(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=s(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,m;var a=o.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,m):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function I(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:T}}function T(){return{value:void 0,done:!0}}return f.prototype=h,r(y,"constructor",{value:h,configurable:!0}),r(h,"constructor",{value:f,configurable:!0}),f.displayName=l(h,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,l(e,c,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},g(E.prototype),l(E.prototype,i,(function(){return this})),e.AsyncIterator=E,e.async=function(t,n,r,o,a){void 0===a&&(a=Promise);var i=new E(u(t,n,r,o),a);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},g(y),l(y,c,"Generator"),l(y,a,(function(){return this})),l(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=I,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return i.type="throw",i.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),w(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;w(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:I(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),m}},e}function ve(e,t,n,r,o,a,i){try{var c=e[a](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,o)}function be(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){ve(a,r,o,i,c,"next",e)}function c(e){ve(a,r,o,i,c,"throw",e)}i(void 0)}))}}function ye(){return ye=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ye.apply(this,arguments)}function ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ge(Object(n),!0).forEach((function(t){Ce(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ce(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==he(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==he(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===he(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _e(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Se(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Se(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Se(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var we=(0,me.F8)();var Oe=n(30407),Ie={doCommentCreate:c.hR,doFetchCreatorSettings:c.B3,doFetchMyCommentedChannels:c.cB,doToast:u.QJ,doCommentById:c.pf,doSendCashTip:l.Ai,doSendTip:l.T0,doOpenModal:f.DG,doTipAccountCheckForUri:v.zj,doArTip:y.p};const Te=(0,r.$j)((function(e,t){var n=t.uri,r=(0,a.B0y)(e,n),c=r||{},l=c.claim_id,u=c.name,f=c.signing_channel,v=(0,d._I)(r),y=f?f.name:u,g=(0,s.YG)(e)||{},E=g.claim_id,C=g.name,_=g.canonical_url,S=(0,p.lX)(e,v),w="active"===(null==S?void 0:S.status)&&(null==S?void 0:S.default);return{activeChannelClaimId:E,activeChannelName:C,activeChannelUrl:_,channelClaimId:v,chatCommentsRestrictedToChannelMembers:Boolean((0,a.zIM)(e,n)),claimId:l,claimIsMine:(0,a.pDP)(e,r),hasChannels:(0,a.nkX)(e),isFetchingChannels:(0,a.Y7j)(e),isFetchingCreatorSettings:(0,m.$1)(e),myChannelClaimIds:(0,a.Pgl)(e),myCommentedChannelIds:(0,m.BA)(e,null==r?void 0:r.claim_id),preferredCurrency:(0,h.PJ)(e),channelSettings:e.comments.settingsByChannelId[v],supportDisabled:(0,a.YU7)(n,i.Zc)(e),tipChannelName:y,userHasMembersOnlyChatPerk:(0,b.Vo)(e,v),commentSettingDisabled:(0,m.Yn)(e,v),isLivestreamChatMembersOnly:Boolean((0,m._b)(e,v)),areCommentsMembersOnly:Boolean((0,m.uy)(e,v)),hasPremiumPlus:(0,o.WE)(e),recipientArweaveTipInfo:(0,p.lX)(e,v),arweaveTippingError:(0,Oe.O5)(e,v),canReceiveTips:w}}),Ie)((function(e){var t,n=e.activeChannelClaimId,r=e.activeChannelName,o=e.activeChannelUrl,a=e.bottom,i=e.recipientArweaveTipInfo,c=e.canReceiveTips,l=e.channelClaimId,u=e.claimId,s=e.claimIsMine,m=e.disableInput,d=e.doCommentById,f=e.doCommentCreate,h=e.doFetchCreatorSettings,p=e.doFetchMyCommentedChannels,v=e.doOpenModal,b=e.doSendCashTip,y=e.doArTip,L=e.doTipAccountCheckForUri,F=e.doToast,U=e.embed,B=e.hasChannels,D=e.isFetchingChannels,Z=e.isFetchingCreatorSettings,Y=e.isLivestream,H=e.isNested,G=e.isReply,$=e.myChannelClaimIds,V=e.myCommentedChannelIds,K=e.onCancelReplying,J=e.onDoneReplying,ee=e.onSlimInputClose,te=e.parentId,ne=e.preferredCurrency,re=e.setQuickReply,oe=e.channelSettings,ae=e.shouldFetchComment,ie=e.supportDisabled,me=e.textInjection,he=e.tipChannelName,ve=e.uri,ge=e.commentSettingDisabled,Ce=e.userHasMembersOnlyChatPerk,Se=e.isLivestreamChatMembersOnly,Oe=e.areCommentsMembersOnly,Ie=e.hasPremiumPlus,Te=e.arweaveTippingError,ke=(0,de.i)().activeArStatus,Ae=null===(t=g.useContext(se.Il))||void 0===t?void 0:t.uri,Ne=(0,P.dD)(),Le=g.useRef(),je=g.useRef(),xe=g.useRef(),Re=(0,O.useHistory)(),Me=Re.push,Pe=Re.location.pathname,Fe=_e(g.useState(!1),2),Ue=Fe[0],Be=Fe[1],De=_e(g.useState(!1),2),Ze=De[0],Ye=De[1],He=_e(g.useState({txid:void 0,tipAmount:void 0}),2),Ge=He[0],We=He[1],ze=_e(g.useState(),2),$e=ze[0],qe=ze[1],Ve=_e(g.useState(),2),Ke=Ve[0],Je=Ve[1],Qe=_e(g.useState(),2),Xe=Qe[0],et=Qe[1],tt=_e(g.useState(),2),nt=tt[0],rt=tt[1],ot=_e(g.useState(1),2),at=ot[0],it=ot[1],ct=_e(g.useState(""),2),lt=ct[0],ut=ct[1],st=_e((0,R.Z)("comment-editor-mode",!1),2),mt=st[0],dt=st[1],ft=_e(g.useState(),2),ht=ft[0],pt=ft[1],vt=_e(g.useState(),2),bt=vt[0],yt=vt[1],gt=_e(g.useState(!1),2),Et=gt[0],Ct=gt[1],_t=_e(g.useState({tab:void 0,open:!1}),2),St=_t[0],wt=_t[1],Ot=_e(g.useState(),2),It=Ot[0],Tt=Ot[1],kt=_e(g.useState(),2),At=kt[0],Nt=kt[1],Lt=_e(g.useState(void 0),2),jt=Lt[0],xt=Lt[1],Rt=lt?lt.length:0,Mt=!lt.length&&!nt,Pt=oe&&oe.min_tip_amount_super_chat||0,Ft=oe&&oe.min_tip_amount_comment||0,Ut=Ft||Pt||0,Bt=oe&&oe.min_usdc_tip_amount_super_chat||0,Dt=oe&&oe.min_usdc_tip_amount_comment||0,Zt=Dt||Bt||0,Yt=Ut>0?.01:0,Ht=ht===q.tA,Gt=s||(Ht?at>=(Zt||Yt):!(Dt||Ft)),Wt=nt&&nt.price,zt=bt||It,$t=ge||Et||Ue||D||Z||Mt||!Gt||m,qt=g.useRef(Zt);qt.current=Zt;var Vt=g.useCallback((function(e){ut((function(t){return t+(t&&" "!==t.charAt(t.length-1)?" ".concat(e," "):"".concat(e," "))}))}),[]),Kt=g.useCallback((function(e){rt(e),et(!0),it(e.price||0),wt((function(e){return{tab:e.tab||void 0,open:!1}})),ee&&ee(),e.price&&e.price>0&&(pt(q.tA),qe(!0))}),[ee]),Jt=g.useMemo((function(){return{claimIsMine:s,addEmoteToComment:Vt,handleSelectSticker:Kt,isOpen:St.open,openTab:St.tab||void 0}}),[s,Vt,Kt,St.open,St.tab]),Qt={button:"primary",type:"submit",requiresAuth:!0},Xt={button:"alt"},en=Ee(Ee({},Xt),{},{disabled:!lt.length&&!nt,tipSelectorOpen:$e,activeTab:ht,onClick:cn}),tn={button:"link",label:fe("Cancel")},nn={activeChannelUrl:o,src:nt?nt.url:"",price:nt?nt.price:0,exchangeRate:At},rn=g.useMemo((function(){return g.createElement(x.Z,ye({},Jt,{closeSelector:function(){return wt((function(e){return{tab:e.tab||void 0,open:!1}}))}}))}),[Jt]);function on(){return!(u&&!l)&&(l&&h(l).then((function(e){return Y?e.livestream_chat_members_only:e.comments_members_only})).catch((function(){})))}function an(){return v(A.Vl,{uri:ve,fileUri:Ae})}function cn(e){pt(e),Ne?(xt(!0),v(A.hj,{uri:ve,isTipOnly:!0,hasSelectedTab:e,customText:fe("Preview Comment Tip"),setAmount:function(e,t){pt(t),it(e),Je(!0)}})):qe(!0),ee&&ee()}var ln=function(){if(ht===q.tA)return 100*at};function un(){return sn.apply(this,arguments)}function sn(){return(sn=be(pe().mark((function e(){var t;return pe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:if(l){e.next=5;break}return F({message:fe("Unable to verify channel settings. Try refreshing the page."),isError:!0}),e.abrupt("return");case 5:return e.next=7,on();case 7:if(void 0!==(t=e.sent)){e.next=11;break}return F({message:fe("Unable to send the comment."),subMessage:fe("Try again later, or refresh the page."),isError:!0}),e.abrupt("return");case 11:if(!hn||!t){e.next=13;break}return e.abrupt("return",an());case 13:if(!Ze||at!==Ge.tipAmount){e.next=18;break}return dn(Ge.txid),e.abrupt("return");case 18:We({txid:void 0,tipAmount:void 0});case 19:h(l).then((function(){var e=Zt,t=qt.current;if(ht===q.tA&&e!==t)return F({message:fe("The creator just updated the minimum setting. Please revise or double-check your tip amount."),isError:!0}),void Je(!1);ht!==q.tA?dn(void 0,void 0,void 0,void 0,!0).then((function(e){"success"===e?mn():Be(!1)})):mn()})).catch((function(){F({message:fe("Unable to send the comment."),subMessage:fe("Try again later, or refresh the page."),isError:!0})}));case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function mn(){if(u&&l&&r&&n&&!Ue&&he)if(Be(!0),ht===q.tA){var e=i&&i.address,t=ht===q.tA?"AR":"USD",o={tipAmountTwoPlaces:Math.round(100*at)/100,tipChannelName:he,channelClaimId:l,recipientAddress:e,currency:t},a={activeChannelName:r,activeChannelId:n},c={comment:lt,claim_id:u,parent_id:te,txid:void 0,payment_tx_id:ht===q.tA?"dummy_txid":void 0,environment:we,sticker:!1,is_protected:Boolean(Se||Oe),amount:ln(),currency:t,dry_run:!0};f(ve,Y,c).then((function(e){e&&e.signature&&y(o,false,a,u,we).then((function(e){if(e.error)throw new Error(e.error);var t=e.transactionId,n=Object.assign({},c);n.payment_tx_id=t,n.dryrun=void 0,n.amount=at,dn(null,null,t,we),ut(""),Je(!1),qe(!1),Ye(!1),Be(!1)})).catch((function(e){F({message:fe("Tip failed to send."),subMessage:(null==e?void 0:e.message)||e,isError:!0}),Be(!1)}))})).catch((function(e){F({message:fe("Comment failed to send."),subMessage:(null==e?void 0:e.message)||e,isError:!0}),console.log("do commentcreate e",e),Be(!1)}))}else{var s={tipAmount:Math.round(100*at)/100,tipChannelName:he,channelClaimId:l};b(s,!1,{activeChannelName:r,activeChannelId:n},u,we,ne,(function(e){dn(null,e.payment_intent_id,null,we),ut(""),Je(!1),qe(!1),Ye(!1),Be(!1)}))}}function dn(e,t,n,r){return fn.apply(this,arguments)}function fn(){return fn=be(pe().mark((function e(t,n,r,o){var a,i,c,s=arguments;return pe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=s.length>4&&void 0!==s[4]&&s[4],!Ue&&!m&&u){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,on();case 5:if(void 0!==(i=e.sent)){e.next=9;break}return F({message:fe("Unable to send the comment."),subMessage:fe("Try again later, or refresh the page."),isError:!0}),e.abrupt("return");case 9:if(!hn||!i){e.next=11;break}return e.abrupt("return",an());case 11:return Be(!0),c=nt&&(0,E.m9)(nt.name),e.abrupt("return",f(ve,Y,{comment:c||lt,claim_id:u,parent_id:te,txid:t,payment_intent_id:n,payment_tx_id:r,environment:o,sticker:!!c,is_protected:Boolean(Se||Oe),amount:t||n||r?ln():void 0,currency:"AR",dry_run:a}).then((function(e){if(Be(!1),a)return e.comment_id?"success":"fail";re&&re(e),e&&e.signature&&(c||ut(""),Je(!1),qe(!1),Ye(!1),J&&J())})).catch((function(){Be(!1),a||(Ye(!0),l&&h(l).catch((function(){})))})));case 14:case"end":return e.stop()}}),e)}))),fn.apply(this,arguments)}g.useEffect((function(){!oe&&l&&h(l).catch((function(){}))}),[]),g.useEffect((function(){Ne&&St.tab&&xe&&xe.current&&xe.current.click()}),[Ne,St.tab]),g.useEffect((function(){ae&&d&&d(te,!1).then((function(e){Ct(String(e).includes("Error"))}))}),[d,ae,te]),g.useEffect((function(){Wt&&!At&&S.Lbryio.getExchangeRates().then((function(e){var t=e.LBC_USD;return Nt(t)}))}),[At,Wt]),g.useEffect((function(){void 0===i&&L(ve)}),[i,L,ve]),g.useEffect((function(){function e(e){var t=Le&&Le.current&&Le.current.input;if(t&&t.current===document.activeElement){var n=Boolean(e.target.attributes["typing-term"]);(Y&&!n||e.ctrlKey||e.metaKey)&&e.keyCode===T.K5&&(e.preventDefault(),je.current.click()),Y&&n&&e.keyCode===T.K5&&t.current.removeAttribute("typing-term")}}return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}),[Y]),g.useEffect((function(){void 0===V&&u&&$&&p(u)}),[u,V,$]),g.useEffect((function(){var e,t,n;if(me)return ut(""===lt||" "===lt.substring(lt.length-1)?lt+me+" ":lt+" "+me+" "),null==Le||null===(e=Le.current)||void 0===e||null===(t=e.input)||void 0===t||null===(n=t.current)||void 0===n?void 0:n.focus()}),[me]);var hn=Boolean((Y?Se:Oe)&&!Ce&&!s),pn="Say something about this...";return hn&&(pn="The creator has made this chat members-only"),D||B?g.createElement(g.Fragment,null,hn&&g.createElement(ue.Z,{title:fe(Y?"This chat is in members-only mode":"This comment section is in members-only mode"),className:"comment-restriction",subtitle:fe("To participate, consider buying a membership with the members-only chat perk from this creator!"),action:g.createElement(N.default,{button:"primary",label:fe("Join"),onClick:an})}),g.createElement(_.l0,{onSubmit:function(){},className:j()("comment-create",{"comment-create--reply":G,"comment-create--nestedReply":H,"comment-create--bottom":a})},Ke?o&&ht&&g.createElement(g.Fragment,null,g.createElement(Q,{activeChannelUrl:o,tipAmount:at,activeTab:ht,message:lt,isReviewingStickerComment:Xe,stickerPreviewComponent:nt&&g.createElement(W,nn)}),Te&&g.createElement("div",{className:"error"},Te)):nt?o&&g.createElement(W,nn):g.createElement(g.Fragment,null,g.createElement(_.Wi,{autoFocus:G,charCount:Rt,className:j()("",{create__reply:G,create__comment:!G,disabled_chat_comments:hn}),disabled:D||m,isLivestream:Y,label:g.createElement(ce,{isReply:Boolean(G),isLivestream:Boolean(Y)}),noticeLabel:(Ne||Y)&&g.createElement(le,{minAmount:Ut,minTip:Ft,minSuper:Pt,deletedComment:Et,minUSDAmount:Zt,minUSDSuper:Bt,minUSDTip:Dt}),name:G?"create__reply":"create__comment",onChange:function(e){return ut(w.SIMPLE_SITE||!mt||G?e.target.value:e)},handleTip:function(){return cn(q.tA)},handleSubmit:dn,slimInput:Ne&&ve,slimInputButtonRef:xe,onSlimInputClose:ee,commentSelectorsProps:Jt,submitButtonRef:je,setShowSelectors:wt,showSelectors:St,tipModalOpen:jt,placeholder:fe(pn),quickActionHandler:w.SIMPLE_SITE?void 0:function(){return dt(!mt)},quickActionLabel:!w.SIMPLE_SITE&&(G?void 0:fe(mt?"Simple Editor":"Advanced Editor")),ref:Le,textAreaMaxLength:Y?C.sW:C.jT,type:w.SIMPLE_SITE||!mt||G?"textarea":"markdown",value:lt,uri:ve}),!Ne&&rn),(!Ne||Xe)&&($e||Xe&&Wt)&&g.createElement(M.Z,{activeTab:q.tA,amount:at,uri:ve,customTipAmount:Wt,exchangeRate:At,fiatConversion:nt&&!!nt.price,onChange:function(e){return it(e)},setDisableSubmitButton:Tt,setTipError:yt,tipError:bt,isComment:!0}),(!Ne||Xe||Ke)&&g.createElement("div",{className:"section__actions"},Ke&&g.createElement(g.Fragment,null,ht===q.tA&&g.createElement(N.default,ye({},Qt,{autoFocus:!0,disabled:$t||!Gt,label:Ue?fe("Sending..."):Ze&&at===Ge.tipAmount?fe("Re-submit"):fe("Send"),onClick:un}))),!Ke&&g.createElement(g.Fragment,null,$e?g.createElement(N.default,ye({},Qt,{disabled:$t||zt||!Gt||!c,icon:I.USD,label:fe("Review"),onClick:function(){Je(!0),ee&&ee()}})):g.createElement(g.Fragment,null,(!Ne||nt)&&(!Dt||s)&&g.createElement(N.default,ye({},Qt,{ref:je,disabled:$t,label:fe(Y?Ue?"Sending...":"Send --[button to send chat message]--":G?Ue?"Replying...":"Reply":Ue?"Commenting...":"Comment --[button to submit something]--"),onClick:function(){return nt?(Ke?un():dn(),rt(null),et(!1),wt({tab:St.tab||void 0,open:!1}),void qe(!1)):dn(void 0,void 0,void 0,void 0)}})))),(!Ne||Xe)&&g.createElement(g.Fragment,null,g.createElement(z,ye({},Xt,{isReviewingStickerComment:Xe,icon:I.STICKER,onClick:function(){nt?(et(!1),rt(void 0),wt({tab:x.b.STICKER,open:!0})):wt({tab:St.tab||void 0,open:!St.open}),qe(!1)},onChange:function(){},disabled:hn})),Ie&&!Y&&g.createElement(N.default,{button:"alt",icon:I.IMAGE,title:fe("Upload Image"),onClick:function(){v(A.Pk,{onUpdate:function(e,t){return function(e,t){t||(t="");var n="![".concat(t,"](").concat(e,")");ut((function(e){return e+(e&&" "!==e.charAt(e.length-1)?" ".concat(n," "):"".concat(n," "))}))}(e,t)},assetName:fe("Image")})},onChange:function(){}}),!ie&&!s&&g.createElement(g.Fragment,null,g.createElement(X,ye({},en,{name:fe("AR"),icon:I.USD,tab:q.tA,disabled:en.disabled||"connected"!==ke})))),$e||Ke?g.createElement(N.default,ye({},tn,{disabled:Ue,onClick:function(){Ke||qe(!1),Je(!1),Wt&&(et(!1),wt({tab:St.tab||void 0,open:!1}),rt(null)),ee&&ee()}})):Xe?g.createElement(N.default,ye({},tn,{onClick:function(){et(!1),rt(null),wt({tab:void 0,open:!1}),ee&&ee()}})):K&&g.createElement(N.default,ye({},tn,{onClick:K})),!Y&&g.createElement(le,{deletedComment:Et,minAmount:Ut,minTip:Ft,minSuper:Pt,minUSDAmount:Zt,minUSDSuper:Bt,minUSDTip:Dt})),g.createElement("div",{className:"chat-resize"},g.createElement("div",null),g.createElement("div",null),g.createElement("div",null)))):g.createElement("div",{role:"button",className:"comment-create__auth",onClick:function(e){e.preventDefault(),e.stopPropagation(),U?window.open("https://odysee.com/$/".concat(k.AUTH,"?redirect=/$/").concat(k.LIVESTREAM)):v(A.ae,{title:fe("Channel is required for commenting"),subtitle:fe("You'll need a channel to comment on this upload."),labelOk:fe("Continue to channel creation"),onConfirm:function(e){var t="/$/".concat(k.CHANNEL_NEW,"?redirect=").concat(Pe);Y?window.open(t):Me(t),e()}})}},g.createElement(_.Wi,{type:"textarea",name:"comment__signup-prompt",placeholder:fe(pn),disabled:Ne}),!Ne&&g.createElement("div",{className:"section__actions--no-margin"},g.createElement(N.default,{disabled:!0,button:"primary",label:fe("Send --[button to submit something]--"),requiresAuth:!0})))}))},30740:(e,t,n)=>{n.r(t),n.d(t,{default:()=>K});var r=n(2927),o=n(16395),a=n(95810),i=n(63400),c=n(77369),l=n(44908),u=n(51635),s=n(66598),m=n.n(s),d=n(69809),f=n(76333),h=n(85311),p=n(88441),v=n(91616),b=n(29679),y=n(16643),g=n(24582),E=n(7920),C=n(29454),_=n(81352),S=n(58210),w=n(17185),O=n(52338),I=n(33441),T=n(28180),k=n(96284),A=n(71036).__;const N=function(e){var t=e.claimId,n=e.channelId,r=e.channelName,o=e.claimIsMine,a=e.channelHasMembershipTiers,i=e.areCommentsMembersOnly,l=e.creatorMembershipsFetched,u=e.doToggleMembersOnlyCommentsSettingForClaimId,s=e.doMembershipList,m=e.doToast;return p.useEffect((function(){!l&&r&&n&&s({channel_claim_id:n})}),[n,r,l,s]),a&&o?p.createElement(T.v2,null,p.createElement(T.j2,{className:"button button--alt menu__button"},p.createElement(k.default,{size:18,icon:c.SETTINGS})),p.createElement(T.qy,{className:"menu__list"},p.createElement(T.sN,{className:"comment__menu-option",onSelect:function(){t&&u(t).then((function(){return m({message:A(i?"Members-only comments are now disabled.":"Members-only comments are now enabled.")})}))}},p.createElement("span",{className:"menu__link"},p.createElement(k.default,{"aria-hidden":!0,icon:c.MEMBERSHIP}),A(i?"Disable members-only comments":"Enable members-only comments"))))):null};var L={doToggleMembersOnlyCommentsSettingForClaimId:w.xw,doMembershipList:O.OT,doToast:I.QJ};const j=(0,g.$j)((function(e,t){var n=t.uri,r=(0,E.B0y)(e,n),o=r&&r.claim_id,a=(0,S.tg)(r)||{},i=a.claim_id;return{claimId:o,channelId:i,channelName:a.name,claimIsMine:(0,E.ZJr)(e,n),channelHasMembershipTiers:i&&(0,_.R)(e,i),areCommentsMembersOnly:i&&(0,C.uy)(e,i),creatorMembershipsFetched:(0,_.p$)(e,n)}}),L)(N);var x=n(13690),R=n(71036).__,M=["activeSort","sortOption","changeSort"];function P(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function F(){return F=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},F.apply(this,arguments)}function U(e){return function(e){if(Array.isArray(e))return Z(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||D(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||D(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e,t){if(e){if("string"==typeof e)return Z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Z(e,t):void 0}}function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Y=200,H=(0,x.e)((function(){return Promise.all([n.e(5904),n.e(2461),n.e(8324)]).then(n.bind(n,93148))}));var G=function(e){var t=e.uri,n=e.totalUnfilteredComments,a=e.sort,i=e.changeSort,u=e.handleRefresh,s={activeSort:a,changeSort:i};return p.createElement("div",{className:"comment__actions"},n>1&&o.ENABLE_COMMENT_REACTIONS&&p.createElement("span",{className:"comment__sort"},p.createElement(W,F({},s,{label:R("Best"),icon:c.BEST,sortOption:r.dY.POPULARITY})),p.createElement(W,F({},s,{label:R("Controversial"),icon:c.CONTROVERSIAL,sortOption:r.dY.CONTROVERSY})),p.createElement(W,F({},s,{label:R("New"),icon:c.NEW,sortOption:r.dY.NEWEST}))),p.createElement("div",{className:"comment__settings"},p.createElement(l.default,{button:"alt",icon:c.REFRESH,title:R("Refresh"),onClick:u}),p.createElement(j,{uri:t})))},W=function(e){var t=e.activeSort,n=e.sortOption,r=e.changeSort,o=P(e,M);return p.createElement(l.default,F({},o,{className:m()("button-toggle",{"button-toggle--active":t===n}),button:"alt",iconSize:18,onClick:function(){return r(n)}}))},z=function(e){var t=e.label,n=e.isViewAll,o=e.threadCommentParent,a=e.threadCommentId,i=(0,y.useHistory)(),u=i.push,s=i.location,m=s.pathname,d=s.search;return p.createElement(l.default,{button:"link",label:t,icon:c.ARROW_LEFT,iconSize:12,onClick:function(){var e=new URLSearchParams(d);n?(e.delete(r.ee),e.set(r.Hj,o)):(e.set(r.ee,o),e.set(r.Hj,a)),window.pendingLinkedCommentScroll=!0,u({pathname:m,search:e.toString()})}})},$=n(44692),q=n(88374),V={fetchTopLevelComments:w.Xp,fetchComment:w.pf,fetchReacts:w.wk,resetComments:w.vg,doFetchOdyseeMembershipForChannelIds:O.i6,doFetchChannelMembershipsForChannelIds:O.RG,doPopOutInlinePlayer:$.aH};const K=(0,g.$j)((function(e,t){var n=t.uri,r=t.threadCommentId,o=t.linkedCommentId,a=(0,E.B0y)(e,n),i=(0,S._I)(a),c=(0,q.YG)(e),l=(0,C.xT)(e,r);return{activeChannelId:c&&c.claim_id,allCommentIds:(0,C.RT)(e,n),channelId:i,chatCommentsRestrictedToChannelMembers:Boolean((0,E.RvA)(e,n)),claimId:a&&a.claim_id,claimIsMine:(0,E.pDP)(e,a),fetchingChannels:(0,E.Y7j)(e),isAChannelMember:(0,_.QL)(e,i),isFetchingComments:(0,C.vz)(e),isFetchingReacts:(0,C.xs)(e),isFetchingTopLevelComments:(0,C.DV)(e),linkedCommentAncestors:(0,C.kP)(e,o),commentsEnabledSetting:(0,C.E7)(e,i),myReactsByCommentId:(0,C.zQ)(e),othersReactsById:(0,C._M)(e),pinnedComments:(0,C.ZY)(e,n),threadComment:l,threadCommentAncestors:(0,C.kP)(e,r),topLevelComments:(0,C.C2)(e,n),topLevelTotalPages:(0,C.TY)(e,n),totalComments:(0,C.pC)(e,n),scheduledState:(0,E.r_k)(e,n)}}),V)((function(e){var t,n=e.allCommentIds,c=e.uri,s=e.pinnedComments,g=e.topLevelComments,E=e.topLevelTotalPages,C=e.claimId,_=e.channelId,S=e.claimIsMine,w=e.isFetchingComments,O=e.isFetchingTopLevelComments,I=e.isFetchingReacts,T=e.linkedCommentId,k=e.totalComments,A=e.fetchingChannels,N=e.myReactsByCommentId,L=e.othersReactsById,j=e.activeChannelId,x=e.commentsEnabledSetting,M=e.commentsAreExpanded,P=e.threadCommentId,D=e.threadComment,Z=e.notInDrawer,W=e.threadCommentAncestors,$=e.linkedCommentAncestors,q=e.fetchTopLevelComments,V=e.fetchComment,K=e.fetchReacts,J=e.resetComments,Q=e.doFetchOdyseeMembershipForChannelIds,X=e.doPopOutInlinePlayer,ee=e.doFetchChannelMembershipsForChannelIds,te=e.chatCommentsRestrictedToChannelMembers,ne=e.isAChannelMember,re=e.scheduledState,oe=p.useRef(!1),ae=(0,y.useHistory)(),ie=ae.push,ce=ae.location,le=ce.pathname,ue=ce.search,se=(0,a.dD)(),me=(0,a.Dv)(),de=Math.ceil(g.length/r.t5),fe=p.useRef(),he=p.useRef(),pe=o.ENABLE_COMMENT_REACTIONS?r.dY.POPULARITY:r.dY.NEWEST,ve=B((0,b.Z)("comment-sort-by",pe),2),be=ve[0],ye=ve[1],ge=B(p.useState(de>0?de:1),2),Ee=ge[0],Ce=ge[1],_e=B(p.useState(!1),2),Se=_e[0],we=_e[1],Oe=M||!me||se,Ie=B(p.useState(Oe),2),Te=Ie[0],ke=Ie[1],Ae=B(p.useState(),2),Ne=Ae[0],Le=Ae[1],je=B(p.useState([]),2),xe=je[0],Re=je[1],Me=p.useCallback((function(e){Re((function(t){var n=e.filter((function(e){return!t.includes(e)}));return n.length>0?[].concat(U(t),U(n)):t}))}),[]),Pe=k>0?k-xe.length:k,Fe=n?n.length:0,Ue=Ee<E,Be=(0,i.YD)(Pe),De=se?3:10;W&&W.some((function(e,n){if(n>=De-1)return!0;t=e}));var Ze=W&&W[W.length-1],Ye=B(p.useState(Boolean(L)||!o.ENABLE_COMMENT_REACTIONS),2),He=Ye[0],Ge=Ye[1],We=p.useMemo((function(){return g.map((function(e){return e.channel_id}))}),[g]);p.useEffect((function(){We.length>0&&_&&(Q(We),ee(_,We))}),[_,We.length,ee,Q]);var ze=p.useCallback((function(){C&&J(C),Ce(1)}),[C,J]);function $e(){Ce(0),X({source:"comment"})}p.useEffect((function(){if(!P&&T&&$&&$.length>De-1&&!oe.current){var e=new URLSearchParams(ue);e.set(r.ee,T),ie({pathname:le,search:e.toString()}),oe.current=!0}}),[$,T,le,ie,ue,P,De]);var qe=te&&!ne&&!S;(0,p.useEffect)((function(){Ne&&Ne===c&&(Ce(Ee+1),Le(void 0))}),[Ne,c]),(0,p.useEffect)((function(){0===Ee&&ze()}),[ze,Ee]),(0,p.useEffect)((function(){return function(){return Ce(1)}}),[c]),(0,p.useEffect)((function(){Ee<de&&Ce(de>0?de:1)}),[c]),(0,p.useEffect)((function(){var e=1!==Ee&&Ee!==de,t=Number(0===de)^Number(e);0!==Ee&&t&&(1===Ee&&(P&&V(P),T&&V(T)),q(c,void 0,Ee,r.t5,be,!1))}),[de,V,q,T,Ee,be,P,c]),p.useEffect((function(){P&&$e()}),[P]),(0,p.useEffect)((function(){var e;Fe>0&&o.ENABLE_COMMENT_REACTIONS&&!A&&!I&&(0!==(e=L&&N?n.filter((function(e){var t=j?"".concat(e,":").concat(j):e;return!L[t]||j&&!N[t]})):n).length&&K(e).then((function(){Ge(!0)})).catch((function(){return Ge(!0)})))}),[j,n,K,A,I,N,L,Fe]),(0,p.useEffect)((function(){T||P?window.pendingLinkedCommentScroll=!0:delete window.pendingLinkedCommentScroll}),[]),(0,p.useEffect)((function(){if(0!==g.length){var e=(0,f.Z)((function(){n(Ee,E)&&(Le(c),we(!0))}),Y);if(Se||(e(),we(!0)),Oe&&!w&&He&&Ue){var t=Boolean(document.querySelector(".MuiDrawer-root .card--enable-overflow"))?document.querySelector(".card--enable-overflow"):window;if(t)return t.addEventListener("scroll",e),function(){return t.removeEventListener("scroll",e)}}}function n(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;if(!fe||!fe.current)return!1;var r,o,a=fe.current.getBoundingClientRect(),i=window.innerHeight||document.documentElement.clientHeight,c=window.innerWidth||document.documentElement.clientWidth,l=0!==n&&a.top<i+(r=n,(o=window.devicePixelRatio||1)<1?Math.ceil(r/o):Math.ceil(r*o));return(a.width>0&&a.height>0&&a.bottom>=0&&a.right>=0&&a.top<=i&&a.left<=c||l)&&e<t}}),[g,Oe,Se,w,se,Ue,Ee,He,E,c]);var Ve={isTopLevel:!0,uri:c,linkedCommentId:T,threadCommentId:P,threadDepthLevel:De},Ke={uri:c,totalUnfilteredComments:Pe,sort:be,changeSort:function(e){be!==e&&(ye(e),$e(),X({source:"comment"}))},handleRefresh:$e};return"scheduled"===re?null:p.createElement(u.Z,{className:"card--enable-overflow comment__list",title:(!se||Z)&&Be,titleActions:p.createElement(G,Ke),actions:p.createElement(p.Fragment,null,se&&!Z&&p.createElement(G,Ke),p.createElement(H,{uri:c}),P&&D&&p.createElement("span",{className:"comment__actions comment__thread-links"},p.createElement(z,{label:R("View all comments"),threadCommentParent:Ze||P,threadCommentId:P,isViewAll:!0}),t&&p.createElement(z,{label:R("Show parent comments"),threadCommentParent:t,threadCommentId:P})),x&&!w&&!Pe&&!P&&p.createElement(h.Z,{padded:!0,text:R("That was pretty deep. What do you think?")}),p.createElement("ul",{ref:he,className:m()("comments",{"comments--contracted":me&&!Te&&Pe>1})},He&&p.createElement(p.Fragment,null,D&&p.createElement(d.Z,F({key:D.comment_id,comment:D,disabled:qe,updateUiFilteredComments:Me},Ve)),s&&s.map((function(e){if(!(D&&W&&W.includes(e.comment_id)))return p.createElement(d.Z,F({key:e.comment_id,comment:e,disabled:qe,updateUiFilteredComments:Me},Ve))})),g.map((function(e){if(!(D&&W&&W.includes(e.comment_id)))return p.createElement(d.Z,F({key:e.comment_id,comment:e,disabled:qe,updateUiFilteredComments:Me},Ve))})))),!Oe&&p.createElement("div",{className:"card__bottom-actions card__bottom-actions--comments"},(!Te||Ue)&&Pe>1&&p.createElement(l.default,{button:"link",title:R(Te?"More":"Expand"),label:R(Te?"More":"Expand"),onClick:function(){return Te?Ce(Ee+1):ke(!0)}}),Te&&Pe>1&&p.createElement(l.default,{button:"link",title:R("Collapse"),label:R("Collapse"),onClick:function(){if(ke(!1),he.current){var e=he.current.getBoundingClientRect().top;window.scrollTo({top:e+window.pageYOffset-200,behavior:"smooth"})}}})),(P?!He:O||Oe&&Ue)&&p.createElement("div",{className:"main--empty",ref:fe},p.createElement(v.Z,{type:"small"})))})}))},85442:(e,t,n)=>{n.d(t,{Z:()=>o});var r=n(88441);const o=function(e){var t=e.children,n=e.title,o=e.subtitle,a=e.action;return n&&o&&a?r.createElement("div",{className:"error-bubble"},r.createElement("div",null,r.createElement("label",null,n),r.createElement("span",null,o)),a):t?r.createElement("span",{className:"error-bubble"},t):null}}}]);
//# sourceMappingURL=comments-6669746b50beb524b71c-1009.js.map