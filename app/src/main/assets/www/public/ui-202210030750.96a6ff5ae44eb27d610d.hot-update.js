webpackHotUpdate("ui-202210030750",{

/***/ "../ui/component/viewers/videoViewer/internal/videojs.jsx":
/*!****************************************************************!*\
  !*** ../ui/component/viewers/videoViewer/internal/videojs.jsx ***!
  \****************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* WEBPACK VAR INJECTION */(function(__) {/* harmony import */ var videojs_contrib_ads__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! videojs-contrib-ads */ \"../node_modules/videojs-contrib-ads/dist/videojs-contrib-ads.es.js\");\n/* harmony import */ var videojs_ima__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! videojs-ima */ \"../node_modules/videojs-ima/dist/videojs.ima.es.js\");\n/* harmony import */ var videojs_vtt_thumbnails__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! videojs-vtt-thumbnails */ \"../node_modules/videojs-vtt-thumbnails/dist/videojs-vtt-thumbnails.es.js\");\n/* harmony import */ var video_js_dist_alt_video_js_cdn_min_css__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! video.js/dist/alt/video-js-cdn.min.css */ \"../node_modules/video.js/dist/alt/video-js-cdn.min.css\");\n/* harmony import */ var video_js_dist_alt_video_js_cdn_min_css__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(video_js_dist_alt_video_js_cdn_min_css__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _plugins_videojs_mobile_ui_plugin__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./plugins/videojs-mobile-ui/plugin */ \"../ui/component/viewers/videoViewer/internal/plugins/videojs-mobile-ui/plugin.js\");\n/* harmony import */ var _silvermine_videojs_chromecast_dist_silvermine_videojs_chromecast_css__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @silvermine/videojs-chromecast/dist/silvermine-videojs-chromecast.css */ \"../node_modules/@silvermine/videojs-chromecast/dist/silvermine-videojs-chromecast.css\");\n/* harmony import */ var _silvermine_videojs_chromecast_dist_silvermine_videojs_chromecast_css__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_silvermine_videojs_chromecast_dist_silvermine_videojs_chromecast_css__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var _silvermine_videojs_airplay_dist_silvermine_videojs_airplay_css__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @silvermine/videojs-airplay/dist/silvermine-videojs-airplay.css */ \"../node_modules/@silvermine/videojs-airplay/dist/silvermine-videojs-airplay.css\");\n/* harmony import */ var _silvermine_videojs_airplay_dist_silvermine_videojs_airplay_css__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_silvermine_videojs_airplay_dist_silvermine_videojs_airplay_css__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var constants_icons__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! constants/icons */ \"../ui/constants/icons.js\");\n/* harmony import */ var constants_player__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! constants/player */ \"../ui/constants/player.js\");\n/* harmony import */ var _overlays__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./overlays */ \"../ui/component/viewers/videoViewer/internal/overlays.js\");\n/* harmony import */ var component_button__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! component/button */ \"../ui/component/button/index.js\");\n/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! classnames */ \"../node_modules/classnames/index.js\");\n/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_11__);\n/* harmony import */ var _videojs_events__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./videojs-events */ \"../ui/component/viewers/videoViewer/internal/videojs-events.jsx\");\n/* harmony import */ var videojs_event_tracking__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! videojs-event-tracking */ \"../node_modules/videojs-event-tracking/dist/videojs-event-tracking.es.js\");\n/* harmony import */ var _videojs_functions__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./videojs-functions */ \"../ui/component/viewers/videoViewer/internal/videojs-functions.jsx\");\n/* harmony import */ var _plugins_videojs_hls_quality_selector_plugin__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./plugins/videojs-hls-quality-selector/plugin */ \"../ui/component/viewers/videoViewer/internal/plugins/videojs-hls-quality-selector/plugin.js\");\n/* harmony import */ var _videojs_shortcuts__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./videojs-shortcuts */ \"../ui/component/viewers/videoViewer/internal/videojs-shortcuts.jsx\");\n/* harmony import */ var _lbry_playback_rate__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./lbry-playback-rate */ \"../ui/component/viewers/videoViewer/internal/lbry-playback-rate.js\");\n/* harmony import */ var player_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! player.js */ \"../node_modules/player.js/dist/player-0.1.0.js\");\n/* harmony import */ var player_js__WEBPACK_IMPORTED_MODULE_18___default = /*#__PURE__*/__webpack_require__.n(player_js__WEBPACK_IMPORTED_MODULE_18__);\n/* harmony import */ var videojs_contrib_quality_levels__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! videojs-contrib-quality-levels */ \"../node_modules/videojs-contrib-quality-levels/dist/videojs-contrib-quality-levels.es.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! react */ \"../node_modules/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_20___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_20__);\n/* harmony import */ var _plugins_videojs_i18n_plugin__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./plugins/videojs-i18n/plugin */ \"../ui/component/viewers/videoViewer/internal/plugins/videojs-i18n/plugin.js\");\n/* harmony import */ var _plugins_videojs_recsys_plugin__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./plugins/videojs-recsys/plugin */ \"../ui/component/viewers/videoViewer/internal/plugins/videojs-recsys/plugin.js\");\n/* harmony import */ var video_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! video.js */ \"../node_modules/video.js/dist/video.es.js\");\n/* harmony import */ var effects_use_screensize__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! effects/use-screensize */ \"../ui/effects/use-screensize.js\");\n/* harmony import */ var util_platform__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! util/platform */ \"../ui/util/platform.js\");\n/* harmony import */ var effects_use_persisted_state__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! effects/use-persisted-state */ \"../ui/effects/use-persisted-state.js\");\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\n // must be loaded in this order\n\n // loads directly after contrib-ads\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n // import LbryVolumeBarClass from './lbry-volume-bar';\n// import Chromecast from './chromecast';\n\n\n\n\n\n // import runAds from './ads';\n\n\n\n\n\n\nvar canAutoplayVideo = __webpack_require__(/*! ./plugins/canAutoplay */ \"../ui/component/viewers/videoViewer/internal/plugins/canAutoplay.js\"); // require('@neko/videojs-chromecast')(videojs);\n\n\nvar VIDEOJS_VOLUME_PANEL_CLASS = 'VolumePanel';\nvar IS_IOS = util_platform__WEBPACK_IMPORTED_MODULE_25__[\"platform\"].isIOS();\nvar PLUGIN_MAP = {\n  eventTracking: videojs_event_tracking__WEBPACK_IMPORTED_MODULE_13__[\"default\"],\n  hlsQualitySelector: _plugins_videojs_hls_quality_selector_plugin__WEBPACK_IMPORTED_MODULE_15__[\"default\"],\n  qualityLevels: videojs_contrib_quality_levels__WEBPACK_IMPORTED_MODULE_19__[\"default\"],\n  recsys: _plugins_videojs_recsys_plugin__WEBPACK_IMPORTED_MODULE_22__[\"default\"],\n  i18n: _plugins_videojs_i18n_plugin__WEBPACK_IMPORTED_MODULE_21__[\"default\"]\n};\nObject.entries(PLUGIN_MAP).forEach(function (_ref) {\n  var _ref2 = _slicedToArray(_ref, 2),\n      pluginName = _ref2[0],\n      plugin = _ref2[1];\n\n  if (!Object.keys(video_js__WEBPACK_IMPORTED_MODULE_23__[\"default\"].getPlugins()).includes(pluginName)) {\n    video_js__WEBPACK_IMPORTED_MODULE_23__[\"default\"].registerPlugin(pluginName, plugin);\n  }\n}); // ****************************************************************************\n// VideoJs\n// ****************************************************************************\n\n/*\nproperties for this component should be kept to ONLY those that if changed should REQUIRE an entirely new videojs element\n */\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (react__WEBPACK_IMPORTED_MODULE_20___default.a.memo(function VideoJs(props) {\n  var autoplay = props.autoplay,\n      claimId = props.claimId,\n      channelName = props.channelName,\n      channelTitle = props.channelTitle,\n      embedded = props.embedded,\n      embeddedInternal = props.embeddedInternal,\n      isAudio = props.isAudio,\n      shareTelemetry = props.shareTelemetry,\n      source = props.source,\n      sourceType = props.sourceType,\n      startMuted = props.startMuted,\n      userId = props.userId,\n      defaultQuality = props.defaultQuality,\n      onPlayerReady = props.onPlayerReady,\n      playNext = props.playNext,\n      playPrevious = props.playPrevious,\n      toggleVideoTheaterMode = props.toggleVideoTheaterMode,\n      claimValues = props.claimValues,\n      doAnalyticsView = props.doAnalyticsView,\n      doAnalyticsBuffer = props.doAnalyticsBuffer,\n      claimRewards = props.claimRewards,\n      uri = props.uri,\n      userClaimId = props.userClaimId,\n      isLivestreamClaim = props.isLivestreamClaim,\n      activeLivestreamForChannel = props.activeLivestreamForChannel,\n      doToast = props.doToast,\n      isPurchasableContent = props.isPurchasableContent,\n      isRentableContent = props.isRentableContent; // used to notify about default quality setting\n  // if already has a quality set, no need to notify\n\n  var _usePersistedState = Object(effects_use_persisted_state__WEBPACK_IMPORTED_MODULE_26__[\"default\"])('initial-quality-change', Boolean(defaultQuality)),\n      _usePersistedState2 = _slicedToArray(_usePersistedState, 2),\n      initialQualityChange = _usePersistedState2[0],\n      setInitialQualityChange = _usePersistedState2[1];\n\n  var isMobile = Object(effects_use_screensize__WEBPACK_IMPORTED_MODULE_24__[\"useIsMobile\"])();\n  var playerRef = Object(react__WEBPACK_IMPORTED_MODULE_20__[\"useRef\"])();\n  var containerRef = Object(react__WEBPACK_IMPORTED_MODULE_20__[\"useRef\"])();\n  var tapToUnmuteRef = Object(react__WEBPACK_IMPORTED_MODULE_20__[\"useRef\"])();\n  var tapToRetryRef = Object(react__WEBPACK_IMPORTED_MODULE_20__[\"useRef\"])();\n  var playerServerRef = Object(react__WEBPACK_IMPORTED_MODULE_20__[\"useRef\"])();\n  var volumePanelRef = Object(react__WEBPACK_IMPORTED_MODULE_20__[\"useRef\"])();\n  var keyDownHandlerRef = Object(react__WEBPACK_IMPORTED_MODULE_20__[\"useRef\"])();\n  var videoScrollHandlerRef = Object(react__WEBPACK_IMPORTED_MODULE_20__[\"useRef\"])();\n  var volumePanelScrollHandlerRef = Object(react__WEBPACK_IMPORTED_MODULE_20__[\"useRef\"])();\n\n  var _ref3 = activeLivestreamForChannel || {},\n      livestreamVideoUrl = _ref3.url;\n\n  var overrideNativeVhs = !util_platform__WEBPACK_IMPORTED_MODULE_25__[\"platform\"].isIPhone();\n  var showQualitySelector = !isLivestreamClaim && overrideNativeVhs || livestreamVideoUrl; // initiate keyboard shortcuts\n\n  var _keyboardShorcuts = Object(_videojs_shortcuts__WEBPACK_IMPORTED_MODULE_16__[\"default\"])({\n    isMobile: isMobile,\n    isLivestreamClaim: isLivestreamClaim,\n    toggleVideoTheaterMode: toggleVideoTheaterMode,\n    playNext: playNext,\n    playPrevious: playPrevious\n  }),\n      createKeyDownShortcutsHandler = _keyboardShorcuts.createKeyDownShortcutsHandler,\n      createVideoScrollShortcutsHandler = _keyboardShorcuts.createVideoScrollShortcutsHandler,\n      createVolumePanelScrollShortcutsHandler = _keyboardShorcuts.createVolumePanelScrollShortcutsHandler;\n\n  var _useState = Object(react__WEBPACK_IMPORTED_MODULE_20__[\"useState\"])('initial'),\n      _useState2 = _slicedToArray(_useState, 2),\n      reload = _useState2[0],\n      setReload = _useState2[1];\n\n  var _functions = Object(_videojs_functions__WEBPACK_IMPORTED_MODULE_14__[\"default\"])({\n    isAudio: isAudio\n  }),\n      createVideoPlayerDOM = _functions.createVideoPlayerDOM;\n\n  var _events = Object(_videojs_events__WEBPACK_IMPORTED_MODULE_12__[\"default\"])({\n    tapToUnmuteRef: tapToUnmuteRef,\n    tapToRetryRef: tapToRetryRef,\n    setReload: setReload,\n    playerRef: playerRef,\n    claimValues: claimValues,\n    userId: userId,\n    claimId: claimId,\n    embedded: embedded,\n    doAnalyticsView: doAnalyticsView,\n    doAnalyticsBuffer: doAnalyticsBuffer,\n    claimRewards: claimRewards,\n    uri: uri,\n    playerServerRef: playerServerRef,\n    isLivestreamClaim: isLivestreamClaim,\n    channelTitle: channelTitle\n  }),\n      unmuteAndHideHint = _events.unmuteAndHideHint,\n      retryVideoAfterFailure = _events.retryVideoAfterFailure,\n      initializeEvents = _events.initializeEvents;\n\n  var videoJsOptions = {\n    preload: 'auto',\n    playbackRates: constants_player__WEBPACK_IMPORTED_MODULE_8__[\"VIDEO_PLAYBACK_RATES\"],\n    responsive: true,\n    controls: true,\n    html5: {\n      vhs: {\n        overrideNative: overrideNativeVhs,\n        // !videojs.browser.IS_ANY_SAFARI,\n        enableLowInitialPlaylist: false,\n        fastQualityChange: true,\n        useDtsForTimestampOffset: true\n      }\n    },\n    liveTracker: {\n      trackingThreshold: 0,\n      liveTolerance: 10\n    },\n    inactivityTimeout: 2000,\n    muted: startMuted,\n    plugins: {\n      eventTracking: true,\n      overlay: _overlays__WEBPACK_IMPORTED_MODULE_9__[\"OVERLAY_DATA\"]\n    },\n    controlBar: {\n      currentTimeDisplay: true,\n      timeDivider: true,\n      durationDisplay: true,\n      remainingTimeDisplay: true,\n      subsCapsButton: !IS_IOS\n    },\n    techOrder: ['html5'],\n    bigPlayButton: embedded,\n    // only show big play button if embedded\n    suppressNotSupportedError: true,\n    liveui: true\n  }; // TODO: would be nice to pull this out into functions file\n  // Initialize video.js\n\n  function initializeVideoPlayer(domElement) {\n    if (!domElement) return;\n    var vjs = Object(video_js__WEBPACK_IMPORTED_MODULE_23__[\"default\"])(domElement, videoJsOptions, function _callee() {\n      var player, adapter, _claimValues$video, videoDiv;\n\n      return regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              player = playerRef.current;\n              adapter = new player_js__WEBPACK_IMPORTED_MODULE_18___default.a.VideoJSAdapter(player); // this seems like a weird thing to have to check for here\n\n              if (player) {\n                _context.next = 4;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 4:\n              // runAds(internalFeatureEnabled, allowPreRoll, player, embedded);\n              _lbry_playback_rate__WEBPACK_IMPORTED_MODULE_17__[\"default\"].replaceExisting(player); // Add reloadSourceOnError plugin\n\n              player.reloadSourceOnError({\n                errorInterval: 10\n              }); // Initialize mobile UI.\n\n              player.mobileUi({\n                fullscreen: {\n                  enterOnRotate: false\n                },\n                touchControls: {\n                  seekSeconds: 10\n                }\n              });\n              player.i18n();\n\n              if (!embedded) {\n                window.player.bigPlayButton && window.player.bigPlayButton.hide();\n              } else {// const bigPlayButton = document.querySelector('.vjs-big-play-button');\n                // if (bigPlayButton) bigPlayButton.style.setProperty('display', 'block', 'important');\n              } // Add quality selector to player\n\n\n              if (showQualitySelector) {\n                player.hlsQualitySelector({\n                  displayCurrentQuality: true,\n                  originalHeight: claimValues === null || claimValues === void 0 ? void 0 : (_claimValues$video = claimValues.video) === null || _claimValues$video === void 0 ? void 0 : _claimValues$video.height,\n                  defaultQuality: defaultQuality,\n                  initialQualityChange: initialQualityChange,\n                  setInitialQualityChange: setInitialQualityChange,\n                  doToast: doToast\n                });\n              } // Add recsys plugin\n\n\n              if (shareTelemetry) {\n                player.recsys({\n                  videoId: claimId,\n                  userId: userId,\n                  embedded: embedded || embeddedInternal\n                });\n              } // set playsinline for mobile\n\n\n              player.children_[0].setAttribute('playsinline', '');\n\n              if (canAutoplayVideo === true) {\n                // show waiting spinner as video is loading\n                player.addClass('vjs-waiting'); // $FlowFixMe\n\n                document.querySelector('.vjs-big-play-button').style.setProperty('display', 'none', 'important');\n              } else {// $FlowFixMe\n                // document.querySelector('.vjs-big-play-button').style.setProperty('display', 'block', 'important');\n              } // immediately show control bar while video is loading\n\n\n              player.userActive(true);\n              adapter.ready(); // sometimes video doesnt start properly, this addresses the edge case\n\n              if (autoplay) {\n                videoDiv = window.player.children_[0];\n\n                if (videoDiv) {\n                  videoDiv.click();\n                }\n\n                window.player.userActive(true);\n              }\n\n            case 16:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      });\n    }); // fixes #3498 (https://github.com/lbryio/lbry-desktop/issues/3498)\n    // summary: on firefox the focus would stick to the fullscreen button which caused buggy behavior with spacebar\n\n    vjs.on('fullscreenchange', function () {\n      return document.activeElement && document.activeElement.blur();\n    });\n    return vjs;\n  } // useEffect(() => {\n  //   if (showQualitySelector) {\n  //     // Add quality selector to player\n  //     const player = playerRef.current;\n  //     if (player) player.hlsQualitySelector({ displayCurrentQuality: true });\n  //   }\n  // }, [showQualitySelector]);\n\n  /*\n  useEffect(() => {\n    Chromecast.updateTitles(title, channelTitle);\n  }, [title, channelTitle]);\n  */\n  // This lifecycle hook is only called once (on mount), or when `isAudio` or `source` changes.\n\n\n  Object(react__WEBPACK_IMPORTED_MODULE_20__[\"useEffect\"])(function () {\n    (function _callee2() {\n      var _playerRef$current, _playerRef$current$co, _playerRef$current$co2, _vjsPlayer$controlBar7;\n\n      var vjsPlayer, vjsParent, canUseOldPlayer, isLivestream, vjsElement, _vjsPlayer$controlBar, _vjsPlayer$controlBar2, _vjsPlayer$controlBar3, _vjsPlayer$controlBar4, _vjsPlayer$controlBar5, _vjsPlayer$controlBar6, _vjsPlayer$bigPlayBut, videoNode, keyDownHandler, videoScrollHandler, volumePanelHandler, containerDiv, response, trimmedUrl, payload, fix, _payload, _document$querySelect, player, promise;\n\n      return regeneratorRuntime.async(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              vjsParent = document.querySelector('.video-js-parent');\n              canUseOldPlayer = window.oldSavedDiv && vjsParent;\n              isLivestream = isLivestreamClaim && userClaimId; // initialize videojs if it hasn't been done yet\n\n              if (canUseOldPlayer) {\n                _context2.next = 11;\n                break;\n              }\n\n              vjsElement = createVideoPlayerDOM(containerRef.current);\n              vjsPlayer = initializeVideoPlayer(vjsElement);\n\n              if (vjsPlayer) {\n                _context2.next = 8;\n                break;\n              }\n\n              return _context2.abrupt(\"return\");\n\n            case 8:\n              // Add reference to player to global scope\n              window.player = vjsPlayer;\n              _context2.next = 12;\n              break;\n\n            case 11:\n              vjsPlayer = window.player;\n\n            case 12:\n              // hide unused elements on livestream\n              if (isLivestream) {\n                vjsPlayer.addClass('vjs-live');\n                vjsPlayer.addClass('vjs-liveui'); // $FlowIssue\n\n                (_vjsPlayer$controlBar = vjsPlayer.controlBar.currentTimeDisplay) === null || _vjsPlayer$controlBar === void 0 ? void 0 : _vjsPlayer$controlBar.el().style.setProperty('display', 'none', 'important'); // $FlowIssue\n\n                (_vjsPlayer$controlBar2 = vjsPlayer.controlBar.timeDivider) === null || _vjsPlayer$controlBar2 === void 0 ? void 0 : _vjsPlayer$controlBar2.el().style.setProperty('display', 'none', 'important'); // $FlowIssue\n\n                (_vjsPlayer$controlBar3 = vjsPlayer.controlBar.durationDisplay) === null || _vjsPlayer$controlBar3 === void 0 ? void 0 : _vjsPlayer$controlBar3.el().style.setProperty('display', 'none', 'important');\n              } else {\n                vjsPlayer.removeClass('vjs-live');\n                vjsPlayer.removeClass('vjs-liveui'); // $FlowIssue\n\n                (_vjsPlayer$controlBar4 = vjsPlayer.controlBar.currentTimeDisplay) === null || _vjsPlayer$controlBar4 === void 0 ? void 0 : _vjsPlayer$controlBar4.el().style.setProperty('display', 'block', 'important'); // $FlowIssue\n\n                (_vjsPlayer$controlBar5 = vjsPlayer.controlBar.timeDivider) === null || _vjsPlayer$controlBar5 === void 0 ? void 0 : _vjsPlayer$controlBar5.el().style.setProperty('display', 'block', 'important'); // $FlowIssue\n\n                (_vjsPlayer$controlBar6 = vjsPlayer.controlBar.durationDisplay) === null || _vjsPlayer$controlBar6 === void 0 ? void 0 : _vjsPlayer$controlBar6.el().style.setProperty('display', 'block', 'important');\n              } // Add recsys plugin\n\n\n              if (shareTelemetry) {\n                vjsPlayer.recsys.options_ = {\n                  videoId: claimId,\n                  userId: userId,\n                  embedded: embedded || embeddedInternal\n                };\n                vjsPlayer.recsys.lastTimeUpdate = null;\n                vjsPlayer.recsys.currentTimeUpdate = null;\n                vjsPlayer.recsys.inPause = false;\n                vjsPlayer.recsys.watchedDuration = {\n                  total: 0,\n                  lastTimestamp: -1\n                };\n              }\n\n              if (!embedded) {\n                vjsPlayer.bigPlayButton && window.player.bigPlayButton.hide();\n              } else {\n                // $FlowIssue\n                (_vjsPlayer$bigPlayBut = vjsPlayer.bigPlayButton) === null || _vjsPlayer$bigPlayBut === void 0 ? void 0 : _vjsPlayer$bigPlayBut.show();\n              } // I think this is a callback function\n\n\n              videoNode = containerRef.current && containerRef.current.querySelector('video, audio'); // add theatre and autoplay next button and initiate player events\n\n              onPlayerReady(vjsPlayer, videoNode); // Set reference in component state\n\n              playerRef.current = vjsPlayer;\n              initializeEvents(); // volume control div, used for changing volume when scrolled over\n              // $FlowIssue\n\n              volumePanelRef.current = (_playerRef$current = playerRef.current) === null || _playerRef$current === void 0 ? void 0 : (_playerRef$current$co = _playerRef$current.controlBar) === null || _playerRef$current$co === void 0 ? void 0 : (_playerRef$current$co2 = _playerRef$current$co.getChild(VIDEOJS_VOLUME_PANEL_CLASS)) === null || _playerRef$current$co2 === void 0 ? void 0 : _playerRef$current$co2.el();\n              keyDownHandler = createKeyDownShortcutsHandler(playerRef, containerRef);\n              videoScrollHandler = createVideoScrollShortcutsHandler(playerRef, containerRef);\n              volumePanelHandler = createVolumePanelScrollShortcutsHandler(volumePanelRef, playerRef, containerRef);\n              window.addEventListener('keydown', keyDownHandler);\n              containerDiv = containerRef.current;\n              containerDiv && containerDiv.addEventListener('wheel', videoScrollHandler);\n              if (volumePanelRef.current) volumePanelRef.current.addEventListener('wheel', volumePanelHandler);\n              keyDownHandlerRef.current = keyDownHandler;\n              videoScrollHandlerRef.current = videoScrollHandler;\n              volumePanelScrollHandlerRef.current = volumePanelHandler; // $FlowIssue\n\n              (_vjsPlayer$controlBar7 = vjsPlayer.controlBar) === null || _vjsPlayer$controlBar7 === void 0 ? void 0 : _vjsPlayer$controlBar7.show(); // vjsPlayer.poster(poster);\n\n              vjsPlayer.el().childNodes[0].setAttribute('playsinline', ''); // let contentUrl;\n              // TODO: pull this function into videojs-functions\n              // determine which source to use and load it\n\n              if (!isLivestream) {\n                _context2.next = 38;\n                break;\n              }\n\n              vjsPlayer.isLivestream = true;\n              vjsPlayer.addClass('livestreamPlayer');\n              vjsPlayer.src({\n                type: 'application/x-mpegURL',\n                src: livestreamVideoUrl\n              });\n              _context2.next = 50;\n              break;\n\n            case 38:\n              vjsPlayer.isLivestream = false;\n              vjsPlayer.removeClass('livestreamPlayer');\n              _context2.next = 42;\n              return regeneratorRuntime.awrap(fetch(source, {\n                method: 'HEAD',\n                cache: 'no-store'\n              }));\n\n            case 42:\n              response = _context2.sent;\n              playerServerRef.current = response.headers.get('x-powered-by');\n              vjsPlayer.claimSrcOriginal = {\n                type: sourceType,\n                src: source\n              }; // remove query params for secured endpoints (which have query params on end of m3u8 path)\n\n              trimmedUrl = new URL(response.url);\n              trimmedUrl.hash = '';\n              trimmedUrl.search = '';\n              trimmedUrl = trimmedUrl.toString(); // change to m3u8 if applicable\n\n              if (response && response.redirected && response.url && trimmedUrl.endsWith('m3u8')) {\n                vjsPlayer.claimSrcVhs = {\n                  type: 'application/x-mpegURL',\n                  src: response.url\n                };\n                vjsPlayer.src(vjsPlayer.claimSrcVhs);\n\n                if (window.cordova) {\n                  payload = {\n                    uri: response.url,\n                    claim: claimValues,\n                    fileType: 'application/x-mpegURL',\n                    channel: channelTitle\n                  };\n                  window.odysee.chromecast.setMediaPayload(payload);\n                }\n              } else {\n                fix = source + '#.mp4';\n                vjsPlayer.src(fix);\n\n                if (window.cordova) {\n                  _payload = {\n                    uri: vjsPlayer.claimSrcOriginal,\n                    claim: claimValues,\n                    fileType: sourceType,\n                    channel: channelTitle\n                  };\n                  window.odysee.chromecast.setMediaPayload(_payload);\n                }\n              }\n\n            case 50:\n              // bugfix thumbnails showing up if new video doesn't have them\n              if (typeof vjsPlayer.vttThumbnails.detach === 'function') {\n                vjsPlayer.vttThumbnails.detach();\n              }\n\n              vjsPlayer.load();\n\n              if (canUseOldPlayer) {\n                // $FlowIssue\n                (_document$querySelect = document.querySelector('.video-js-parent')) === null || _document$querySelect === void 0 ? void 0 : _document$querySelect.append(window.oldSavedDiv);\n              } // disable right-click (context-menu) for purchased content\n\n\n              if (isPurchasableContent || isRentableContent) {\n                player = document.querySelector('video.vjs-tech');\n                if (player) player.setAttribute('oncontextmenu', 'return false;');\n              } // allow tap to unmute if no perms on iOS\n\n\n              if (autoplay && !embedded) {\n                promise = vjsPlayer.play();\n                window.player.userActive(true);\n\n                if (promise !== undefined) {\n                  promise.then(function (_) {\n                    var _vjsPlayer; // $FlowIssue\n\n\n                    (_vjsPlayer = vjsPlayer) === null || _vjsPlayer === void 0 ? void 0 : _vjsPlayer.controlBar.el().classList.add('vjs-transitioning-video');\n                  })[\"catch\"](function (error) {\n                    var noPermissionError = _typeof(error) === 'object' && error.name && error.name === 'NotAllowedError';\n\n                    if (noPermissionError) {\n                      if (IS_IOS) {\n                        var _vjsPlayer2, _vjsPlayer3; // autoplay not allowed, mute video, play and show 'tap to unmute' button\n                        // $FlowIssue\n\n\n                        (_vjsPlayer2 = vjsPlayer) === null || _vjsPlayer2 === void 0 ? void 0 : _vjsPlayer2.muted(true); // $FlowIssue\n\n                        var mutedPlayPromise = (_vjsPlayer3 = vjsPlayer) === null || _vjsPlayer3 === void 0 ? void 0 : _vjsPlayer3.play();\n\n                        if (mutedPlayPromise !== undefined) {\n                          mutedPlayPromise.then(function () {\n                            var tapToUnmuteButton = document.querySelector('.video-js--tap-to-unmute'); // $FlowIssue\n\n                            tapToUnmuteButton === null || tapToUnmuteButton === void 0 ? void 0 : tapToUnmuteButton.style.setProperty('visibility', 'visible'); // $FlowIssue\n\n                            tapToUnmuteButton === null || tapToUnmuteButton === void 0 ? void 0 : tapToUnmuteButton.style.setProperty('display', 'inline', 'important');\n                          })[\"catch\"](function (error) {\n                            var _vjsPlayer4, _vjsPlayer5, _document$querySelect2, _document$querySelect3; // $FlowFixMe\n\n\n                            (_vjsPlayer4 = vjsPlayer) === null || _vjsPlayer4 === void 0 ? void 0 : _vjsPlayer4.addClass('vjs-paused'); // $FlowFixMe\n\n                            (_vjsPlayer5 = vjsPlayer) === null || _vjsPlayer5 === void 0 ? void 0 : _vjsPlayer5.addClass('vjs-has-started'); // $FlowFixMe\n\n                            (_document$querySelect2 = document.querySelector('.vjs-touch-overlay')) === null || _document$querySelect2 === void 0 ? void 0 : _document$querySelect2.classList.add('show-play-toggle'); // $FlowFixMe\n\n                            (_document$querySelect3 = document.querySelector('.vjs-play-control')) === null || _document$querySelect3 === void 0 ? void 0 : _document$querySelect3.classList.add('vjs-paused');\n                          });\n                        }\n                      } else {\n                        var _vjsPlayer6, _vjsPlayer6$bigPlayBu; // $FlowIssue\n\n\n                        (_vjsPlayer6 = vjsPlayer) === null || _vjsPlayer6 === void 0 ? void 0 : (_vjsPlayer6$bigPlayBu = _vjsPlayer6.bigPlayButton) === null || _vjsPlayer6$bigPlayBu === void 0 ? void 0 : _vjsPlayer6$bigPlayBu.show();\n                      }\n                    }\n                  });\n                }\n              }\n\n            case 55:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      });\n    })(); // Cleanup\n\n\n    return function () {\n      window.removeEventListener('keydown', keyDownHandlerRef.current);\n      var containerDiv = containerRef.current; // $FlowFixMe\n\n      containerDiv && containerDiv.removeEventListener('wheel', videoScrollHandlerRef.current);\n\n      if (volumePanelRef.current) {\n        volumePanelRef.current.removeEventListener('wheel', volumePanelScrollHandlerRef.current);\n      }\n\n      var chapterMarkers = document.getElementsByClassName('vjs-chapter-marker');\n\n      while (chapterMarkers.length > 0) {\n        var _chapterMarkers$0$par; // $FlowIssue\n\n\n        (_chapterMarkers$0$par = chapterMarkers[0].parentNode) === null || _chapterMarkers$0$par === void 0 ? void 0 : _chapterMarkers$0$par.removeChild(chapterMarkers[0]);\n      }\n\n      var player = playerRef.current;\n\n      if (player) {\n        var _window$player, _window$player$tech_;\n\n        try {\n          window.cast.framework.CastContext.getInstance().getCurrentSession().endSession(false);\n        } catch (_unused) {}\n\n        window.player.switchedFromDefaultQuality = false;\n        window.player.userActive(false);\n        window.player.pause();\n\n        if (IS_IOS) {\n          var _window$player$contro, _window$player$contro2; // $FlowIssue\n\n\n          (_window$player$contro = window.player.controlBar) === null || _window$player$contro === void 0 ? void 0 : (_window$player$contro2 = _window$player$contro.playToggle) === null || _window$player$contro2 === void 0 ? void 0 : _window$player$contro2.hide();\n        } // this solves an issue with portrait videos\n        // $FlowIssue\n\n\n        var videoDiv = (_window$player = window.player) === null || _window$player === void 0 ? void 0 : (_window$player$tech_ = _window$player.tech_) === null || _window$player$tech_ === void 0 ? void 0 : _window$player$tech_.el(); // video element\n\n        if (videoDiv) videoDiv.style.top = '0px';\n        window.player.controlBar.el().classList.add('vjs-transitioning-video');\n        window.oldSavedDiv = window.player.el();\n        window.player.trigger('playerClosed'); // stop streams running in background\n\n        window.player.loadTech_('html5', null);\n        window.player.currentTime(0); // makes the current time update immediately\n\n        window.player.trigger('timeupdate');\n        window.player.claimSrcVhs = null;\n      }\n    };\n  }, [isAudio, source, reload, userClaimId, isLivestreamClaim]);\n  return react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement(\"div\", {\n    className: classnames__WEBPACK_IMPORTED_MODULE_11___default()('video-js-parent', {\n      'video-js-parent--ios': IS_IOS\n    }),\n    ref: containerRef\n  }, react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement(component_button__WEBPACK_IMPORTED_MODULE_10__[\"default\"], {\n    label: __('Tap to unmute'),\n    button: \"link\",\n    icon: constants_icons__WEBPACK_IMPORTED_MODULE_7__[\"VOLUME_MUTED\"],\n    className: \"video-js--tap-to-unmute\",\n    onClick: unmuteAndHideHint,\n    ref: tapToUnmuteRef\n  }), react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement(component_button__WEBPACK_IMPORTED_MODULE_10__[\"default\"], {\n    label: __('Retry'),\n    button: \"link\",\n    icon: constants_icons__WEBPACK_IMPORTED_MODULE_7__[\"REFRESH\"],\n    className: \"video-js--tap-to-unmute\",\n    onClick: retryVideoAfterFailure,\n    ref: tapToRetryRef\n  }));\n}));\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! i18n.js */ \"../ui/i18n.js\")[\"__\"]))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi4vdWkvY29tcG9uZW50L3ZpZXdlcnMvdmlkZW9WaWV3ZXIvaW50ZXJuYWwvdmlkZW9qcy5qc3guanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi4vdWkvY29tcG9uZW50L3ZpZXdlcnMvdmlkZW9WaWV3ZXIvaW50ZXJuYWwvdmlkZW9qcy5qc3g/OGQ4ZCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBAZmxvd1xuaW1wb3J0ICd2aWRlb2pzLWNvbnRyaWItYWRzJzsgLy8gbXVzdCBiZSBsb2FkZWQgaW4gdGhpcyBvcmRlclxuaW1wb3J0ICd2aWRlb2pzLWltYSc7IC8vIGxvYWRzIGRpcmVjdGx5IGFmdGVyIGNvbnRyaWItYWRzXG5pbXBvcnQgJ3ZpZGVvanMtdnR0LXRodW1ibmFpbHMnO1xuaW1wb3J0ICd2aWRlby5qcy9kaXN0L2FsdC92aWRlby1qcy1jZG4ubWluLmNzcyc7XG5pbXBvcnQgJy4vcGx1Z2lucy92aWRlb2pzLW1vYmlsZS11aS9wbHVnaW4nO1xuaW1wb3J0ICdAc2lsdmVybWluZS92aWRlb2pzLWNocm9tZWNhc3QvZGlzdC9zaWx2ZXJtaW5lLXZpZGVvanMtY2hyb21lY2FzdC5jc3MnO1xuaW1wb3J0ICdAc2lsdmVybWluZS92aWRlb2pzLWFpcnBsYXkvZGlzdC9zaWx2ZXJtaW5lLXZpZGVvanMtYWlycGxheS5jc3MnO1xuaW1wb3J0ICogYXMgSUNPTlMgZnJvbSAnY29uc3RhbnRzL2ljb25zJztcbmltcG9ydCB7IFZJREVPX1BMQVlCQUNLX1JBVEVTIH0gZnJvbSAnY29uc3RhbnRzL3BsYXllcic7XG5pbXBvcnQgKiBhcyBPVkVSTEFZIGZyb20gJy4vb3ZlcmxheXMnO1xuaW1wb3J0IEJ1dHRvbiBmcm9tICdjb21wb25lbnQvYnV0dG9uJztcbmltcG9ydCBjbGFzc25hbWVzIGZyb20gJ2NsYXNzbmFtZXMnO1xuaW1wb3J0IGV2ZW50cyBmcm9tICcuL3ZpZGVvanMtZXZlbnRzJztcbmltcG9ydCBldmVudFRyYWNraW5nIGZyb20gJ3ZpZGVvanMtZXZlbnQtdHJhY2tpbmcnO1xuaW1wb3J0IGZ1bmN0aW9ucyBmcm9tICcuL3ZpZGVvanMtZnVuY3Rpb25zJztcbmltcG9ydCBobHNRdWFsaXR5U2VsZWN0b3IgZnJvbSAnLi9wbHVnaW5zL3ZpZGVvanMtaGxzLXF1YWxpdHktc2VsZWN0b3IvcGx1Z2luJztcbmltcG9ydCBrZXlib2FyZFNob3JjdXRzIGZyb20gJy4vdmlkZW9qcy1zaG9ydGN1dHMnO1xuaW1wb3J0IExicnlQbGF5YmFja1JhdGVNZW51QnV0dG9uIGZyb20gJy4vbGJyeS1wbGF5YmFjay1yYXRlJztcbi8vIGltcG9ydCBMYnJ5Vm9sdW1lQmFyQ2xhc3MgZnJvbSAnLi9sYnJ5LXZvbHVtZS1iYXInO1xuLy8gaW1wb3J0IENocm9tZWNhc3QgZnJvbSAnLi9jaHJvbWVjYXN0JztcbmltcG9ydCBwbGF5ZXJqcyBmcm9tICdwbGF5ZXIuanMnO1xuaW1wb3J0IHF1YWxpdHlMZXZlbHMgZnJvbSAndmlkZW9qcy1jb250cmliLXF1YWxpdHktbGV2ZWxzJztcbmltcG9ydCBSZWFjdCwgeyB1c2VFZmZlY3QsIHVzZVJlZiwgdXNlU3RhdGUgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgaTE4biBmcm9tICcuL3BsdWdpbnMvdmlkZW9qcy1pMThuL3BsdWdpbic7XG5pbXBvcnQgcmVjc3lzIGZyb20gJy4vcGx1Z2lucy92aWRlb2pzLXJlY3N5cy9wbHVnaW4nO1xuLy8gaW1wb3J0IHJ1bkFkcyBmcm9tICcuL2Fkcyc7XG5pbXBvcnQgdmlkZW9qcyBmcm9tICd2aWRlby5qcyc7XG5pbXBvcnQgeyB1c2VJc01vYmlsZSB9IGZyb20gJ2VmZmVjdHMvdXNlLXNjcmVlbnNpemUnO1xuaW1wb3J0IHsgcGxhdGZvcm0gfSBmcm9tICd1dGlsL3BsYXRmb3JtJztcbmltcG9ydCB1c2VQZXJzaXN0ZWRTdGF0ZSBmcm9tICdlZmZlY3RzL3VzZS1wZXJzaXN0ZWQtc3RhdGUnO1xuXG5jb25zdCBjYW5BdXRvcGxheVZpZGVvID0gcmVxdWlyZSgnLi9wbHVnaW5zL2NhbkF1dG9wbGF5Jyk7XG5cbi8vIHJlcXVpcmUoJ0BuZWtvL3ZpZGVvanMtY2hyb21lY2FzdCcpKHZpZGVvanMpO1xuXG5leHBvcnQgdHlwZSBQbGF5ZXIgPSB7XG4gIC8vIC0tIGN1c3RvbSAtLVxuICBjbGFpbVNyY09yaWdpbmFsOiA/eyBzcmM6IHN0cmluZywgdHlwZTogc3RyaW5nIH0sXG4gIGNsYWltU3JjVmhzOiA/eyBzcmM6IHN0cmluZywgdHlwZTogc3RyaW5nIH0sXG4gIGlzTGl2ZXN0cmVhbT86IGJvb2xlYW4sXG4gIC8vIC0tIHBsdWdpbnMgLS0tXG4gIG1vYmlsZVVpOiAoYW55KSA9PiB2b2lkLFxuICBjaHJvbWVjYXN0OiAoYW55KSA9PiB2b2lkLFxuICBvdmVybGF5OiAoYW55KSA9PiB2b2lkLFxuICBobHNRdWFsaXR5U2VsZWN0b3I6ID9hbnksXG4gIGkxOG46IChhbnkpID0+IHZvaWQsXG4gIC8vIC0tIGJhc2UgdmlkZW9qcyAtLVxuICBjb250cm9sQmFyOiB7XG4gICAgYWRkQ2hpbGQ6IChzdHJpbmcgfCBhbnksID9hbnksID9udW1iZXIpID0+IHZvaWQsXG4gICAgZ2V0Q2hpbGQ6IChzdHJpbmcpID0+IHZvaWQsXG4gICAgcmVtb3ZlQ2hpbGQ6IChzdHJpbmcpID0+IHZvaWQsXG4gIH0sXG4gIGxvYWRpbmdTcGlubmVyOiBhbnksXG4gIGF1dG9wbGF5OiAoYW55KSA9PiBib29sZWFuLFxuICB0ZWNoOiAoP2Jvb2xlYW4pID0+IHsgdmhzOiA/YW55IH0sXG4gIGN1cnJlbnRUaW1lOiAoP251bWJlcikgPT4gbnVtYmVyLFxuICBkaXNwb3NlOiAoKSA9PiB2b2lkLFxuICBkdXJhdGlvbjogKCkgPT4gbnVtYmVyLFxuICBlbmRlZDogKCkgPT4gYm9vbGVhbixcbiAgZXJyb3I6ICgpID0+IGFueSxcbiAgZXhpdEZ1bGxzY3JlZW46ICgpID0+IGJvb2xlYW4sXG4gIGdldENoaWxkOiAoc3RyaW5nKSA9PiBhbnksXG4gIGlzRnVsbHNjcmVlbjogKCkgPT4gYm9vbGVhbixcbiAgbXV0ZWQ6ICg/Ym9vbGVhbikgPT4gYm9vbGVhbixcbiAgb246IChzdHJpbmcsIChhbnkpID0+IHZvaWQpID0+IHZvaWQsXG4gIG9mZjogKHN0cmluZywgKGFueSkgPT4gdm9pZCkgPT4gdm9pZCxcbiAgb25lOiAoc3RyaW5nLCAoYW55KSA9PiB2b2lkKSA9PiB2b2lkLFxuICBwbGF5OiAoKSA9PiBQcm9taXNlPGFueT4sXG4gIHBsYXliYWNrUmF0ZTogKD9udW1iZXIpID0+IG51bWJlcixcbiAgcmVhZHlTdGF0ZTogKCkgPT4gbnVtYmVyLFxuICByZXF1ZXN0RnVsbHNjcmVlbjogKCkgPT4gYm9vbGVhbixcbiAgc3JjOiAoeyBzcmM6IHN0cmluZywgdHlwZTogc3RyaW5nIH0pID0+ID9zdHJpbmcsXG4gIGN1cnJlbnRTcmM6ICgpID0+IHN0cmluZyxcbiAgdXNlckFjdGl2ZTogKD9ib29sZWFuKSA9PiBib29sZWFuLFxuICB2b2x1bWU6ICg/bnVtYmVyKSA9PiBudW1iZXIsXG59O1xuXG50eXBlIFByb3BzID0ge1xuICBhZFVybDogP3N0cmluZyxcbiAgYWxsb3dQcmVSb2xsOiA/Ym9vbGVhbixcbiAgYXV0b3BsYXk6IGJvb2xlYW4sXG4gIGNsYWltSWQ6ID9zdHJpbmcsXG4gIHRpdGxlOiA/c3RyaW5nLFxuICBjaGFubmVsTmFtZTogc3RyaW5nLFxuICBjaGFubmVsVGl0bGU6IHN0cmluZyxcbiAgZW1iZWRkZWQ6IGJvb2xlYW4sIC8vIGAvJC9lbWJlZGBcbiAgZW1iZWRkZWRJbnRlcm5hbDogYm9vbGVhbiwgLy8gTWFya2Rvd24gKFBvc3RzIGFuZCBDb21tZW50cylcbiAgaW50ZXJuYWxGZWF0dXJlRW5hYmxlZDogP2Jvb2xlYW4sXG4gIGlzQXVkaW86IGJvb2xlYW4sXG4gIC8vIHBvc3RlcjogP3N0cmluZyxcbiAgc2hhcmVUZWxlbWV0cnk6IGJvb2xlYW4sXG4gIHNvdXJjZTogc3RyaW5nLFxuICBzb3VyY2VUeXBlOiBzdHJpbmcsXG4gIHN0YXJ0TXV0ZWQ6IGJvb2xlYW4sXG4gIHVzZXJJZDogP251bWJlcixcbiAgZGVmYXVsdFF1YWxpdHk6ID9zdHJpbmcsXG4gIG9uUGxheWVyUmVhZHk6IChQbGF5ZXIsIGFueSkgPT4gdm9pZCxcbiAgcGxheU5leHQ6ICgpID0+IHZvaWQsXG4gIHBsYXlQcmV2aW91czogKCkgPT4gdm9pZCxcbiAgdG9nZ2xlVmlkZW9UaGVhdGVyTW9kZTogKCkgPT4gdm9pZCxcbiAgY2xhaW1SZXdhcmRzOiAoKSA9PiB2b2lkLFxuICBkb0FuYWx5dGljc1ZpZXc6IChzdHJpbmcsIG51bWJlcikgPT4gdm9pZCxcbiAgZG9BbmFseXRpY3NCdWZmZXI6IChzdHJpbmcsIGFueSkgPT4gdm9pZCxcbiAgdXJpOiBzdHJpbmcsXG4gIGNsYWltVmFsdWVzOiBhbnksXG4gIGlzTGl2ZXN0cmVhbUNsYWltOiBib29sZWFuLFxuICB1c2VyQ2xhaW1JZDogP3N0cmluZyxcbiAgYWN0aXZlTGl2ZXN0cmVhbUZvckNoYW5uZWw6IGFueSxcbiAgZG9Ub2FzdDogKHsgbWVzc2FnZTogc3RyaW5nLCBsaW5rVGV4dDogc3RyaW5nLCBsaW5rVGFyZ2V0OiBzdHJpbmcgfSkgPT4gdm9pZCxcbiAgaXNQdXJjaGFzYWJsZUNvbnRlbnQ6IGJvb2xlYW4sXG4gIGlzUmVudGFibGVDb250ZW50OiBib29sZWFuLFxufTtcblxuY29uc3QgVklERU9KU19WT0xVTUVfUEFORUxfQ0xBU1MgPSAnVm9sdW1lUGFuZWwnO1xuXG5jb25zdCBJU19JT1MgPSBwbGF0Zm9ybS5pc0lPUygpO1xuXG5jb25zdCBQTFVHSU5fTUFQID0ge1xuICBldmVudFRyYWNraW5nOiBldmVudFRyYWNraW5nLFxuICBobHNRdWFsaXR5U2VsZWN0b3I6IGhsc1F1YWxpdHlTZWxlY3RvcixcbiAgcXVhbGl0eUxldmVsczogcXVhbGl0eUxldmVscyxcbiAgcmVjc3lzOiByZWNzeXMsXG4gIGkxOG46IGkxOG4sXG59O1xuXG5PYmplY3QuZW50cmllcyhQTFVHSU5fTUFQKS5mb3JFYWNoKChbcGx1Z2luTmFtZSwgcGx1Z2luXSkgPT4ge1xuICBpZiAoIU9iamVjdC5rZXlzKHZpZGVvanMuZ2V0UGx1Z2lucygpKS5pbmNsdWRlcyhwbHVnaW5OYW1lKSkge1xuICAgIHZpZGVvanMucmVnaXN0ZXJQbHVnaW4ocGx1Z2luTmFtZSwgcGx1Z2luKTtcbiAgfVxufSk7XG5cbi8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbi8vIFZpZGVvSnNcbi8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcblxuLypcbnByb3BlcnRpZXMgZm9yIHRoaXMgY29tcG9uZW50IHNob3VsZCBiZSBrZXB0IHRvIE9OTFkgdGhvc2UgdGhhdCBpZiBjaGFuZ2VkIHNob3VsZCBSRVFVSVJFIGFuIGVudGlyZWx5IG5ldyB2aWRlb2pzIGVsZW1lbnRcbiAqL1xuZXhwb3J0IGRlZmF1bHQgUmVhY3QubWVtbzxQcm9wcz4oZnVuY3Rpb24gVmlkZW9Kcyhwcm9wczogUHJvcHMpIHtcbiAgY29uc3Qge1xuICAgIC8vIGFkVXJsLCAvLyBUT0RPOiB0aGlzIGFkIGZ1bmN0aW9uYWxpdHkgaXNuJ3QgdXNlZCwgY2FuIGJlIHB1bGxlZCBvdXRcbiAgICAvLyBhbGxvd1ByZVJvbGwsXG4gICAgYXV0b3BsYXksXG4gICAgY2xhaW1JZCxcbiAgICBjaGFubmVsTmFtZSxcbiAgICBjaGFubmVsVGl0bGUsXG4gICAgZW1iZWRkZWQsXG4gICAgZW1iZWRkZWRJbnRlcm5hbCxcbiAgICAvLyBpbnRlcm5hbEZlYXR1cmVFbmFibGVkLCAvLyBmb3IgcGVvcGxlIG9uIHRoZSB0ZWFtIHRvIHRlc3QgbmV3IGZlYXR1cmVzIGludGVybmFsbHlcbiAgICBpc0F1ZGlvLFxuICAgIC8vIHBvc3RlcixcbiAgICBzaGFyZVRlbGVtZXRyeSxcbiAgICBzb3VyY2UsXG4gICAgc291cmNlVHlwZSxcbiAgICBzdGFydE11dGVkLFxuICAgIHVzZXJJZCxcbiAgICBkZWZhdWx0UXVhbGl0eSxcbiAgICBvblBsYXllclJlYWR5LFxuICAgIHBsYXlOZXh0LFxuICAgIHBsYXlQcmV2aW91cyxcbiAgICB0b2dnbGVWaWRlb1RoZWF0ZXJNb2RlLFxuICAgIGNsYWltVmFsdWVzLFxuICAgIGRvQW5hbHl0aWNzVmlldyxcbiAgICBkb0FuYWx5dGljc0J1ZmZlcixcbiAgICBjbGFpbVJld2FyZHMsXG4gICAgdXJpLFxuICAgIHVzZXJDbGFpbUlkLFxuICAgIGlzTGl2ZXN0cmVhbUNsYWltLFxuICAgIGFjdGl2ZUxpdmVzdHJlYW1Gb3JDaGFubmVsLFxuICAgIGRvVG9hc3QsXG4gICAgaXNQdXJjaGFzYWJsZUNvbnRlbnQsXG4gICAgaXNSZW50YWJsZUNvbnRlbnQsXG4gIH0gPSBwcm9wcztcblxuICAvLyB1c2VkIHRvIG5vdGlmeSBhYm91dCBkZWZhdWx0IHF1YWxpdHkgc2V0dGluZ1xuICAvLyBpZiBhbHJlYWR5IGhhcyBhIHF1YWxpdHkgc2V0LCBubyBuZWVkIHRvIG5vdGlmeVxuICBjb25zdCBbaW5pdGlhbFF1YWxpdHlDaGFuZ2UsIHNldEluaXRpYWxRdWFsaXR5Q2hhbmdlXSA9IHVzZVBlcnNpc3RlZFN0YXRlKFxuICAgICdpbml0aWFsLXF1YWxpdHktY2hhbmdlJyxcbiAgICBCb29sZWFuKGRlZmF1bHRRdWFsaXR5KVxuICApO1xuXG4gIGNvbnN0IGlzTW9iaWxlID0gdXNlSXNNb2JpbGUoKTtcblxuICBjb25zdCBwbGF5ZXJSZWYgPSB1c2VSZWYoKTtcbiAgY29uc3QgY29udGFpbmVyUmVmID0gdXNlUmVmKCk7XG4gIGNvbnN0IHRhcFRvVW5tdXRlUmVmID0gdXNlUmVmKCk7XG4gIGNvbnN0IHRhcFRvUmV0cnlSZWYgPSB1c2VSZWYoKTtcbiAgY29uc3QgcGxheWVyU2VydmVyUmVmID0gdXNlUmVmKCk7XG4gIGNvbnN0IHZvbHVtZVBhbmVsUmVmID0gdXNlUmVmKCk7XG5cbiAgY29uc3Qga2V5RG93bkhhbmRsZXJSZWYgPSB1c2VSZWYoKTtcbiAgY29uc3QgdmlkZW9TY3JvbGxIYW5kbGVyUmVmID0gdXNlUmVmKCk7XG4gIGNvbnN0IHZvbHVtZVBhbmVsU2Nyb2xsSGFuZGxlclJlZiA9IHVzZVJlZigpO1xuXG4gIGNvbnN0IHsgdXJsOiBsaXZlc3RyZWFtVmlkZW9VcmwgfSA9IGFjdGl2ZUxpdmVzdHJlYW1Gb3JDaGFubmVsIHx8IHt9O1xuICBjb25zdCBvdmVycmlkZU5hdGl2ZVZocyA9ICFwbGF0Zm9ybS5pc0lQaG9uZSgpO1xuICBjb25zdCBzaG93UXVhbGl0eVNlbGVjdG9yID0gKCFpc0xpdmVzdHJlYW1DbGFpbSAmJiBvdmVycmlkZU5hdGl2ZVZocykgfHwgbGl2ZXN0cmVhbVZpZGVvVXJsO1xuXG4gIC8vIGluaXRpYXRlIGtleWJvYXJkIHNob3J0Y3V0c1xuICBjb25zdCB7XG4gICAgY3JlYXRlS2V5RG93blNob3J0Y3V0c0hhbmRsZXIsXG4gICAgY3JlYXRlVmlkZW9TY3JvbGxTaG9ydGN1dHNIYW5kbGVyLFxuICAgIGNyZWF0ZVZvbHVtZVBhbmVsU2Nyb2xsU2hvcnRjdXRzSGFuZGxlcixcbiAgfSA9IGtleWJvYXJkU2hvcmN1dHMoe1xuICAgIGlzTW9iaWxlLFxuICAgIGlzTGl2ZXN0cmVhbUNsYWltLFxuICAgIHRvZ2dsZVZpZGVvVGhlYXRlck1vZGUsXG4gICAgcGxheU5leHQsXG4gICAgcGxheVByZXZpb3VzLFxuICB9KTtcblxuICBjb25zdCBbcmVsb2FkLCBzZXRSZWxvYWRdID0gdXNlU3RhdGUoJ2luaXRpYWwnKTtcblxuICBjb25zdCB7IGNyZWF0ZVZpZGVvUGxheWVyRE9NIH0gPSBmdW5jdGlvbnMoeyBpc0F1ZGlvIH0pO1xuXG4gIGNvbnN0IHsgdW5tdXRlQW5kSGlkZUhpbnQsIHJldHJ5VmlkZW9BZnRlckZhaWx1cmUsIGluaXRpYWxpemVFdmVudHMgfSA9IGV2ZW50cyh7XG4gICAgdGFwVG9Vbm11dGVSZWYsXG4gICAgdGFwVG9SZXRyeVJlZixcbiAgICBzZXRSZWxvYWQsXG4gICAgcGxheWVyUmVmLFxuICAgIGNsYWltVmFsdWVzLFxuICAgIHVzZXJJZCxcbiAgICBjbGFpbUlkLFxuICAgIGVtYmVkZGVkLFxuICAgIGRvQW5hbHl0aWNzVmlldyxcbiAgICBkb0FuYWx5dGljc0J1ZmZlcixcbiAgICBjbGFpbVJld2FyZHMsXG4gICAgdXJpLFxuICAgIHBsYXllclNlcnZlclJlZixcbiAgICBpc0xpdmVzdHJlYW1DbGFpbSxcbiAgICBjaGFubmVsVGl0bGUsXG4gIH0pO1xuXG4gIGNvbnN0IHZpZGVvSnNPcHRpb25zID0ge1xuICAgIHByZWxvYWQ6ICdhdXRvJyxcbiAgICBwbGF5YmFja1JhdGVzOiBWSURFT19QTEFZQkFDS19SQVRFUyxcbiAgICByZXNwb25zaXZlOiB0cnVlLFxuICAgIGNvbnRyb2xzOiB0cnVlLFxuICAgIGh0bWw1OiB7XG4gICAgICB2aHM6IHtcbiAgICAgICAgb3ZlcnJpZGVOYXRpdmU6IG92ZXJyaWRlTmF0aXZlVmhzLCAvLyAhdmlkZW9qcy5icm93c2VyLklTX0FOWV9TQUZBUkksXG4gICAgICAgIGVuYWJsZUxvd0luaXRpYWxQbGF5bGlzdDogZmFsc2UsXG4gICAgICAgIGZhc3RRdWFsaXR5Q2hhbmdlOiB0cnVlLFxuICAgICAgICB1c2VEdHNGb3JUaW1lc3RhbXBPZmZzZXQ6IHRydWUsXG4gICAgICB9LFxuICAgIH0sXG4gICAgbGl2ZVRyYWNrZXI6IHtcbiAgICAgIHRyYWNraW5nVGhyZXNob2xkOiAwLFxuICAgICAgbGl2ZVRvbGVyYW5jZTogMTAsXG4gICAgfSxcbiAgICBpbmFjdGl2aXR5VGltZW91dDogMjAwMCxcbiAgICBtdXRlZDogc3RhcnRNdXRlZCxcbiAgICBwbHVnaW5zOiB7IGV2ZW50VHJhY2tpbmc6IHRydWUsIG92ZXJsYXk6IE9WRVJMQVkuT1ZFUkxBWV9EQVRBIH0sXG4gICAgY29udHJvbEJhcjoge1xuICAgICAgY3VycmVudFRpbWVEaXNwbGF5OiB0cnVlLFxuICAgICAgdGltZURpdmlkZXI6IHRydWUsXG4gICAgICBkdXJhdGlvbkRpc3BsYXk6IHRydWUsXG4gICAgICByZW1haW5pbmdUaW1lRGlzcGxheTogdHJ1ZSxcbiAgICAgIHN1YnNDYXBzQnV0dG9uOiAhSVNfSU9TLFxuICAgIH0sXG4gICAgdGVjaE9yZGVyOiBbJ2h0bWw1J10sXG4gICAgYmlnUGxheUJ1dHRvbjogZW1iZWRkZWQsIC8vIG9ubHkgc2hvdyBiaWcgcGxheSBidXR0b24gaWYgZW1iZWRkZWRcbiAgICBzdXBwcmVzc05vdFN1cHBvcnRlZEVycm9yOiB0cnVlLFxuICAgIGxpdmV1aTogdHJ1ZSxcbiAgfTtcblxuICAvLyBUT0RPOiB3b3VsZCBiZSBuaWNlIHRvIHB1bGwgdGhpcyBvdXQgaW50byBmdW5jdGlvbnMgZmlsZVxuICAvLyBJbml0aWFsaXplIHZpZGVvLmpzXG4gIGZ1bmN0aW9uIGluaXRpYWxpemVWaWRlb1BsYXllcihkb21FbGVtZW50KSB7XG4gICAgaWYgKCFkb21FbGVtZW50KSByZXR1cm47XG5cbiAgICBjb25zdCB2anMgPSB2aWRlb2pzKGRvbUVsZW1lbnQsIHZpZGVvSnNPcHRpb25zLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBwbGF5ZXIgPSBwbGF5ZXJSZWYuY3VycmVudDtcbiAgICAgIGNvbnN0IGFkYXB0ZXIgPSBuZXcgcGxheWVyanMuVmlkZW9KU0FkYXB0ZXIocGxheWVyKTtcblxuICAgICAgLy8gdGhpcyBzZWVtcyBsaWtlIGEgd2VpcmQgdGhpbmcgdG8gaGF2ZSB0byBjaGVjayBmb3IgaGVyZVxuICAgICAgaWYgKCFwbGF5ZXIpIHJldHVybjtcblxuICAgICAgLy8gcnVuQWRzKGludGVybmFsRmVhdHVyZUVuYWJsZWQsIGFsbG93UHJlUm9sbCwgcGxheWVyLCBlbWJlZGRlZCk7XG5cbiAgICAgIExicnlQbGF5YmFja1JhdGVNZW51QnV0dG9uLnJlcGxhY2VFeGlzdGluZyhwbGF5ZXIpO1xuXG4gICAgICAvLyBBZGQgcmVsb2FkU291cmNlT25FcnJvciBwbHVnaW5cbiAgICAgIHBsYXllci5yZWxvYWRTb3VyY2VPbkVycm9yKHsgZXJyb3JJbnRlcnZhbDogMTAgfSk7XG5cbiAgICAgIC8vIEluaXRpYWxpemUgbW9iaWxlIFVJLlxuICAgICAgcGxheWVyLm1vYmlsZVVpKHtcbiAgICAgICAgZnVsbHNjcmVlbjoge1xuICAgICAgICAgIGVudGVyT25Sb3RhdGU6IGZhbHNlLFxuICAgICAgICB9LFxuICAgICAgICB0b3VjaENvbnRyb2xzOiB7XG4gICAgICAgICAgc2Vla1NlY29uZHM6IDEwLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIHBsYXllci5pMThuKCk7XG5cbiAgICAgIGlmICghZW1iZWRkZWQpIHtcbiAgICAgICAgd2luZG93LnBsYXllci5iaWdQbGF5QnV0dG9uICYmIHdpbmRvdy5wbGF5ZXIuYmlnUGxheUJ1dHRvbi5oaWRlKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBjb25zdCBiaWdQbGF5QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnZqcy1iaWctcGxheS1idXR0b24nKTtcbiAgICAgICAgLy8gaWYgKGJpZ1BsYXlCdXR0b24pIGJpZ1BsYXlCdXR0b24uc3R5bGUuc2V0UHJvcGVydHkoJ2Rpc3BsYXknLCAnYmxvY2snLCAnaW1wb3J0YW50Jyk7XG4gICAgICB9XG5cbiAgICAgIC8vIEFkZCBxdWFsaXR5IHNlbGVjdG9yIHRvIHBsYXllclxuICAgICAgaWYgKHNob3dRdWFsaXR5U2VsZWN0b3IpIHtcbiAgICAgICAgcGxheWVyLmhsc1F1YWxpdHlTZWxlY3Rvcih7XG4gICAgICAgICAgZGlzcGxheUN1cnJlbnRRdWFsaXR5OiB0cnVlLFxuICAgICAgICAgIG9yaWdpbmFsSGVpZ2h0OiBjbGFpbVZhbHVlcz8udmlkZW8/LmhlaWdodCxcbiAgICAgICAgICBkZWZhdWx0UXVhbGl0eSxcbiAgICAgICAgICBpbml0aWFsUXVhbGl0eUNoYW5nZSxcbiAgICAgICAgICBzZXRJbml0aWFsUXVhbGl0eUNoYW5nZSxcbiAgICAgICAgICBkb1RvYXN0LFxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gQWRkIHJlY3N5cyBwbHVnaW5cbiAgICAgIGlmIChzaGFyZVRlbGVtZXRyeSkge1xuICAgICAgICBwbGF5ZXIucmVjc3lzKHtcbiAgICAgICAgICB2aWRlb0lkOiBjbGFpbUlkLFxuICAgICAgICAgIHVzZXJJZDogdXNlcklkLFxuICAgICAgICAgIGVtYmVkZGVkOiBlbWJlZGRlZCB8fCBlbWJlZGRlZEludGVybmFsLFxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gc2V0IHBsYXlzaW5saW5lIGZvciBtb2JpbGVcbiAgICAgIHBsYXllci5jaGlsZHJlbl9bMF0uc2V0QXR0cmlidXRlKCdwbGF5c2lubGluZScsICcnKTtcblxuICAgICAgaWYgKGNhbkF1dG9wbGF5VmlkZW8gPT09IHRydWUpIHtcbiAgICAgICAgLy8gc2hvdyB3YWl0aW5nIHNwaW5uZXIgYXMgdmlkZW8gaXMgbG9hZGluZ1xuICAgICAgICBwbGF5ZXIuYWRkQ2xhc3MoJ3Zqcy13YWl0aW5nJyk7XG4gICAgICAgIC8vICRGbG93Rml4TWVcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnZqcy1iaWctcGxheS1idXR0b24nKS5zdHlsZS5zZXRQcm9wZXJ0eSgnZGlzcGxheScsICdub25lJywgJ2ltcG9ydGFudCcpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gJEZsb3dGaXhNZVxuICAgICAgICAvLyBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudmpzLWJpZy1wbGF5LWJ1dHRvbicpLnN0eWxlLnNldFByb3BlcnR5KCdkaXNwbGF5JywgJ2Jsb2NrJywgJ2ltcG9ydGFudCcpO1xuICAgICAgfVxuICAgICAgLy8gaW1tZWRpYXRlbHkgc2hvdyBjb250cm9sIGJhciB3aGlsZSB2aWRlbyBpcyBsb2FkaW5nXG4gICAgICBwbGF5ZXIudXNlckFjdGl2ZSh0cnVlKTtcblxuICAgICAgYWRhcHRlci5yZWFkeSgpO1xuXG4gICAgICAvLyBzb21ldGltZXMgdmlkZW8gZG9lc250IHN0YXJ0IHByb3Blcmx5LCB0aGlzIGFkZHJlc3NlcyB0aGUgZWRnZSBjYXNlXG4gICAgICBpZiAoYXV0b3BsYXkpIHtcbiAgICAgICAgY29uc3QgdmlkZW9EaXYgPSB3aW5kb3cucGxheWVyLmNoaWxkcmVuX1swXTtcbiAgICAgICAgaWYgKHZpZGVvRGl2KSB7XG4gICAgICAgICAgdmlkZW9EaXYuY2xpY2soKTtcbiAgICAgICAgfVxuICAgICAgICB3aW5kb3cucGxheWVyLnVzZXJBY3RpdmUodHJ1ZSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBmaXhlcyAjMzQ5OCAoaHR0cHM6Ly9naXRodWIuY29tL2xicnlpby9sYnJ5LWRlc2t0b3AvaXNzdWVzLzM0OTgpXG4gICAgLy8gc3VtbWFyeTogb24gZmlyZWZveCB0aGUgZm9jdXMgd291bGQgc3RpY2sgdG8gdGhlIGZ1bGxzY3JlZW4gYnV0dG9uIHdoaWNoIGNhdXNlZCBidWdneSBiZWhhdmlvciB3aXRoIHNwYWNlYmFyXG4gICAgdmpzLm9uKCdmdWxsc2NyZWVuY2hhbmdlJywgKCkgPT4gZG9jdW1lbnQuYWN0aXZlRWxlbWVudCAmJiBkb2N1bWVudC5hY3RpdmVFbGVtZW50LmJsdXIoKSk7XG5cbiAgICByZXR1cm4gdmpzO1xuICB9XG5cbiAgLy8gdXNlRWZmZWN0KCgpID0+IHtcbiAgLy8gICBpZiAoc2hvd1F1YWxpdHlTZWxlY3Rvcikge1xuICAvLyAgICAgLy8gQWRkIHF1YWxpdHkgc2VsZWN0b3IgdG8gcGxheWVyXG4gIC8vICAgICBjb25zdCBwbGF5ZXIgPSBwbGF5ZXJSZWYuY3VycmVudDtcbiAgLy8gICAgIGlmIChwbGF5ZXIpIHBsYXllci5obHNRdWFsaXR5U2VsZWN0b3IoeyBkaXNwbGF5Q3VycmVudFF1YWxpdHk6IHRydWUgfSk7XG4gIC8vICAgfVxuICAvLyB9LCBbc2hvd1F1YWxpdHlTZWxlY3Rvcl0pO1xuXG4gIC8qXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgQ2hyb21lY2FzdC51cGRhdGVUaXRsZXModGl0bGUsIGNoYW5uZWxUaXRsZSk7XG4gIH0sIFt0aXRsZSwgY2hhbm5lbFRpdGxlXSk7XG4gICovXG5cbiAgLy8gVGhpcyBsaWZlY3ljbGUgaG9vayBpcyBvbmx5IGNhbGxlZCBvbmNlIChvbiBtb3VudCksIG9yIHdoZW4gYGlzQXVkaW9gIG9yIGBzb3VyY2VgIGNoYW5nZXMuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgKGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCB2anNQbGF5ZXI7XG4gICAgICBjb25zdCB2anNQYXJlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudmlkZW8tanMtcGFyZW50Jyk7XG5cbiAgICAgIGxldCBjYW5Vc2VPbGRQbGF5ZXIgPSB3aW5kb3cub2xkU2F2ZWREaXYgJiYgdmpzUGFyZW50O1xuICAgICAgY29uc3QgaXNMaXZlc3RyZWFtID0gaXNMaXZlc3RyZWFtQ2xhaW0gJiYgdXNlckNsYWltSWQ7XG5cbiAgICAgIC8vIGluaXRpYWxpemUgdmlkZW9qcyBpZiBpdCBoYXNuJ3QgYmVlbiBkb25lIHlldFxuICAgICAgaWYgKCFjYW5Vc2VPbGRQbGF5ZXIpIHtcbiAgICAgICAgY29uc3QgdmpzRWxlbWVudCA9IGNyZWF0ZVZpZGVvUGxheWVyRE9NKGNvbnRhaW5lclJlZi5jdXJyZW50KTtcbiAgICAgICAgdmpzUGxheWVyID0gaW5pdGlhbGl6ZVZpZGVvUGxheWVyKHZqc0VsZW1lbnQpO1xuICAgICAgICBpZiAoIXZqc1BsYXllcikge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFkZCByZWZlcmVuY2UgdG8gcGxheWVyIHRvIGdsb2JhbCBzY29wZVxuICAgICAgICB3aW5kb3cucGxheWVyID0gdmpzUGxheWVyO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmpzUGxheWVyID0gd2luZG93LnBsYXllcjtcbiAgICAgIH1cblxuICAgICAgLy8gaGlkZSB1bnVzZWQgZWxlbWVudHMgb24gbGl2ZXN0cmVhbVxuICAgICAgaWYgKGlzTGl2ZXN0cmVhbSkge1xuICAgICAgICB2anNQbGF5ZXIuYWRkQ2xhc3MoJ3Zqcy1saXZlJyk7XG4gICAgICAgIHZqc1BsYXllci5hZGRDbGFzcygndmpzLWxpdmV1aScpO1xuICAgICAgICAvLyAkRmxvd0lzc3VlXG4gICAgICAgIHZqc1BsYXllci5jb250cm9sQmFyLmN1cnJlbnRUaW1lRGlzcGxheT8uZWwoKS5zdHlsZS5zZXRQcm9wZXJ0eSgnZGlzcGxheScsICdub25lJywgJ2ltcG9ydGFudCcpO1xuICAgICAgICAvLyAkRmxvd0lzc3VlXG4gICAgICAgIHZqc1BsYXllci5jb250cm9sQmFyLnRpbWVEaXZpZGVyPy5lbCgpLnN0eWxlLnNldFByb3BlcnR5KCdkaXNwbGF5JywgJ25vbmUnLCAnaW1wb3J0YW50Jyk7XG4gICAgICAgIC8vICRGbG93SXNzdWVcbiAgICAgICAgdmpzUGxheWVyLmNvbnRyb2xCYXIuZHVyYXRpb25EaXNwbGF5Py5lbCgpLnN0eWxlLnNldFByb3BlcnR5KCdkaXNwbGF5JywgJ25vbmUnLCAnaW1wb3J0YW50Jyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2anNQbGF5ZXIucmVtb3ZlQ2xhc3MoJ3Zqcy1saXZlJyk7XG4gICAgICAgIHZqc1BsYXllci5yZW1vdmVDbGFzcygndmpzLWxpdmV1aScpO1xuICAgICAgICAvLyAkRmxvd0lzc3VlXG4gICAgICAgIHZqc1BsYXllci5jb250cm9sQmFyLmN1cnJlbnRUaW1lRGlzcGxheT8uZWwoKS5zdHlsZS5zZXRQcm9wZXJ0eSgnZGlzcGxheScsICdibG9jaycsICdpbXBvcnRhbnQnKTtcbiAgICAgICAgLy8gJEZsb3dJc3N1ZVxuICAgICAgICB2anNQbGF5ZXIuY29udHJvbEJhci50aW1lRGl2aWRlcj8uZWwoKS5zdHlsZS5zZXRQcm9wZXJ0eSgnZGlzcGxheScsICdibG9jaycsICdpbXBvcnRhbnQnKTtcbiAgICAgICAgLy8gJEZsb3dJc3N1ZVxuICAgICAgICB2anNQbGF5ZXIuY29udHJvbEJhci5kdXJhdGlvbkRpc3BsYXk/LmVsKCkuc3R5bGUuc2V0UHJvcGVydHkoJ2Rpc3BsYXknLCAnYmxvY2snLCAnaW1wb3J0YW50Jyk7XG4gICAgICB9XG5cbiAgICAgIC8vIEFkZCByZWNzeXMgcGx1Z2luXG4gICAgICBpZiAoc2hhcmVUZWxlbWV0cnkpIHtcbiAgICAgICAgdmpzUGxheWVyLnJlY3N5cy5vcHRpb25zXyA9IHtcbiAgICAgICAgICB2aWRlb0lkOiBjbGFpbUlkLFxuICAgICAgICAgIHVzZXJJZDogdXNlcklkLFxuICAgICAgICAgIGVtYmVkZGVkOiBlbWJlZGRlZCB8fCBlbWJlZGRlZEludGVybmFsLFxuICAgICAgICB9O1xuXG4gICAgICAgIHZqc1BsYXllci5yZWNzeXMubGFzdFRpbWVVcGRhdGUgPSBudWxsO1xuICAgICAgICB2anNQbGF5ZXIucmVjc3lzLmN1cnJlbnRUaW1lVXBkYXRlID0gbnVsbDtcbiAgICAgICAgdmpzUGxheWVyLnJlY3N5cy5pblBhdXNlID0gZmFsc2U7XG4gICAgICAgIHZqc1BsYXllci5yZWNzeXMud2F0Y2hlZER1cmF0aW9uID0geyB0b3RhbDogMCwgbGFzdFRpbWVzdGFtcDogLTEgfTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFlbWJlZGRlZCkge1xuICAgICAgICB2anNQbGF5ZXIuYmlnUGxheUJ1dHRvbiAmJiB3aW5kb3cucGxheWVyLmJpZ1BsYXlCdXR0b24uaGlkZSgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gJEZsb3dJc3N1ZVxuICAgICAgICB2anNQbGF5ZXIuYmlnUGxheUJ1dHRvbj8uc2hvdygpO1xuICAgICAgfVxuXG4gICAgICAvLyBJIHRoaW5rIHRoaXMgaXMgYSBjYWxsYmFjayBmdW5jdGlvblxuICAgICAgY29uc3QgdmlkZW9Ob2RlID0gY29udGFpbmVyUmVmLmN1cnJlbnQgJiYgY29udGFpbmVyUmVmLmN1cnJlbnQucXVlcnlTZWxlY3RvcigndmlkZW8sIGF1ZGlvJyk7XG5cbiAgICAgIC8vIGFkZCB0aGVhdHJlIGFuZCBhdXRvcGxheSBuZXh0IGJ1dHRvbiBhbmQgaW5pdGlhdGUgcGxheWVyIGV2ZW50c1xuICAgICAgb25QbGF5ZXJSZWFkeSh2anNQbGF5ZXIsIHZpZGVvTm9kZSk7XG5cbiAgICAgIC8vIFNldCByZWZlcmVuY2UgaW4gY29tcG9uZW50IHN0YXRlXG4gICAgICBwbGF5ZXJSZWYuY3VycmVudCA9IHZqc1BsYXllcjtcblxuICAgICAgaW5pdGlhbGl6ZUV2ZW50cygpO1xuXG4gICAgICAvLyB2b2x1bWUgY29udHJvbCBkaXYsIHVzZWQgZm9yIGNoYW5naW5nIHZvbHVtZSB3aGVuIHNjcm9sbGVkIG92ZXJcbiAgICAgIC8vICRGbG93SXNzdWVcbiAgICAgIHZvbHVtZVBhbmVsUmVmLmN1cnJlbnQgPSBwbGF5ZXJSZWYuY3VycmVudD8uY29udHJvbEJhcj8uZ2V0Q2hpbGQoVklERU9KU19WT0xVTUVfUEFORUxfQ0xBU1MpPy5lbCgpO1xuXG4gICAgICBjb25zdCBrZXlEb3duSGFuZGxlciA9IGNyZWF0ZUtleURvd25TaG9ydGN1dHNIYW5kbGVyKHBsYXllclJlZiwgY29udGFpbmVyUmVmKTtcbiAgICAgIGNvbnN0IHZpZGVvU2Nyb2xsSGFuZGxlciA9IGNyZWF0ZVZpZGVvU2Nyb2xsU2hvcnRjdXRzSGFuZGxlcihwbGF5ZXJSZWYsIGNvbnRhaW5lclJlZik7XG4gICAgICBjb25zdCB2b2x1bWVQYW5lbEhhbmRsZXIgPSBjcmVhdGVWb2x1bWVQYW5lbFNjcm9sbFNob3J0Y3V0c0hhbmRsZXIodm9sdW1lUGFuZWxSZWYsIHBsYXllclJlZiwgY29udGFpbmVyUmVmKTtcbiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywga2V5RG93bkhhbmRsZXIpO1xuICAgICAgY29uc3QgY29udGFpbmVyRGl2ID0gY29udGFpbmVyUmVmLmN1cnJlbnQ7XG4gICAgICBjb250YWluZXJEaXYgJiYgY29udGFpbmVyRGl2LmFkZEV2ZW50TGlzdGVuZXIoJ3doZWVsJywgdmlkZW9TY3JvbGxIYW5kbGVyKTtcbiAgICAgIGlmICh2b2x1bWVQYW5lbFJlZi5jdXJyZW50KSB2b2x1bWVQYW5lbFJlZi5jdXJyZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3doZWVsJywgdm9sdW1lUGFuZWxIYW5kbGVyKTtcblxuICAgICAga2V5RG93bkhhbmRsZXJSZWYuY3VycmVudCA9IGtleURvd25IYW5kbGVyO1xuICAgICAgdmlkZW9TY3JvbGxIYW5kbGVyUmVmLmN1cnJlbnQgPSB2aWRlb1Njcm9sbEhhbmRsZXI7XG4gICAgICB2b2x1bWVQYW5lbFNjcm9sbEhhbmRsZXJSZWYuY3VycmVudCA9IHZvbHVtZVBhbmVsSGFuZGxlcjtcblxuICAgICAgLy8gJEZsb3dJc3N1ZVxuICAgICAgdmpzUGxheWVyLmNvbnRyb2xCYXI/LnNob3coKTtcblxuICAgICAgLy8gdmpzUGxheWVyLnBvc3Rlcihwb3N0ZXIpO1xuXG4gICAgICB2anNQbGF5ZXIuZWwoKS5jaGlsZE5vZGVzWzBdLnNldEF0dHJpYnV0ZSgncGxheXNpbmxpbmUnLCAnJyk7XG5cbiAgICAgIC8vIGxldCBjb250ZW50VXJsO1xuICAgICAgLy8gVE9ETzogcHVsbCB0aGlzIGZ1bmN0aW9uIGludG8gdmlkZW9qcy1mdW5jdGlvbnNcbiAgICAgIC8vIGRldGVybWluZSB3aGljaCBzb3VyY2UgdG8gdXNlIGFuZCBsb2FkIGl0XG4gICAgICBpZiAoaXNMaXZlc3RyZWFtKSB7XG4gICAgICAgIHZqc1BsYXllci5pc0xpdmVzdHJlYW0gPSB0cnVlO1xuICAgICAgICB2anNQbGF5ZXIuYWRkQ2xhc3MoJ2xpdmVzdHJlYW1QbGF5ZXInKTtcbiAgICAgICAgdmpzUGxheWVyLnNyYyh7IHR5cGU6ICdhcHBsaWNhdGlvbi94LW1wZWdVUkwnLCBzcmM6IGxpdmVzdHJlYW1WaWRlb1VybCB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZqc1BsYXllci5pc0xpdmVzdHJlYW0gPSBmYWxzZTtcbiAgICAgICAgdmpzUGxheWVyLnJlbW92ZUNsYXNzKCdsaXZlc3RyZWFtUGxheWVyJyk7XG5cbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChzb3VyY2UsIHsgbWV0aG9kOiAnSEVBRCcsIGNhY2hlOiAnbm8tc3RvcmUnIH0pO1xuICAgICAgICBwbGF5ZXJTZXJ2ZXJSZWYuY3VycmVudCA9IHJlc3BvbnNlLmhlYWRlcnMuZ2V0KCd4LXBvd2VyZWQtYnknKTtcbiAgICAgICAgdmpzUGxheWVyLmNsYWltU3JjT3JpZ2luYWwgPSB7IHR5cGU6IHNvdXJjZVR5cGUsIHNyYzogc291cmNlIH07XG5cbiAgICAgICAgLy8gcmVtb3ZlIHF1ZXJ5IHBhcmFtcyBmb3Igc2VjdXJlZCBlbmRwb2ludHMgKHdoaWNoIGhhdmUgcXVlcnkgcGFyYW1zIG9uIGVuZCBvZiBtM3U4IHBhdGgpXG4gICAgICAgIGxldCB0cmltbWVkVXJsID0gbmV3IFVSTChyZXNwb25zZS51cmwpO1xuICAgICAgICB0cmltbWVkVXJsLmhhc2ggPSAnJztcbiAgICAgICAgdHJpbW1lZFVybC5zZWFyY2ggPSAnJztcbiAgICAgICAgdHJpbW1lZFVybCA9IHRyaW1tZWRVcmwudG9TdHJpbmcoKTtcblxuICAgICAgICAvLyBjaGFuZ2UgdG8gbTN1OCBpZiBhcHBsaWNhYmxlXG4gICAgICAgIGlmIChyZXNwb25zZSAmJiByZXNwb25zZS5yZWRpcmVjdGVkICYmIHJlc3BvbnNlLnVybCAmJiB0cmltbWVkVXJsLmVuZHNXaXRoKCdtM3U4JykpIHtcbiAgICAgICAgICB2anNQbGF5ZXIuY2xhaW1TcmNWaHMgPSB7IHR5cGU6ICdhcHBsaWNhdGlvbi94LW1wZWdVUkwnLCBzcmM6IHJlc3BvbnNlLnVybCB9O1xuICAgICAgICAgIHZqc1BsYXllci5zcmModmpzUGxheWVyLmNsYWltU3JjVmhzKTtcbiAgICAgICAgICBpZiAod2luZG93LmNvcmRvdmEpIHtcbiAgICAgICAgICAgIGxldCBwYXlsb2FkID0ge1xuICAgICAgICAgICAgICB1cmk6IHJlc3BvbnNlLnVybCxcbiAgICAgICAgICAgICAgY2xhaW06IGNsYWltVmFsdWVzLFxuICAgICAgICAgICAgICBmaWxlVHlwZTogJ2FwcGxpY2F0aW9uL3gtbXBlZ1VSTCcsXG4gICAgICAgICAgICAgIGNoYW5uZWw6IGNoYW5uZWxUaXRsZSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB3aW5kb3cub2R5c2VlLmNocm9tZWNhc3Quc2V0TWVkaWFQYXlsb2FkKHBheWxvYWQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBsZXQgZml4ID0gc291cmNlICsgJyMubXA0J1xuICAgICAgICAgIHZqc1BsYXllci5zcmMoZml4KTtcbiAgICAgICAgICBpZiAod2luZG93LmNvcmRvdmEpIHtcbiAgICAgICAgICAgIGxldCBwYXlsb2FkID0ge1xuICAgICAgICAgICAgICB1cmk6IHZqc1BsYXllci5jbGFpbVNyY09yaWdpbmFsLFxuICAgICAgICAgICAgICBjbGFpbTogY2xhaW1WYWx1ZXMsXG4gICAgICAgICAgICAgIGZpbGVUeXBlOiBzb3VyY2VUeXBlLFxuICAgICAgICAgICAgICBjaGFubmVsOiBjaGFubmVsVGl0bGUsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgd2luZG93Lm9keXNlZS5jaHJvbWVjYXN0LnNldE1lZGlhUGF5bG9hZChwYXlsb2FkKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gYnVnZml4IHRodW1ibmFpbHMgc2hvd2luZyB1cCBpZiBuZXcgdmlkZW8gZG9lc24ndCBoYXZlIHRoZW1cbiAgICAgIGlmICh0eXBlb2YgdmpzUGxheWVyLnZ0dFRodW1ibmFpbHMuZGV0YWNoID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHZqc1BsYXllci52dHRUaHVtYm5haWxzLmRldGFjaCgpO1xuICAgICAgfVxuXG4gICAgICB2anNQbGF5ZXIubG9hZCgpO1xuXG4gICAgICBpZiAoY2FuVXNlT2xkUGxheWVyKSB7XG4gICAgICAgIC8vICRGbG93SXNzdWVcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnZpZGVvLWpzLXBhcmVudCcpPy5hcHBlbmQod2luZG93Lm9sZFNhdmVkRGl2KTtcbiAgICAgIH1cblxuICAgICAgLy8gZGlzYWJsZSByaWdodC1jbGljayAoY29udGV4dC1tZW51KSBmb3IgcHVyY2hhc2VkIGNvbnRlbnRcbiAgICAgIGlmIChpc1B1cmNoYXNhYmxlQ29udGVudCB8fCBpc1JlbnRhYmxlQ29udGVudCkge1xuICAgICAgICBjb25zdCBwbGF5ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCd2aWRlby52anMtdGVjaCcpO1xuICAgICAgICBpZiAocGxheWVyKSBwbGF5ZXIuc2V0QXR0cmlidXRlKCdvbmNvbnRleHRtZW51JywgJ3JldHVybiBmYWxzZTsnKTtcbiAgICAgIH1cblxuICAgICAgLy8gYWxsb3cgdGFwIHRvIHVubXV0ZSBpZiBubyBwZXJtcyBvbiBpT1NcbiAgICAgIGlmIChhdXRvcGxheSAmJiAhZW1iZWRkZWQpIHtcbiAgICAgICAgY29uc3QgcHJvbWlzZSA9IHZqc1BsYXllci5wbGF5KCk7XG5cbiAgICAgICAgd2luZG93LnBsYXllci51c2VyQWN0aXZlKHRydWUpO1xuXG4gICAgICAgIGlmIChwcm9taXNlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBwcm9taXNlXG4gICAgICAgICAgICAudGhlbigoXykgPT4ge1xuICAgICAgICAgICAgICAvLyAkRmxvd0lzc3VlXG4gICAgICAgICAgICAgIHZqc1BsYXllcj8uY29udHJvbEJhci5lbCgpLmNsYXNzTGlzdC5hZGQoJ3Zqcy10cmFuc2l0aW9uaW5nLXZpZGVvJyk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICBjb25zdCBub1Blcm1pc3Npb25FcnJvciA9IHR5cGVvZiBlcnJvciA9PT0gJ29iamVjdCcgJiYgZXJyb3IubmFtZSAmJiBlcnJvci5uYW1lID09PSAnTm90QWxsb3dlZEVycm9yJztcblxuICAgICAgICAgICAgICBpZiAobm9QZXJtaXNzaW9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBpZiAoSVNfSU9TKSB7XG4gICAgICAgICAgICAgICAgICAvLyBhdXRvcGxheSBub3QgYWxsb3dlZCwgbXV0ZSB2aWRlbywgcGxheSBhbmQgc2hvdyAndGFwIHRvIHVubXV0ZScgYnV0dG9uXG4gICAgICAgICAgICAgICAgICAvLyAkRmxvd0lzc3VlXG4gICAgICAgICAgICAgICAgICB2anNQbGF5ZXI/Lm11dGVkKHRydWUpO1xuICAgICAgICAgICAgICAgICAgLy8gJEZsb3dJc3N1ZVxuICAgICAgICAgICAgICAgICAgY29uc3QgbXV0ZWRQbGF5UHJvbWlzZSA9IHZqc1BsYXllcj8ucGxheSgpO1xuICAgICAgICAgICAgICAgICAgaWYgKG11dGVkUGxheVByb21pc2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBtdXRlZFBsYXlQcm9taXNlXG4gICAgICAgICAgICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGFwVG9Vbm11dGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudmlkZW8tanMtLXRhcC10by11bm11dGUnKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gJEZsb3dJc3N1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgdGFwVG9Vbm11dGVCdXR0b24/LnN0eWxlLnNldFByb3BlcnR5KCd2aXNpYmlsaXR5JywgJ3Zpc2libGUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICRGbG93SXNzdWVcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcFRvVW5tdXRlQnV0dG9uPy5zdHlsZS5zZXRQcm9wZXJ0eSgnZGlzcGxheScsICdpbmxpbmUnLCAnaW1wb3J0YW50Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAkRmxvd0ZpeE1lXG4gICAgICAgICAgICAgICAgICAgICAgICB2anNQbGF5ZXI/LmFkZENsYXNzKCd2anMtcGF1c2VkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAkRmxvd0ZpeE1lXG4gICAgICAgICAgICAgICAgICAgICAgICB2anNQbGF5ZXI/LmFkZENsYXNzKCd2anMtaGFzLXN0YXJ0ZWQnKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gJEZsb3dGaXhNZVxuICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnZqcy10b3VjaC1vdmVybGF5Jyk/LmNsYXNzTGlzdC5hZGQoJ3Nob3ctcGxheS10b2dnbGUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICRGbG93Rml4TWVcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy52anMtcGxheS1jb250cm9sJyk/LmNsYXNzTGlzdC5hZGQoJ3Zqcy1wYXVzZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgLy8gJEZsb3dJc3N1ZVxuICAgICAgICAgICAgICAgICAgdmpzUGxheWVyPy5iaWdQbGF5QnV0dG9uPy5zaG93KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pKCk7XG5cbiAgICAvLyBDbGVhbnVwXG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywga2V5RG93bkhhbmRsZXJSZWYuY3VycmVudCk7XG5cbiAgICAgIGNvbnN0IGNvbnRhaW5lckRpdiA9IGNvbnRhaW5lclJlZi5jdXJyZW50O1xuICAgICAgLy8gJEZsb3dGaXhNZVxuICAgICAgY29udGFpbmVyRGl2ICYmIGNvbnRhaW5lckRpdi5yZW1vdmVFdmVudExpc3RlbmVyKCd3aGVlbCcsIHZpZGVvU2Nyb2xsSGFuZGxlclJlZi5jdXJyZW50KTtcblxuICAgICAgaWYgKHZvbHVtZVBhbmVsUmVmLmN1cnJlbnQpIHtcbiAgICAgICAgdm9sdW1lUGFuZWxSZWYuY3VycmVudC5yZW1vdmVFdmVudExpc3RlbmVyKCd3aGVlbCcsIHZvbHVtZVBhbmVsU2Nyb2xsSGFuZGxlclJlZi5jdXJyZW50KTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgY2hhcHRlck1hcmtlcnMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCd2anMtY2hhcHRlci1tYXJrZXInKTtcbiAgICAgIHdoaWxlIChjaGFwdGVyTWFya2Vycy5sZW5ndGggPiAwKSB7XG4gICAgICAgIC8vICRGbG93SXNzdWVcbiAgICAgICAgY2hhcHRlck1hcmtlcnNbMF0ucGFyZW50Tm9kZT8ucmVtb3ZlQ2hpbGQoY2hhcHRlck1hcmtlcnNbMF0pO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBwbGF5ZXIgPSBwbGF5ZXJSZWYuY3VycmVudDtcblxuICAgICAgaWYgKHBsYXllcikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIHdpbmRvdy5jYXN0LmZyYW1ld29yay5DYXN0Q29udGV4dC5nZXRJbnN0YW5jZSgpLmdldEN1cnJlbnRTZXNzaW9uKCkuZW5kU2Vzc2lvbihmYWxzZSk7XG4gICAgICAgIH0gY2F0Y2gge31cblxuICAgICAgICB3aW5kb3cucGxheWVyLnN3aXRjaGVkRnJvbURlZmF1bHRRdWFsaXR5ID0gZmFsc2U7XG5cbiAgICAgICAgd2luZG93LnBsYXllci51c2VyQWN0aXZlKGZhbHNlKTtcbiAgICAgICAgd2luZG93LnBsYXllci5wYXVzZSgpO1xuXG4gICAgICAgIGlmIChJU19JT1MpIHtcbiAgICAgICAgICAvLyAkRmxvd0lzc3VlXG4gICAgICAgICAgd2luZG93LnBsYXllci5jb250cm9sQmFyPy5wbGF5VG9nZ2xlPy5oaWRlKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyB0aGlzIHNvbHZlcyBhbiBpc3N1ZSB3aXRoIHBvcnRyYWl0IHZpZGVvc1xuICAgICAgICAvLyAkRmxvd0lzc3VlXG4gICAgICAgIGNvbnN0IHZpZGVvRGl2ID0gd2luZG93LnBsYXllcj8udGVjaF8/LmVsKCk7IC8vIHZpZGVvIGVsZW1lbnRcbiAgICAgICAgaWYgKHZpZGVvRGl2KSB2aWRlb0Rpdi5zdHlsZS50b3AgPSAnMHB4JztcblxuICAgICAgICB3aW5kb3cucGxheWVyLmNvbnRyb2xCYXIuZWwoKS5jbGFzc0xpc3QuYWRkKCd2anMtdHJhbnNpdGlvbmluZy12aWRlbycpO1xuXG4gICAgICAgIHdpbmRvdy5vbGRTYXZlZERpdiA9IHdpbmRvdy5wbGF5ZXIuZWwoKTtcblxuICAgICAgICB3aW5kb3cucGxheWVyLnRyaWdnZXIoJ3BsYXllckNsb3NlZCcpO1xuXG4gICAgICAgIC8vIHN0b3Agc3RyZWFtcyBydW5uaW5nIGluIGJhY2tncm91bmRcbiAgICAgICAgd2luZG93LnBsYXllci5sb2FkVGVjaF8oJ2h0bWw1JywgbnVsbCk7XG5cbiAgICAgICAgd2luZG93LnBsYXllci5jdXJyZW50VGltZSgwKTtcblxuICAgICAgICAvLyBtYWtlcyB0aGUgY3VycmVudCB0aW1lIHVwZGF0ZSBpbW1lZGlhdGVseVxuICAgICAgICB3aW5kb3cucGxheWVyLnRyaWdnZXIoJ3RpbWV1cGRhdGUnKTtcblxuICAgICAgICB3aW5kb3cucGxheWVyLmNsYWltU3JjVmhzID0gbnVsbDtcbiAgICAgIH1cbiAgICB9O1xuICB9LCBbaXNBdWRpbywgc291cmNlLCByZWxvYWQsIHVzZXJDbGFpbUlkLCBpc0xpdmVzdHJlYW1DbGFpbV0pO1xuXG4gIHJldHVybiAoXG4gICAgPGRpdiBjbGFzc05hbWU9e2NsYXNzbmFtZXMoJ3ZpZGVvLWpzLXBhcmVudCcsIHsgJ3ZpZGVvLWpzLXBhcmVudC0taW9zJzogSVNfSU9TIH0pfSByZWY9e2NvbnRhaW5lclJlZn0+XG4gICAgICA8QnV0dG9uXG4gICAgICAgIGxhYmVsPXtfXygnVGFwIHRvIHVubXV0ZScpfVxuICAgICAgICBidXR0b249XCJsaW5rXCJcbiAgICAgICAgaWNvbj17SUNPTlMuVk9MVU1FX01VVEVEfVxuICAgICAgICBjbGFzc05hbWU9XCJ2aWRlby1qcy0tdGFwLXRvLXVubXV0ZVwiXG4gICAgICAgIG9uQ2xpY2s9e3VubXV0ZUFuZEhpZGVIaW50fVxuICAgICAgICByZWY9e3RhcFRvVW5tdXRlUmVmfVxuICAgICAgLz5cbiAgICAgIDxCdXR0b25cbiAgICAgICAgbGFiZWw9e19fKCdSZXRyeScpfVxuICAgICAgICBidXR0b249XCJsaW5rXCJcbiAgICAgICAgaWNvbj17SUNPTlMuUkVGUkVTSH1cbiAgICAgICAgY2xhc3NOYW1lPVwidmlkZW8tanMtLXRhcC10by11bm11dGVcIlxuICAgICAgICBvbkNsaWNrPXtyZXRyeVZpZGVvQWZ0ZXJGYWlsdXJlfVxuICAgICAgICByZWY9e3RhcFRvUmV0cnlSZWZ9XG4gICAgICAvPlxuICAgIDwvZGl2PlxuICApO1xufSk7XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWdGQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFRQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBSEE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFxQ0E7QUFDQTtBQXRDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBMENBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUF2REE7QUFBQTtBQUNBO0FBd0RBO0FBQ0E7QUFDQTtBQTNEQTtBQWtFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFqRUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUEyRUE7QUFBQTtBQTNFQTtBQUNBO0FBREE7QUE4RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBZkE7QUE3RUE7QUFBQTtBQUFBO0FBQ0E7QUE4RkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFEQTtBQVFBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFPQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBOUJBO0FBa0NBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBT0E7QUFFQTtBQUNBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFEQTtBQUpBO0FBU0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUlBO0FBOUJBO0FBQ0E7QUFDQTtBQWdDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFuQ0E7QUFDQTtBQUNBO0FBNENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQS9DQTtBQUNBO0FBQ0E7QUFxREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU9BO0FBaEVBO0FBQ0E7QUFDQTtBQWlFQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQS9FQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFIQTtBQXFGQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUExTkE7QUE4TkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQU5BO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFRQTtBQUNBO0FBQ0E7QUFYQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBZUE7QUFDQTtBQWhCQTtBQUFBO0FBQ0E7QUFEQTtBQWtCQTtBQUNBO0FBbkJBO0FBcUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUkE7QUFVQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBdkNBO0FBQ0E7QUFDQTtBQXlDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBNURBO0FBQ0E7QUFDQTtBQThEQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBRUE7QUFHQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUdBO0FBR0E7QUFDQTtBQUNBO0FBcEdBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFvR0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBdkdBO0FBQUE7QUFDQTtBQURBO0FBeUdBO0FBQ0E7QUExR0E7QUFBQTtBQTRHQTtBQUFBO0FBQUE7QUFDQTtBQTdHQTtBQTRHQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUE7QUFDQTtBQVhBO0FBYUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQWhKQTtBQWtKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTNKQTtBQUNBO0FBQ0E7QUE2SkE7QUFDQTtBQUNBO0FBaktBO0FBQ0E7QUFDQTtBQW1LQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUhBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFQQTtBQVNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBbEJBO0FBb0JBO0FBM0JBO0FBNEJBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQXpDQTtBQTJDQTtBQUNBO0FBQ0E7QUF4TkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBREE7QUFDQTtBQUNBO0FBME5BO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBR0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBWkE7QUFnQkE7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUFBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUF0REE7QUE1TkE7QUFzUkE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQTVnQkE7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///../ui/component/viewers/videoViewer/internal/videojs.jsx\n");

/***/ })

})