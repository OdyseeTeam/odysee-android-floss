webpackHotUpdate("ui-202209290705",{

/***/ "../ui/page/channel/internal/membershipChannelTab/view.jsx":
/*!*****************************************************************!*\
  !*** ../ui/page/channel/internal/membershipChannelTab/view.jsx ***!
  \*****************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* WEBPACK VAR INJECTION */(function(__) {/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"../node_modules/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var util_time__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! util/time */ \"../ui/util/time.js\");\n/* harmony import */ var constants_icons__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! constants/icons */ \"../ui/constants/icons.js\");\n/* harmony import */ var component_common_card__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! component/common/card */ \"../ui/component/common/card.jsx\");\n/* harmony import */ var component_joinMembershipCard__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! component/joinMembershipCard */ \"../ui/component/joinMembershipCard/index.js\");\n/* harmony import */ var component_clearMembershipData__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! component/clearMembershipData */ \"../ui/component/clearMembershipData/index.js\");\n/* harmony import */ var _reach_menu_button__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @reach/menu-button */ \"../node_modules/@reach/menu-button/dist/menu-button.esm.js\");\n/* harmony import */ var component_common_icon__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! component/common/icon */ \"../ui/component/common/icon.jsx\");\n\n\n\n\n // import moment from 'moment';\n\n\n\n\n\nvar MembershipChannelTab = function MembershipChannelTab(props) {\n  var uri = props.uri,\n      membershipIndex = props.membershipIndex,\n      purchasedChannelMembership = props.purchasedChannelMembership,\n      doOpenCancelationModalForMembership = props.doOpenCancelationModalForMembership;\n\n  if (!purchasedChannelMembership) {\n    return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(component_joinMembershipCard__WEBPACK_IMPORTED_MODULE_4__[\"default\"], {\n      uri: uri\n    });\n  } else {\n    delete window.pendingMembership;\n  }\n\n  var MembershipDetails = purchasedChannelMembership.MembershipDetails,\n      Subscription = purchasedChannelMembership.Subscription,\n      Perks = purchasedChannelMembership.Perks; // const { channel_name: creatorChannel } = purchasedChannelMembership.Membership;\n\n  var membershipName = MembershipDetails.name,\n      membershipDescription = MembershipDetails.description;\n  var subscriptionEndDate = Subscription.current_period_end,\n      dateCanceled = Subscription.canceled_at;\n  var membershipIsActive = dateCanceled === 0; // const startDate = subscriptionStartDate * 1000;\n  // const endDate = subscriptionEndDate * 1000;\n  // const amountOfMonths = moment(endDate).diff(moment(startDate), 'months', true);\n  // const timeAgo = amountOfMonths === 1 ? '1 month' : amountOfMonths + ' months';\n\n  var formattedEndOfMembershipDate = Object(util_time__WEBPACK_IMPORTED_MODULE_1__[\"formatDateToMonthAndDay\"])(subscriptionEndDate * 1000);\n  return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(component_common_card__WEBPACK_IMPORTED_MODULE_3__[\"default\"] // title={__('Your %creator_channel_name% membership', { creator_channel_name: creatorChannel })}\n  , {\n    className: \"membership membership-tab\"\n    /*\n    subtitle={\n      <>\n        <span className=\"join-membership-support-time__header\">\n          {__(\n            membershipIsActive\n              ? \"You're supporting %channel_name% for %membership_duration%.\"\n              : 'You supported %channel_name% for %membership_duration%.',\n            { channel_name: creatorChannel, membership_duration: timeAgo }\n          )}\n        </span>\n      </>\n    }\n    */\n    ,\n    body: react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment, null, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n      className: 'membership__body membership-tier' + membershipIndex\n    }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n      className: \"membership__plan-header\"\n    }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"span\", null, membershipName), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_reach_menu_button__WEBPACK_IMPORTED_MODULE_6__[\"Menu\"], null, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_reach_menu_button__WEBPACK_IMPORTED_MODULE_6__[\"MenuButton\"], {\n      className: \"menu__button\"\n    }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(component_common_icon__WEBPACK_IMPORTED_MODULE_7__[\"default\"], {\n      size: 18,\n      icon: constants_icons__WEBPACK_IMPORTED_MODULE_2__[\"SETTINGS\"]\n    })), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_reach_menu_button__WEBPACK_IMPORTED_MODULE_6__[\"MenuList\"], {\n      className: 'menu__list membership-tier' + membershipIndex\n    }, membershipIsActive && react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_reach_menu_button__WEBPACK_IMPORTED_MODULE_6__[\"MenuItem\"], {\n      className: \"comment__menu-option\",\n      onSelect: function onSelect() {\n        return doOpenCancelationModalForMembership(purchasedChannelMembership);\n      }\n    }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n      className: \"menu__link\"\n    }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(component_common_icon__WEBPACK_IMPORTED_MODULE_7__[\"default\"], {\n      size: 16,\n      icon: constants_icons__WEBPACK_IMPORTED_MODULE_2__[\"DELETE\"]\n    }), \" \", __('Cancel Membership')))))), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n      className: \"membership__plan-description\"\n    }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"label\", null, __('Description')), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"span\", null, membershipDescription)), Perks && react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n      className: \"membership-tier__perks\"\n    }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"label\", null, __('Odysee Perks')), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"ul\", null, Perks.map(function (tierPerk, i) {\n      return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"li\", {\n        key: i,\n        className: \"membership__perk-item\"\n      }, __(tierPerk.name));\n    }))), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n      className: \"membership__plan-actions\"\n    }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"label\", null, membershipIsActive ? __('This membership will renew on %renewal_date%', {\n      renewal_date: formattedEndOfMembershipDate\n    }) : __('Your cancelled membership will end on %end_date%', {\n      end_date: formattedEndOfMembershipDate\n    })))), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(component_clearMembershipData__WEBPACK_IMPORTED_MODULE_5__[\"default\"], null))\n  });\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (MembershipChannelTab);\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! i18n.js */ \"../ui/i18n.js\")[\"__\"]))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi4vdWkvcGFnZS9jaGFubmVsL2ludGVybmFsL21lbWJlcnNoaXBDaGFubmVsVGFiL3ZpZXcuanN4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL3VpL3BhZ2UvY2hhbm5lbC9pbnRlcm5hbC9tZW1iZXJzaGlwQ2hhbm5lbFRhYi92aWV3LmpzeD82NGNkIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIEBmbG93XG5pbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgZm9ybWF0RGF0ZVRvTW9udGhBbmREYXkgfSBmcm9tICd1dGlsL3RpbWUnO1xuaW1wb3J0ICogYXMgSUNPTlMgZnJvbSAnY29uc3RhbnRzL2ljb25zJztcbmltcG9ydCBDYXJkIGZyb20gJ2NvbXBvbmVudC9jb21tb24vY2FyZCc7XG5pbXBvcnQgSm9pbk1lbWJlcnNoaXBDYXJkIGZyb20gJ2NvbXBvbmVudC9qb2luTWVtYmVyc2hpcENhcmQnO1xuLy8gaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xuaW1wb3J0IENsZWFyTWVtYmVyc2hpcERhdGFCdXR0b24gZnJvbSAnY29tcG9uZW50L2NsZWFyTWVtYmVyc2hpcERhdGEnO1xuaW1wb3J0IHsgTWVudSwgTWVudUJ1dHRvbiwgTWVudUxpc3QsIE1lbnVJdGVtIH0gZnJvbSAnQHJlYWNoL21lbnUtYnV0dG9uJztcbmltcG9ydCBJY29uIGZyb20gJ2NvbXBvbmVudC9jb21tb24vaWNvbic7XG5cbnR5cGUgUHJvcHMgPSB7XG4gIHVyaTogc3RyaW5nLFxuICBtZW1iZXJzaGlwSW5kZXg6IG51bWJlcixcbiAgLy8gLS0gcmVkdXggLS1cbiAgcHVyY2hhc2VkQ2hhbm5lbE1lbWJlcnNoaXA6IE1lbWJlcnNoaXBUaWVyLFxuICBkb09wZW5DYW5jZWxhdGlvbk1vZGFsRm9yTWVtYmVyc2hpcDogKG1lbWJlcnNoaXA6IE1lbWJlcnNoaXBUaWVyKSA9PiB2b2lkLFxuICBuYXZpZ2F0ZTogKHN0cmluZykgPT4gdm9pZCxcbn07XG5cbmNvbnN0IE1lbWJlcnNoaXBDaGFubmVsVGFiID0gKHByb3BzOiBQcm9wcykgPT4ge1xuICBjb25zdCB7XG4gICAgdXJpLFxuICAgIG1lbWJlcnNoaXBJbmRleCxcbiAgICAvLyAtLSByZWR1eCAtLVxuICAgIHB1cmNoYXNlZENoYW5uZWxNZW1iZXJzaGlwLFxuICAgIGRvT3BlbkNhbmNlbGF0aW9uTW9kYWxGb3JNZW1iZXJzaGlwLFxuICB9ID0gcHJvcHM7XG5cbiAgaWYgKCFwdXJjaGFzZWRDaGFubmVsTWVtYmVyc2hpcCkge1xuICAgIHJldHVybiA8Sm9pbk1lbWJlcnNoaXBDYXJkIHVyaT17dXJpfSAvPjtcbiAgfSBlbHNlIHtcbiAgICBkZWxldGUgd2luZG93LnBlbmRpbmdNZW1iZXJzaGlwO1xuICB9XG5cbiAgY29uc3QgeyBNZW1iZXJzaGlwRGV0YWlscywgU3Vic2NyaXB0aW9uLCBQZXJrcyB9ID0gcHVyY2hhc2VkQ2hhbm5lbE1lbWJlcnNoaXA7XG4gIC8vIGNvbnN0IHsgY2hhbm5lbF9uYW1lOiBjcmVhdG9yQ2hhbm5lbCB9ID0gcHVyY2hhc2VkQ2hhbm5lbE1lbWJlcnNoaXAuTWVtYmVyc2hpcDtcbiAgY29uc3QgeyBuYW1lOiBtZW1iZXJzaGlwTmFtZSwgZGVzY3JpcHRpb246IG1lbWJlcnNoaXBEZXNjcmlwdGlvbiB9ID0gTWVtYmVyc2hpcERldGFpbHM7XG5cbiAgY29uc3Qge1xuICAgIC8vIGN1cnJlbnRfcGVyaW9kX3N0YXJ0OiBzdWJzY3JpcHRpb25TdGFydERhdGUsXG4gICAgY3VycmVudF9wZXJpb2RfZW5kOiBzdWJzY3JpcHRpb25FbmREYXRlLFxuICAgIGNhbmNlbGVkX2F0OiBkYXRlQ2FuY2VsZWQsXG4gIH0gPSBTdWJzY3JpcHRpb247XG5cbiAgY29uc3QgbWVtYmVyc2hpcElzQWN0aXZlID0gZGF0ZUNhbmNlbGVkID09PSAwO1xuICAvLyBjb25zdCBzdGFydERhdGUgPSBzdWJzY3JpcHRpb25TdGFydERhdGUgKiAxMDAwO1xuICAvLyBjb25zdCBlbmREYXRlID0gc3Vic2NyaXB0aW9uRW5kRGF0ZSAqIDEwMDA7XG5cbiAgLy8gY29uc3QgYW1vdW50T2ZNb250aHMgPSBtb21lbnQoZW5kRGF0ZSkuZGlmZihtb21lbnQoc3RhcnREYXRlKSwgJ21vbnRocycsIHRydWUpO1xuICAvLyBjb25zdCB0aW1lQWdvID0gYW1vdW50T2ZNb250aHMgPT09IDEgPyAnMSBtb250aCcgOiBhbW91bnRPZk1vbnRocyArICcgbW9udGhzJztcbiAgY29uc3QgZm9ybWF0dGVkRW5kT2ZNZW1iZXJzaGlwRGF0ZSA9IGZvcm1hdERhdGVUb01vbnRoQW5kRGF5KHN1YnNjcmlwdGlvbkVuZERhdGUgKiAxMDAwKTtcblxuICByZXR1cm4gKFxuICAgIDxDYXJkXG4gICAgICAvLyB0aXRsZT17X18oJ1lvdXIgJWNyZWF0b3JfY2hhbm5lbF9uYW1lJSBtZW1iZXJzaGlwJywgeyBjcmVhdG9yX2NoYW5uZWxfbmFtZTogY3JlYXRvckNoYW5uZWwgfSl9XG4gICAgICBjbGFzc05hbWU9XCJtZW1iZXJzaGlwIG1lbWJlcnNoaXAtdGFiXCJcbiAgICAgIC8qXG4gICAgICBzdWJ0aXRsZT17XG4gICAgICAgIDw+XG4gICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiam9pbi1tZW1iZXJzaGlwLXN1cHBvcnQtdGltZV9faGVhZGVyXCI+XG4gICAgICAgICAgICB7X18oXG4gICAgICAgICAgICAgIG1lbWJlcnNoaXBJc0FjdGl2ZVxuICAgICAgICAgICAgICAgID8gXCJZb3UncmUgc3VwcG9ydGluZyAlY2hhbm5lbF9uYW1lJSBmb3IgJW1lbWJlcnNoaXBfZHVyYXRpb24lLlwiXG4gICAgICAgICAgICAgICAgOiAnWW91IHN1cHBvcnRlZCAlY2hhbm5lbF9uYW1lJSBmb3IgJW1lbWJlcnNoaXBfZHVyYXRpb24lLicsXG4gICAgICAgICAgICAgIHsgY2hhbm5lbF9uYW1lOiBjcmVhdG9yQ2hhbm5lbCwgbWVtYmVyc2hpcF9kdXJhdGlvbjogdGltZUFnbyB9XG4gICAgICAgICAgICApfVxuICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgPC8+XG4gICAgICB9XG4gICAgICAqL1xuICAgICAgYm9keT17XG4gICAgICAgIDw+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9eydtZW1iZXJzaGlwX19ib2R5IG1lbWJlcnNoaXAtdGllcicgKyBtZW1iZXJzaGlwSW5kZXh9PlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtZW1iZXJzaGlwX19wbGFuLWhlYWRlclwiPlxuICAgICAgICAgICAgICA8c3Bhbj57bWVtYmVyc2hpcE5hbWV9PC9zcGFuPlxuICAgICAgICAgICAgICA8TWVudT5cbiAgICAgICAgICAgICAgICA8TWVudUJ1dHRvbiBjbGFzc05hbWU9XCJtZW51X19idXR0b25cIj5cbiAgICAgICAgICAgICAgICAgIDxJY29uIHNpemU9ezE4fSBpY29uPXtJQ09OUy5TRVRUSU5HU30gLz5cbiAgICAgICAgICAgICAgICA8L01lbnVCdXR0b24+XG4gICAgICAgICAgICAgICAgPE1lbnVMaXN0IGNsYXNzTmFtZT17J21lbnVfX2xpc3QgbWVtYmVyc2hpcC10aWVyJyArIG1lbWJlcnNoaXBJbmRleH0+XG4gICAgICAgICAgICAgICAgICB7bWVtYmVyc2hpcElzQWN0aXZlICYmIChcbiAgICAgICAgICAgICAgICAgICAgPE1lbnVJdGVtXG4gICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiY29tbWVudF9fbWVudS1vcHRpb25cIlxuICAgICAgICAgICAgICAgICAgICAgIG9uU2VsZWN0PXsoKSA9PiBkb09wZW5DYW5jZWxhdGlvbk1vZGFsRm9yTWVtYmVyc2hpcChwdXJjaGFzZWRDaGFubmVsTWVtYmVyc2hpcCl9XG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1lbnVfX2xpbmtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxJY29uIHNpemU9ezE2fSBpY29uPXtJQ09OUy5ERUxFVEV9IC8+IHtfXygnQ2FuY2VsIE1lbWJlcnNoaXAnKX1cbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9NZW51SXRlbT5cbiAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgPC9NZW51TGlzdD5cbiAgICAgICAgICAgICAgPC9NZW51PlxuICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibWVtYmVyc2hpcF9fcGxhbi1kZXNjcmlwdGlvblwiPlxuICAgICAgICAgICAgICA8bGFiZWw+e19fKCdEZXNjcmlwdGlvbicpfTwvbGFiZWw+XG4gICAgICAgICAgICAgIDxzcGFuPnttZW1iZXJzaGlwRGVzY3JpcHRpb259PC9zcGFuPlxuICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgIHtQZXJrcyAmJiAoXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibWVtYmVyc2hpcC10aWVyX19wZXJrc1wiPlxuICAgICAgICAgICAgICAgIDxsYWJlbD57X18oJ09keXNlZSBQZXJrcycpfTwvbGFiZWw+XG5cbiAgICAgICAgICAgICAgICA8dWw+XG4gICAgICAgICAgICAgICAgICB7UGVya3MubWFwKCh0aWVyUGVyaywgaSkgPT4gKFxuICAgICAgICAgICAgICAgICAgICA8bGkga2V5PXtpfSBjbGFzc05hbWU9XCJtZW1iZXJzaGlwX19wZXJrLWl0ZW1cIj5cbiAgICAgICAgICAgICAgICAgICAgICB7X18odGllclBlcmsubmFtZSl9XG4gICAgICAgICAgICAgICAgICAgIDwvbGk+XG4gICAgICAgICAgICAgICAgICApKX1cbiAgICAgICAgICAgICAgICA8L3VsPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICl9XG5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibWVtYmVyc2hpcF9fcGxhbi1hY3Rpb25zXCI+XG4gICAgICAgICAgICAgIDxsYWJlbD5cbiAgICAgICAgICAgICAgICB7bWVtYmVyc2hpcElzQWN0aXZlXG4gICAgICAgICAgICAgICAgICA/IF9fKCdUaGlzIG1lbWJlcnNoaXAgd2lsbCByZW5ldyBvbiAlcmVuZXdhbF9kYXRlJScsIHsgcmVuZXdhbF9kYXRlOiBmb3JtYXR0ZWRFbmRPZk1lbWJlcnNoaXBEYXRlIH0pXG4gICAgICAgICAgICAgICAgICA6IF9fKCdZb3VyIGNhbmNlbGxlZCBtZW1iZXJzaGlwIHdpbGwgZW5kIG9uICVlbmRfZGF0ZSUnLCB7IGVuZF9kYXRlOiBmb3JtYXR0ZWRFbmRPZk1lbWJlcnNoaXBEYXRlIH0pfVxuICAgICAgICAgICAgICA8L2xhYmVsPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPENsZWFyTWVtYmVyc2hpcERhdGFCdXR0b24gLz5cbiAgICAgICAgPC8+XG4gICAgICB9XG4gICAgLz5cbiAgKTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IE1lbWJlcnNoaXBDaGFubmVsVGFiO1xuIl0sIm1hcHBpbmdzIjoiQUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBUUE7QUFDQTtBQUFBO0FBQUE7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQWRBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUF5QkE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWhCQTtBQWlCQTtBQUVBO0FBQUE7QUFDQTtBQUFBO0FBR0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUZBO0FBSUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQVFBO0FBQUE7QUFNQTtBQUFBO0FBSUE7QUFDQTtBQUFBO0FBQUE7QUFqQ0E7QUF5Q0E7QUFBQTtBQUdBO0FBQUE7QUFDQTtBQUFBO0FBaEVBO0FBbENBO0FBQ0E7QUE0R0E7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///../ui/page/channel/internal/membershipChannelTab/view.jsx\n");

/***/ }),

/***/ "../ui/redux/actions/websocket.js":
/*!****************************************!*\
  !*** ../ui/redux/actions/websocket.js ***!
  \****************************************/
/*! exports provided: doSocketConnect, doSocketDisconnect, doNotificationSocketConnect, doCommentSocketConnect, doCommentSocketDisconnect, doCommentSocketConnectAsCommenter, doCommentSocketDisconnectAsCommenter, doSetSocketConnection */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"doSocketConnect\", function() { return doSocketConnect; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"doSocketDisconnect\", function() { return doSocketDisconnect; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"doNotificationSocketConnect\", function() { return doNotificationSocketConnect; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"doCommentSocketConnect\", function() { return doCommentSocketConnect; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"doCommentSocketDisconnect\", function() { return doCommentSocketDisconnect; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"doCommentSocketConnectAsCommenter\", function() { return doCommentSocketConnectAsCommenter; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"doCommentSocketDisconnectAsCommenter\", function() { return doCommentSocketDisconnectAsCommenter; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"doSetSocketConnection\", function() { return doSetSocketConnection; });\n/* harmony import */ var constants_action_types__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! constants/action_types */ \"../ui/constants/action_types.js\");\n/* harmony import */ var util_saved_passwords__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! util/saved-passwords */ \"../ui/util/saved-passwords.js\");\n/* harmony import */ var util_saved_passwords__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(util_saved_passwords__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var redux_actions_notifications__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! redux/actions/notifications */ \"../ui/redux/actions/notifications.js\");\n/* harmony import */ var redux_actions_livestream__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! redux/actions/livestream */ \"../ui/redux/actions/livestream.js\");\n/* harmony import */ var config__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! config */ \"../config.js\");\n/* harmony import */ var config__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(config__WEBPACK_IMPORTED_MODULE_4__);\n\n\n\n\n\nvar NOTIFICATION_WS_URL = \"\".concat(config__WEBPACK_IMPORTED_MODULE_4__[\"SOCKETY_SERVER_API\"], \"/internal?id=\");\nvar COMMENT_WS_URL = \"\".concat(config__WEBPACK_IMPORTED_MODULE_4__[\"SOCKETY_SERVER_API\"], \"/commentron?id=\");\nvar COMMENT_WS_SUBCATEGORIES = {\n  COMMENTER: 'commenter',\n  VIEWER: 'viewer'\n};\nvar sockets = {};\nvar closingSockets = {};\nvar retryCount = 0;\n\nvar getCommentSocketUrl = function getCommentSocketUrl(claimId, channelName) {\n  return \"\".concat(COMMENT_WS_URL).concat(claimId, \"&category=\").concat(channelName, \"&sub_category=viewer\");\n};\n\nvar getCommentSocketUrlForCommenter = function getCommentSocketUrlForCommenter(claimId, channelName) {\n  return \"\".concat(COMMENT_WS_URL).concat(claimId, \"&category=\").concat(channelName, \"&sub_category=commenter\");\n};\n\nvar doSocketConnect = function doSocketConnect(url, cb, type) {\n  function connectToSocket() {\n    if (sockets[url] !== undefined && sockets[url] !== null) {\n      sockets[url].close();\n      sockets[url] = null;\n    }\n\n    var timeToWait = Math.pow(retryCount, 2) * 1000;\n    setTimeout(function () {\n      sockets[url] = new WebSocket(url);\n\n      sockets[url].onopen = function (e) {\n        retryCount = 0;\n        console.log(\"\\nConnected to \".concat(type, \" WS \\n\\n\")); // eslint-disable-line\n      };\n\n      sockets[url].onmessage = function (e) {\n        var data = JSON.parse(e.data);\n        cb(data);\n      };\n\n      sockets[url].onerror = function (e) {\n        console.log(\"\".concat(type, \" websocket onerror\"), e); // eslint-disable-line\n        // onerror and onclose will both fire, so nothing is needed here\n      };\n\n      sockets[url].onclose = function () {\n        console.log(\"\\n Disconnected from \".concat(type, \" WS \\n\\n\")); // eslint-disable-line\n\n        if (!closingSockets[url]) {\n          retryCount += 1;\n          connectToSocket();\n        } else {\n          closingSockets[url] = null;\n        }\n      };\n    }, timeToWait);\n  }\n\n  connectToSocket();\n};\nvar doSocketDisconnect = function doSocketDisconnect(url) {\n  return function (dispatch) {\n    if (sockets[url] !== undefined && sockets[url] !== null) {\n      closingSockets[url] = true;\n      sockets[url].close();\n      sockets[url] = null;\n      dispatch({\n        type: constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"WS_DISCONNECT\"]\n      });\n    }\n  };\n};\nvar doNotificationSocketConnect = function doNotificationSocketConnect(enableNotifications) {\n  return function (dispatch) {\n    var authToken = Object(util_saved_passwords__WEBPACK_IMPORTED_MODULE_1__[\"getAuthToken\"])();\n\n    if (!authToken) {\n      console.error('Unable to connect to web socket because auth token is missing'); // eslint-disable-line\n\n      return;\n    }\n\n    var url = \"\".concat(NOTIFICATION_WS_URL).concat(authToken);\n    doSocketConnect(url, function (data) {\n      switch (data.type) {\n        case 'pending_notification':\n          if (enableNotifications) {\n            dispatch(Object(redux_actions_notifications__WEBPACK_IMPORTED_MODULE_2__[\"doNotificationList\"])());\n          }\n\n          break;\n\n        case 'swap-status':\n          dispatch({\n            type: constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COIN_SWAP_STATUS_RECEIVED\"],\n            data: data.data\n          });\n          break;\n      }\n    }, 'notification');\n  };\n};\nvar doCommentSocketConnect = function doCommentSocketConnect(uri, channelName, claimId, subCategory, protectedEndpoint) {\n  return function (dispatch) {\n    var url = subCategory === COMMENT_WS_SUBCATEGORIES.COMMENTER ? getCommentSocketUrlForCommenter(claimId, channelName) : getCommentSocketUrl(claimId, channelName);\n    doSocketConnect(url, function (response) {\n      if (response.type === 'delta') {\n        var newComment = response.data.comment; // for the protected livechat endpoints endpoint\n\n        var reversedClaimId = claimId.split('').reverse().join('');\n        var claimIdToUse = protectedEndpoint ? reversedClaimId : claimId;\n        dispatch({\n          type: constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_RECEIVED\"],\n          data: {\n            comment: newComment,\n            claimId: claimIdToUse,\n            uri: uri\n          }\n        });\n      }\n\n      if (response.type === 'viewers') {\n        var connected = response.data.connected;\n        dispatch({\n          type: constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"VIEWERS_RECEIVED\"],\n          data: {\n            connected: connected,\n            claimId: claimId\n          }\n        });\n      }\n\n      if (response.type === 'pinned') {\n        var pinnedComment = response.data.comment;\n        dispatch({\n          type: constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_PIN_COMPLETED\"],\n          data: {\n            pinnedComment: pinnedComment,\n            claimId: claimId,\n            unpin: !pinnedComment.is_pinned\n          }\n        });\n      }\n\n      if (response.type === 'removed') {\n        var comment_id = response.data.comment.comment_id;\n        dispatch({\n          type: constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_MARK_AS_REMOVED\"],\n          data: {\n            comment_id: comment_id\n          }\n        });\n      }\n\n      if (response.type === 'setting') {\n        // const membersOnlyChatEnabled = response.data.LivestreamChatMembersOnly;\n        // l('running here');\n        // l(membersOnlyChatEnabled);\n        dispatch({\n          type: constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_MEMBERS_ONLY_CHAT_TOGGLED\"],\n          data: {\n            test: 'hello'\n          }\n        });\n      }\n\n      if (response.type === 'livestream') {\n        var channel_id = response.data.channel_id; // update the live status for the stream\n\n        dispatch(Object(redux_actions_livestream__WEBPACK_IMPORTED_MODULE_3__[\"doFetchChannelLiveStatus\"])(channel_id));\n      }\n    }, \"\".concat(subCategory || COMMENT_WS_SUBCATEGORIES.VIEWER, \" comment\"));\n    dispatch(doSetSocketConnection(true, claimId, subCategory || COMMENT_WS_SUBCATEGORIES.VIEWER));\n  };\n};\nvar doCommentSocketDisconnect = function doCommentSocketDisconnect(claimId, channelName, subCategory) {\n  return function (dispatch) {\n    var url = subCategory === COMMENT_WS_SUBCATEGORIES.COMMENTER ? getCommentSocketUrlForCommenter(claimId, channelName) : getCommentSocketUrl(claimId, channelName);\n    dispatch(doSocketDisconnect(url));\n    dispatch(doSetSocketConnection(false, claimId, subCategory));\n  };\n};\nvar doCommentSocketConnectAsCommenter = function doCommentSocketConnectAsCommenter(uri, channelName, claimId) {\n  return function (dispatch) {\n    return dispatch(doCommentSocketConnect(uri, channelName, claimId, COMMENT_WS_SUBCATEGORIES.COMMENTER));\n  };\n};\nvar doCommentSocketDisconnectAsCommenter = function doCommentSocketDisconnectAsCommenter(claimId, channelName) {\n  return function (dispatch) {\n    return dispatch(doCommentSocketDisconnect(claimId, channelName, COMMENT_WS_SUBCATEGORIES.COMMENTER));\n  };\n};\nvar doSetSocketConnection = function doSetSocketConnection(connected, id, subCategory) {\n  return function (dispatch) {\n    return dispatch({\n      type: constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"SOCKET_CONNECTED_BY_ID\"],\n      data: {\n        connected: connected,\n        sub_category: subCategory,\n        id: id\n      }\n    });\n  };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi4vdWkvcmVkdXgvYWN0aW9ucy93ZWJzb2NrZXQuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi4vdWkvcmVkdXgvYWN0aW9ucy93ZWJzb2NrZXQuanM/ZThlYyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBBQ1RJT05TIGZyb20gJ2NvbnN0YW50cy9hY3Rpb25fdHlwZXMnO1xuaW1wb3J0IHsgZ2V0QXV0aFRva2VuIH0gZnJvbSAndXRpbC9zYXZlZC1wYXNzd29yZHMnO1xuaW1wb3J0IHsgZG9Ob3RpZmljYXRpb25MaXN0IH0gZnJvbSAncmVkdXgvYWN0aW9ucy9ub3RpZmljYXRpb25zJztcbmltcG9ydCB7IGRvRmV0Y2hDaGFubmVsTGl2ZVN0YXR1cyB9IGZyb20gJ3JlZHV4L2FjdGlvbnMvbGl2ZXN0cmVhbSc7XG5pbXBvcnQgeyBTT0NLRVRZX1NFUlZFUl9BUEkgfSBmcm9tICdjb25maWcnO1xuXG5jb25zdCBOT1RJRklDQVRJT05fV1NfVVJMID0gYCR7U09DS0VUWV9TRVJWRVJfQVBJfS9pbnRlcm5hbD9pZD1gO1xuY29uc3QgQ09NTUVOVF9XU19VUkwgPSBgJHtTT0NLRVRZX1NFUlZFUl9BUEl9L2NvbW1lbnRyb24/aWQ9YDtcbmNvbnN0IENPTU1FTlRfV1NfU1VCQ0FURUdPUklFUyA9IHtcbiAgQ09NTUVOVEVSOiAnY29tbWVudGVyJyxcbiAgVklFV0VSOiAndmlld2VyJyxcbn07XG5cbmxldCBzb2NrZXRzID0ge307XG5sZXQgY2xvc2luZ1NvY2tldHMgPSB7fTtcbmxldCByZXRyeUNvdW50ID0gMDtcblxuY29uc3QgZ2V0Q29tbWVudFNvY2tldFVybCA9IChjbGFpbUlkLCBjaGFubmVsTmFtZSkgPT4ge1xuICByZXR1cm4gYCR7Q09NTUVOVF9XU19VUkx9JHtjbGFpbUlkfSZjYXRlZ29yeT0ke2NoYW5uZWxOYW1lfSZzdWJfY2F0ZWdvcnk9dmlld2VyYDtcbn07XG5cbmNvbnN0IGdldENvbW1lbnRTb2NrZXRVcmxGb3JDb21tZW50ZXIgPSAoY2xhaW1JZCwgY2hhbm5lbE5hbWUpID0+IHtcbiAgcmV0dXJuIGAke0NPTU1FTlRfV1NfVVJMfSR7Y2xhaW1JZH0mY2F0ZWdvcnk9JHtjaGFubmVsTmFtZX0mc3ViX2NhdGVnb3J5PWNvbW1lbnRlcmA7XG59O1xuXG5leHBvcnQgY29uc3QgZG9Tb2NrZXRDb25uZWN0ID0gKHVybCwgY2IsIHR5cGUpID0+IHtcbiAgZnVuY3Rpb24gY29ubmVjdFRvU29ja2V0KCkge1xuICAgIGlmIChzb2NrZXRzW3VybF0gIT09IHVuZGVmaW5lZCAmJiBzb2NrZXRzW3VybF0gIT09IG51bGwpIHtcbiAgICAgIHNvY2tldHNbdXJsXS5jbG9zZSgpO1xuICAgICAgc29ja2V0c1t1cmxdID0gbnVsbDtcbiAgICB9XG5cbiAgICBjb25zdCB0aW1lVG9XYWl0ID0gcmV0cnlDb3VudCAqKiAyICogMTAwMDtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHNvY2tldHNbdXJsXSA9IG5ldyBXZWJTb2NrZXQodXJsKTtcbiAgICAgIHNvY2tldHNbdXJsXS5vbm9wZW4gPSAoZSkgPT4ge1xuICAgICAgICByZXRyeUNvdW50ID0gMDtcbiAgICAgICAgY29uc29sZS5sb2coYFxcbkNvbm5lY3RlZCB0byAke3R5cGV9IFdTIFxcblxcbmApOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG4gICAgICB9O1xuXG4gICAgICBzb2NrZXRzW3VybF0ub25tZXNzYWdlID0gKGUpID0+IHtcbiAgICAgICAgY29uc3QgZGF0YSA9IEpTT04ucGFyc2UoZS5kYXRhKTtcbiAgICAgICAgY2IoZGF0YSk7XG4gICAgICB9O1xuXG4gICAgICBzb2NrZXRzW3VybF0ub25lcnJvciA9IChlKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGAke3R5cGV9IHdlYnNvY2tldCBvbmVycm9yYCwgZSk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmVcbiAgICAgICAgLy8gb25lcnJvciBhbmQgb25jbG9zZSB3aWxsIGJvdGggZmlyZSwgc28gbm90aGluZyBpcyBuZWVkZWQgaGVyZVxuICAgICAgfTtcblxuICAgICAgc29ja2V0c1t1cmxdLm9uY2xvc2UgPSAoKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGBcXG4gRGlzY29ubmVjdGVkIGZyb20gJHt0eXBlfSBXUyBcXG5cXG5gKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZVxuICAgICAgICBpZiAoIWNsb3NpbmdTb2NrZXRzW3VybF0pIHtcbiAgICAgICAgICByZXRyeUNvdW50ICs9IDE7XG4gICAgICAgICAgY29ubmVjdFRvU29ja2V0KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY2xvc2luZ1NvY2tldHNbdXJsXSA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSwgdGltZVRvV2FpdCk7XG4gIH1cblxuICBjb25uZWN0VG9Tb2NrZXQoKTtcbn07XG5cbmV4cG9ydCBjb25zdCBkb1NvY2tldERpc2Nvbm5lY3QgPSAodXJsKSA9PiAoZGlzcGF0Y2gpID0+IHtcbiAgaWYgKHNvY2tldHNbdXJsXSAhPT0gdW5kZWZpbmVkICYmIHNvY2tldHNbdXJsXSAhPT0gbnVsbCkge1xuICAgIGNsb3NpbmdTb2NrZXRzW3VybF0gPSB0cnVlO1xuICAgIHNvY2tldHNbdXJsXS5jbG9zZSgpO1xuICAgIHNvY2tldHNbdXJsXSA9IG51bGw7XG5cbiAgICBkaXNwYXRjaCh7XG4gICAgICB0eXBlOiBBQ1RJT05TLldTX0RJU0NPTk5FQ1QsXG4gICAgfSk7XG4gIH1cbn07XG5cbmV4cG9ydCBjb25zdCBkb05vdGlmaWNhdGlvblNvY2tldENvbm5lY3QgPSAoZW5hYmxlTm90aWZpY2F0aW9ucykgPT4gKGRpc3BhdGNoKSA9PiB7XG4gIGNvbnN0IGF1dGhUb2tlbiA9IGdldEF1dGhUb2tlbigpO1xuICBpZiAoIWF1dGhUb2tlbikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1VuYWJsZSB0byBjb25uZWN0IHRvIHdlYiBzb2NrZXQgYmVjYXVzZSBhdXRoIHRva2VuIGlzIG1pc3NpbmcnKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZVxuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IHVybCA9IGAke05PVElGSUNBVElPTl9XU19VUkx9JHthdXRoVG9rZW59YDtcblxuICBkb1NvY2tldENvbm5lY3QoXG4gICAgdXJsLFxuICAgIChkYXRhKSA9PiB7XG4gICAgICBzd2l0Y2ggKGRhdGEudHlwZSkge1xuICAgICAgICBjYXNlICdwZW5kaW5nX25vdGlmaWNhdGlvbic6XG4gICAgICAgICAgaWYgKGVuYWJsZU5vdGlmaWNhdGlvbnMpIHtcbiAgICAgICAgICAgIGRpc3BhdGNoKGRvTm90aWZpY2F0aW9uTGlzdCgpKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ3N3YXAtc3RhdHVzJzpcbiAgICAgICAgICBkaXNwYXRjaCh7XG4gICAgICAgICAgICB0eXBlOiBBQ1RJT05TLkNPSU5fU1dBUF9TVEFUVVNfUkVDRUlWRUQsXG4gICAgICAgICAgICBkYXRhOiBkYXRhLmRhdGEsXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfSxcbiAgICAnbm90aWZpY2F0aW9uJ1xuICApO1xufTtcblxuZXhwb3J0IGNvbnN0IGRvQ29tbWVudFNvY2tldENvbm5lY3QgPSAodXJpLCBjaGFubmVsTmFtZSwgY2xhaW1JZCwgc3ViQ2F0ZWdvcnksIHByb3RlY3RlZEVuZHBvaW50KSA9PiAoZGlzcGF0Y2gpID0+IHtcbiAgY29uc3QgdXJsID1cbiAgICBzdWJDYXRlZ29yeSA9PT0gQ09NTUVOVF9XU19TVUJDQVRFR09SSUVTLkNPTU1FTlRFUlxuICAgICAgPyBnZXRDb21tZW50U29ja2V0VXJsRm9yQ29tbWVudGVyKGNsYWltSWQsIGNoYW5uZWxOYW1lKVxuICAgICAgOiBnZXRDb21tZW50U29ja2V0VXJsKGNsYWltSWQsIGNoYW5uZWxOYW1lKTtcblxuICBkb1NvY2tldENvbm5lY3QoXG4gICAgdXJsLFxuICAgIChyZXNwb25zZSkgPT4ge1xuICAgICAgaWYgKHJlc3BvbnNlLnR5cGUgPT09ICdkZWx0YScpIHtcbiAgICAgICAgY29uc3QgbmV3Q29tbWVudCA9IHJlc3BvbnNlLmRhdGEuY29tbWVudDtcblxuICAgICAgICAvLyBmb3IgdGhlIHByb3RlY3RlZCBsaXZlY2hhdCBlbmRwb2ludHMgZW5kcG9pbnRcbiAgICAgICAgY29uc3QgcmV2ZXJzZWRDbGFpbUlkID0gY2xhaW1JZC5zcGxpdCgnJykucmV2ZXJzZSgpLmpvaW4oJycpO1xuICAgICAgICBjb25zdCBjbGFpbUlkVG9Vc2UgPSBwcm90ZWN0ZWRFbmRwb2ludCA/IHJldmVyc2VkQ2xhaW1JZCA6IGNsYWltSWQ7XG5cbiAgICAgICAgZGlzcGF0Y2goe1xuICAgICAgICAgIHR5cGU6IEFDVElPTlMuQ09NTUVOVF9SRUNFSVZFRCxcbiAgICAgICAgICBkYXRhOiB7IGNvbW1lbnQ6IG5ld0NvbW1lbnQsIGNsYWltSWQ6IGNsYWltSWRUb1VzZSwgdXJpIH0sXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKHJlc3BvbnNlLnR5cGUgPT09ICd2aWV3ZXJzJykge1xuICAgICAgICBjb25zdCBjb25uZWN0ZWQgPSByZXNwb25zZS5kYXRhLmNvbm5lY3RlZDtcbiAgICAgICAgZGlzcGF0Y2goe1xuICAgICAgICAgIHR5cGU6IEFDVElPTlMuVklFV0VSU19SRUNFSVZFRCxcbiAgICAgICAgICBkYXRhOiB7IGNvbm5lY3RlZCwgY2xhaW1JZCB9LFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmIChyZXNwb25zZS50eXBlID09PSAncGlubmVkJykge1xuICAgICAgICBjb25zdCBwaW5uZWRDb21tZW50ID0gcmVzcG9uc2UuZGF0YS5jb21tZW50O1xuICAgICAgICBkaXNwYXRjaCh7XG4gICAgICAgICAgdHlwZTogQUNUSU9OUy5DT01NRU5UX1BJTl9DT01QTEVURUQsXG4gICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgcGlubmVkQ29tbWVudDogcGlubmVkQ29tbWVudCxcbiAgICAgICAgICAgIGNsYWltSWQsXG4gICAgICAgICAgICB1bnBpbjogIXBpbm5lZENvbW1lbnQuaXNfcGlubmVkLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKHJlc3BvbnNlLnR5cGUgPT09ICdyZW1vdmVkJykge1xuICAgICAgICBjb25zdCB7IGNvbW1lbnRfaWQgfSA9IHJlc3BvbnNlLmRhdGEuY29tbWVudDtcbiAgICAgICAgZGlzcGF0Y2goe1xuICAgICAgICAgIHR5cGU6IEFDVElPTlMuQ09NTUVOVF9NQVJLX0FTX1JFTU9WRUQsXG4gICAgICAgICAgZGF0YTogeyBjb21tZW50X2lkIH0sXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBpZiAocmVzcG9uc2UudHlwZSA9PT0gJ3NldHRpbmcnKSB7XG4gICAgICAgIC8vIGNvbnN0IG1lbWJlcnNPbmx5Q2hhdEVuYWJsZWQgPSByZXNwb25zZS5kYXRhLkxpdmVzdHJlYW1DaGF0TWVtYmVyc09ubHk7XG5cbiAgICAgICAgLy8gbCgncnVubmluZyBoZXJlJyk7XG4gICAgICAgIC8vIGwobWVtYmVyc09ubHlDaGF0RW5hYmxlZCk7XG4gICAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgICB0eXBlOiBBQ1RJT05TLkNPTU1FTlRfTUVNQkVSU19PTkxZX0NIQVRfVE9HR0xFRCxcbiAgICAgICAgICBkYXRhOiB7IHRlc3Q6ICdoZWxsbycgfSxcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChyZXNwb25zZS50eXBlID09PSAnbGl2ZXN0cmVhbScpIHtcbiAgICAgICAgY29uc3QgeyBjaGFubmVsX2lkIH0gPSByZXNwb25zZS5kYXRhO1xuXG4gICAgICAgIC8vIHVwZGF0ZSB0aGUgbGl2ZSBzdGF0dXMgZm9yIHRoZSBzdHJlYW1cbiAgICAgICAgZGlzcGF0Y2goZG9GZXRjaENoYW5uZWxMaXZlU3RhdHVzKGNoYW5uZWxfaWQpKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGAke3N1YkNhdGVnb3J5IHx8IENPTU1FTlRfV1NfU1VCQ0FURUdPUklFUy5WSUVXRVJ9IGNvbW1lbnRgXG4gICk7XG5cbiAgZGlzcGF0Y2goZG9TZXRTb2NrZXRDb25uZWN0aW9uKHRydWUsIGNsYWltSWQsIHN1YkNhdGVnb3J5IHx8IENPTU1FTlRfV1NfU1VCQ0FURUdPUklFUy5WSUVXRVIpKTtcbn07XG5cbmV4cG9ydCBjb25zdCBkb0NvbW1lbnRTb2NrZXREaXNjb25uZWN0ID0gKGNsYWltSWQsIGNoYW5uZWxOYW1lLCBzdWJDYXRlZ29yeSkgPT4gKGRpc3BhdGNoKSA9PiB7XG4gIGNvbnN0IHVybCA9XG4gICAgc3ViQ2F0ZWdvcnkgPT09IENPTU1FTlRfV1NfU1VCQ0FURUdPUklFUy5DT01NRU5URVJcbiAgICAgID8gZ2V0Q29tbWVudFNvY2tldFVybEZvckNvbW1lbnRlcihjbGFpbUlkLCBjaGFubmVsTmFtZSlcbiAgICAgIDogZ2V0Q29tbWVudFNvY2tldFVybChjbGFpbUlkLCBjaGFubmVsTmFtZSk7XG5cbiAgZGlzcGF0Y2goZG9Tb2NrZXREaXNjb25uZWN0KHVybCkpO1xuICBkaXNwYXRjaChkb1NldFNvY2tldENvbm5lY3Rpb24oZmFsc2UsIGNsYWltSWQsIHN1YkNhdGVnb3J5KSk7XG59O1xuXG5leHBvcnQgY29uc3QgZG9Db21tZW50U29ja2V0Q29ubmVjdEFzQ29tbWVudGVyID0gKHVyaSwgY2hhbm5lbE5hbWUsIGNsYWltSWQpID0+IChkaXNwYXRjaCkgPT5cbiAgZGlzcGF0Y2goZG9Db21tZW50U29ja2V0Q29ubmVjdCh1cmksIGNoYW5uZWxOYW1lLCBjbGFpbUlkLCBDT01NRU5UX1dTX1NVQkNBVEVHT1JJRVMuQ09NTUVOVEVSKSk7XG5cbmV4cG9ydCBjb25zdCBkb0NvbW1lbnRTb2NrZXREaXNjb25uZWN0QXNDb21tZW50ZXIgPSAoY2xhaW1JZCwgY2hhbm5lbE5hbWUpID0+IChkaXNwYXRjaCkgPT5cbiAgZGlzcGF0Y2goZG9Db21tZW50U29ja2V0RGlzY29ubmVjdChjbGFpbUlkLCBjaGFubmVsTmFtZSwgQ09NTUVOVF9XU19TVUJDQVRFR09SSUVTLkNPTU1FTlRFUikpO1xuXG5leHBvcnQgY29uc3QgZG9TZXRTb2NrZXRDb25uZWN0aW9uID0gKGNvbm5lY3RlZCwgaWQsIHN1YkNhdGVnb3J5KSA9PiAoZGlzcGF0Y2gpID0+XG4gIGRpc3BhdGNoKHtcbiAgICB0eXBlOiBBQ1RJT05TLlNPQ0tFVF9DT05ORUNURURfQllfSUQsXG4gICAgZGF0YTogeyBjb25uZWN0ZWQsIHN1Yl9jYXRlZ29yeTogc3ViQ2F0ZWdvcnksIGlkIH0sXG4gIH0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUNBO0FBR0E7QUFDQTtBQURBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRkE7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUZBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFGQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBUEE7QUFqQkE7QUEyQkE7QUFDQTtBQUNBO0FBckNBO0FBd0NBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFEQTtBQUdBO0FBVEE7QUFBQTtBQVlBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFYQTtBQUhBO0FBVEE7QUFBQTtBQThCQTtBQUFBO0FBQ0E7QUFLQTtBQUdBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUZBO0FBSUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFGQTtBQUlBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFGQTtBQVFBO0FBQ0E7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUdBO0FBQ0E7QUF6REE7QUE4REE7QUFwRUE7QUFBQTtBQXVFQTtBQUFBO0FBQ0E7QUFLQTtBQUNBO0FBUEE7QUFBQTtBQVVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRkE7QUFEQTtBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///../ui/redux/actions/websocket.js\n");

/***/ }),

/***/ "../ui/redux/reducers/comments.js":
/*!****************************************!*\
  !*** ../ui/redux/reducers/comments.js ***!
  \****************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var constants_action_types__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! constants/action_types */ \"../ui/constants/action_types.js\");\n/* harmony import */ var util_redux_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! util/redux-utils */ \"../ui/util/redux-utils.js\");\n/* harmony import */ var constants_comment__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! constants/comment */ \"../ui/constants/comment.js\");\n/* harmony import */ var util_lbryURI__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! util/lbryURI */ \"../ui/util/lbryURI.js\");\nvar _handleActions;\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\n\n\n\n // See 'CommentsState' for documentation.\n\nvar defaultState = {\n  commentById: {},\n  byId: {},\n  totalCommentsById: {},\n  repliesByParentId: {},\n  repliesTotalPagesByParentId: {},\n  topLevelCommentsById: {},\n  topLevelTotalPagesById: {},\n  topLevelTotalCommentsById: {},\n  // TODO:\n  // Remove commentsByUri\n  // It is not needed and doesn't provide anything but confusion\n  commentsByUri: {},\n  // URI -> claimId\n  fetchedCommentAncestors: {},\n  superChatsByUri: {},\n  pinnedCommentsById: {},\n  isLoading: false,\n  isLoadingById: false,\n  isLoadingByParentId: {},\n  isCommenting: false,\n  myComments: undefined,\n  isFetchingReacts: false,\n  pendingCommentReactions: [],\n  typesReacting: [],\n  myReactsByCommentId: undefined,\n  othersReactsByCommentId: undefined,\n  moderationBlockList: undefined,\n  adminBlockList: undefined,\n  moderatorBlockList: undefined,\n  moderatorBlockListDelegatorsMap: {},\n  fetchingModerationBlockList: false,\n  moderationDelegatesById: {},\n  fetchingModerationDelegates: false,\n  moderationDelegatorsById: {},\n  fetchingModerationDelegators: false,\n  blockingByUri: {},\n  unBlockingByUri: {},\n  personalTimeoutMap: {},\n  adminTimeoutMap: {},\n  moderatorTimeoutMap: {},\n  togglingForDelegatorMap: {},\n  settingsByChannelId: {},\n  fetchingSettings: false,\n  fetchingBlockedWords: false,\n  myCommentedChannelIdsById: {}\n}; // ****************************************************************************\n// Immutable helpers\n// ****************************************************************************\n\nfunction immPushToArrayInObject(obj, key, valueToPush) {\n  if (!obj[key]) {\n    obj[key] = [valueToPush];\n  } else if (!obj[key].includes(valueToPush)) {\n    // Filter duplicates\n    obj[key] = obj[key].concat(valueToPush);\n  }\n}\n\nfunction immConcatToArrayInObject(obj, key, arrayToMerge) {\n  if (obj[key]) {\n    obj[key] = obj[key].concat(arrayToMerge);\n  } else {\n    obj[key] = arrayToMerge;\n  }\n}\n\nfunction immPrefixArrayInObject(obj, key, valueToInsert) {\n  if (obj[key]) {\n    obj[key] = [valueToInsert].concat(_toConsumableArray(obj[key]));\n  } else {\n    obj[key] = [valueToInsert];\n  }\n} // ****************************************************************************\n// ****************************************************************************\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Object(util_redux_utils__WEBPACK_IMPORTED_MODULE_1__[\"handleActions\"])((_handleActions = {}, _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_CREATE_STARTED\"], function (state, action) {\n  return _objectSpread({}, state, {\n    isCommenting: true\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_CREATE_FAILED\"], function (state, action) {\n  return _objectSpread({}, state, {\n    isCommenting: false\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_CREATE_COMPLETED\"], function (state, action) {\n  var _action$data = action.data,\n      comment = _action$data.comment,\n      claimId = _action$data.claimId,\n      uri = _action$data.uri,\n      livestream = _action$data.livestream;\n  var commentById = Object.assign({}, state.commentById);\n  var byId = Object.assign({}, state.byId);\n  var totalCommentsById = Object.assign({}, state.totalCommentsById);\n  var topLevelCommentsById = Object.assign({}, state.topLevelCommentsById); // was byId {ClaimId -> [commentIds...]}\n\n  var repliesByParentId = Object.assign({}, state.repliesByParentId); // {ParentCommentID -> [commentIds...] } list of reply comments\n\n  var commentsByUri = Object.assign({}, state.commentsByUri);\n  var comments = byId[claimId] || [];\n  var newCommentIds = comments.slice(); // If it was created during a livestream, let the websocket handler perform the state update\n\n  if (!livestream) {\n    // add the comment by its ID\n    commentById[comment.comment_id] = comment; // push the comment_id to the top of ID list\n\n    newCommentIds.unshift(comment.comment_id);\n    byId[claimId] = newCommentIds;\n\n    if (totalCommentsById.hasOwnProperty(claimId)) {\n      totalCommentsById[claimId] += 1;\n    }\n\n    if (comment['parent_id']) {\n      if (!repliesByParentId[comment.parent_id]) {\n        repliesByParentId[comment.parent_id] = [comment.comment_id];\n      } else {\n        repliesByParentId[comment.parent_id].unshift(comment.comment_id);\n      } // Update the parent's \"replies\" value\n\n\n      if (commentById[comment.parent_id]) {\n        commentById[comment.parent_id].replies = (commentById[comment.parent_id].replies || 0) + 1;\n      }\n    } else {\n      if (!topLevelCommentsById[claimId]) {\n        commentsByUri[uri] = claimId;\n        topLevelCommentsById[claimId] = [comment.comment_id];\n      } else {\n        topLevelCommentsById[claimId].unshift(comment.comment_id);\n      }\n    }\n  }\n\n  var myCommentedChannelIdsById;\n  var commentedChannelIds = (state.myCommentedChannelIdsById[claimId] || []).slice();\n\n  if (!commentedChannelIds.includes(comment.channel_id)) {\n    commentedChannelIds.push(comment.channel_id);\n    myCommentedChannelIdsById = _objectSpread({}, state.myCommentedChannelIdsById, _defineProperty({}, claimId, commentedChannelIds));\n  }\n\n  return _objectSpread({}, state, {\n    topLevelCommentsById: topLevelCommentsById,\n    repliesByParentId: repliesByParentId,\n    commentById: commentById,\n    byId: byId,\n    totalCommentsById: totalCommentsById,\n    commentsByUri: commentsByUri,\n    isLoading: false,\n    isCommenting: false,\n    myCommentedChannelIdsById: myCommentedChannelIdsById || state.myCommentedChannelIdsById\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_REACTION_LIST_STARTED\"], function (state, action) {\n  return _objectSpread({}, state, {\n    isFetchingReacts: true\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_REACTION_LIST_FAILED\"], function (state, action) {\n  return _objectSpread({}, state, {\n    isFetchingReacts: false\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_REACT_FAILED\"], function (state, action) {\n  var commentReaction = action.data; // String: reactionHash + type\n\n  var newReactingTypes = new Set(state.pendingCommentReactions);\n  newReactingTypes[\"delete\"](commentReaction);\n  return _objectSpread({}, state, {\n    pendingCommentReactions: Array.from(newReactingTypes)\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_REACT_STARTED\"], function (state, action) {\n  var commentReaction = action.data;\n  var newReactingTypes = new Set(state.pendingCommentReactions);\n  newReactingTypes.add(commentReaction);\n  return _objectSpread({}, state, {\n    pendingCommentReactions: Array.from(newReactingTypes)\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_REACT_COMPLETED\"], function (state, action) {\n  var commentReaction = action.data; // String: reactionHash + type\n\n  var newReactingTypes = new Set(state.pendingCommentReactions);\n  newReactingTypes[\"delete\"](commentReaction);\n  return _objectSpread({}, state, {\n    pendingCommentReactions: Array.from(newReactingTypes)\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_REACTION_LIST_COMPLETED\"], function (state, action) {\n  var _action$data2 = action.data,\n      myReactions = _action$data2.myReactions,\n      othersReactions = _action$data2.othersReactions,\n      channelId = _action$data2.channelId,\n      commentIds = _action$data2.commentIds;\n  var myReacts = Object.assign({}, state.myReactsByCommentId);\n  var othersReacts = Object.assign({}, state.othersReactsByCommentId);\n  var myReactionsEntries = myReactions ? Object.entries(myReactions) : [];\n  var othersReactionsEntries = othersReactions ? Object.entries(othersReactions) : [];\n\n  if (myReactionsEntries.length > 0) {\n    myReactionsEntries.forEach(function (_ref) {\n      var _ref2 = _slicedToArray(_ref, 2),\n          commentId = _ref2[0],\n          reactions = _ref2[1];\n\n      var key = channelId ? \"\".concat(commentId, \":\").concat(channelId) : commentId;\n      myReacts[key] = Object.entries(reactions).reduce(function (acc, _ref3) {\n        var _ref4 = _slicedToArray(_ref3, 2),\n            name = _ref4[0],\n            count = _ref4[1];\n\n        if (count === 1) {\n          acc.push(name);\n        }\n\n        return acc;\n      }, []);\n    });\n  } else {\n    commentIds.forEach(function (commentId) {\n      var key = channelId ? \"\".concat(commentId, \":\").concat(channelId) : commentId;\n      myReacts[key] = [];\n    });\n  }\n\n  if (othersReactionsEntries.length > 0) {\n    othersReactionsEntries.forEach(function (_ref5) {\n      var _ref6 = _slicedToArray(_ref5, 2),\n          commentId = _ref6[0],\n          reactions = _ref6[1];\n\n      var key = channelId ? \"\".concat(commentId, \":\").concat(channelId) : commentId;\n      othersReacts[key] = reactions;\n    });\n  } else {\n    commentIds.forEach(function (commentId) {\n      var key = channelId ? \"\".concat(commentId, \":\").concat(channelId) : commentId;\n      othersReacts[key] = {};\n    });\n  }\n\n  return _objectSpread({}, state, {\n    isFetchingReacts: false,\n    myReactsByCommentId: myReacts,\n    othersReactsByCommentId: othersReacts\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_LIST_STARTED\"], function (state, action) {\n  var parentId = action.data.parentId;\n  var isLoadingByParentId = Object.assign({}, state.isLoadingByParentId);\n\n  if (parentId) {\n    isLoadingByParentId[parentId] = true;\n  }\n\n  return _objectSpread({}, state, {\n    isLoading: true,\n    isLoadingByParentId: isLoadingByParentId\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_LIST_COMPLETED\"], function (state, action) {\n  var _settingsByChannelId$;\n\n  var _action$data3 = action.data,\n      comments = _action$data3.comments,\n      parentId = _action$data3.parentId,\n      totalItems = _action$data3.totalItems,\n      totalFilteredItems = _action$data3.totalFilteredItems,\n      totalPages = _action$data3.totalPages,\n      claimId = _action$data3.claimId,\n      uri = _action$data3.uri,\n      disabled = _action$data3.disabled,\n      creatorClaimId = _action$data3.creatorClaimId;\n  var commentById = Object.assign({}, state.commentById);\n  var byId = Object.assign({}, state.byId);\n  var topLevelCommentsById = Object.assign({}, state.topLevelCommentsById); // was byId {ClaimId -> [commentIds...]}\n\n  var topLevelTotalCommentsById = Object.assign({}, state.topLevelTotalCommentsById);\n  var topLevelTotalPagesById = Object.assign({}, state.topLevelTotalPagesById);\n  var commentsByUri = Object.assign({}, state.commentsByUri);\n  var repliesByParentId = Object.assign({}, state.repliesByParentId);\n  var totalCommentsById = Object.assign({}, state.totalCommentsById);\n  var pinnedCommentsById = Object.assign({}, state.pinnedCommentsById);\n  var repliesTotalPagesByParentId = Object.assign({}, state.repliesTotalPagesByParentId);\n  var isLoadingByParentId = Object.assign({}, state.isLoadingByParentId);\n  var settingsByChannelId = Object.assign({}, state.settingsByChannelId); // save an array of claim ids of members-only chats to check during list\n\n  var membersOnlyChats = ((_settingsByChannelId$ = settingsByChannelId[creatorClaimId]) === null || _settingsByChannelId$ === void 0 ? void 0 : _settingsByChannelId$.livestream_chat_members_only) || false; // if (restrictedToMembersOnly) {\n  //   membersOnlyChats.push(claimId);\n  // }\n\n  settingsByChannelId[creatorClaimId] = _objectSpread({}, settingsByChannelId[creatorClaimId] || {}, {\n    // comments_enabled: !disabled,\n    livestream_chat_members_only: membersOnlyChats\n  });\n\n  if (parentId) {\n    isLoadingByParentId[parentId] = false;\n  }\n\n  if (!disabled) {\n    if (parentId) {\n      repliesTotalPagesByParentId[parentId] = totalPages;\n    } else {\n      totalCommentsById[claimId] = totalItems;\n      topLevelTotalCommentsById[claimId] = totalFilteredItems;\n      topLevelTotalPagesById[claimId] = totalPages;\n    }\n\n    var commonUpdateAction = function commonUpdateAction(comment, commentById, commentIds, index) {\n      // map the comment_ids to the new comments\n      commentById[comment.comment_id] = comment;\n      commentIds[index] = comment.comment_id;\n    };\n\n    if (comments) {\n      // we use an Array to preserve order of listing\n      // in reality this doesn't matter and we can just\n      // sort comments by their timestamp\n      var commentIds = Array(comments.length); // --- Top-level comments ---\n\n      if (!parentId) {\n        for (var i = 0; i < comments.length; ++i) {\n          var comment = comments[i];\n          commonUpdateAction(comment, commentById, commentIds, i);\n\n          if (comment.is_pinned) {\n            immPushToArrayInObject(pinnedCommentsById, claimId, comment.comment_id);\n          } else {\n            immPushToArrayInObject(topLevelCommentsById, claimId, comment.comment_id);\n          }\n        }\n      } // --- Replies ---\n      else {\n          for (var _i2 = 0; _i2 < comments.length; ++_i2) {\n            var _comment = comments[_i2];\n            commonUpdateAction(_comment, commentById, commentIds, _i2);\n            immPushToArrayInObject(repliesByParentId, parentId, _comment.comment_id);\n          }\n        }\n\n      immConcatToArrayInObject(byId, claimId, commentIds);\n      commentsByUri[uri] = claimId;\n    }\n  }\n\n  return _objectSpread({}, state, {\n    topLevelCommentsById: topLevelCommentsById,\n    topLevelTotalCommentsById: topLevelTotalCommentsById,\n    topLevelTotalPagesById: topLevelTotalPagesById,\n    repliesByParentId: repliesByParentId,\n    totalCommentsById: totalCommentsById,\n    pinnedCommentsById: pinnedCommentsById,\n    repliesTotalPagesByParentId: repliesTotalPagesByParentId,\n    byId: byId,\n    commentById: commentById,\n    commentsByUri: commentsByUri,\n    isLoading: false,\n    isLoadingByParentId: isLoadingByParentId,\n    settingsByChannelId: settingsByChannelId\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_BY_ID_STARTED\"], function (state) {\n  return _objectSpread({}, state, {\n    isLoadingById: true\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_BY_ID_COMPLETED\"], function (state, action) {\n  var _action$data4 = action.data,\n      comment = _action$data4.comment,\n      ancestors = _action$data4.ancestors;\n  var claimId = comment.claim_id;\n  var commentById = Object.assign({}, state.commentById);\n  var byId = Object.assign({}, state.byId);\n  var topLevelCommentsById = Object.assign({}, state.topLevelCommentsById); // was byId {ClaimId -> [commentIds...]}\n\n  var topLevelTotalCommentsById = Object.assign({}, state.topLevelTotalCommentsById);\n  var topLevelTotalPagesById = Object.assign({}, state.topLevelTotalPagesById);\n  var pinnedCommentsById = Object.assign({}, state.pinnedCommentsById);\n  var repliesByParentId = Object.assign({}, state.repliesByParentId);\n  var fetchedCommentAncestors = Object.assign({}, state.fetchedCommentAncestors);\n\n  var updateStore = function updateStore(comment, commentById, byId, repliesByParentId, topLevelCommentsById) {\n    commentById[comment.comment_id] = comment;\n    immPrefixArrayInObject(byId, claimId, comment.comment_id);\n    var parentId = comment.parent_id;\n\n    if (comment.parent_id) {\n      immPushToArrayInObject(repliesByParentId, parentId, comment.comment_id);\n    } else {\n      if (comment.is_pinned) {\n        immPushToArrayInObject(pinnedCommentsById, claimId, comment.comment_id);\n      } else {\n        immPushToArrayInObject(topLevelCommentsById, claimId, comment.comment_id);\n      }\n    }\n  };\n\n  updateStore(comment, commentById, byId, repliesByParentId, topLevelCommentsById);\n\n  if (ancestors) {\n    ancestors.forEach(function (ancestor) {\n      updateStore(ancestor, commentById, byId, repliesByParentId, topLevelCommentsById);\n      immPushToArrayInObject(fetchedCommentAncestors, comment.comment_id, ancestor.comment_id);\n    });\n  }\n\n  return _objectSpread({}, state, {\n    isLoadingById: false,\n    topLevelCommentsById: topLevelCommentsById,\n    topLevelTotalCommentsById: topLevelTotalCommentsById,\n    topLevelTotalPagesById: topLevelTotalPagesById,\n    pinnedCommentsById: pinnedCommentsById,\n    repliesByParentId: repliesByParentId,\n    byId: byId,\n    commentById: commentById,\n    fetchedCommentAncestors: fetchedCommentAncestors\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_FETCH_MY_COMMENTED_CHANNELS_COMPLETE\"], function (state, action) {\n  var _action$data5 = action.data,\n      contentClaimId = _action$data5.contentClaimId,\n      commentedChannelIds = _action$data5.commentedChannelIds;\n  return _objectSpread({}, state, {\n    myCommentedChannelIdsById: _objectSpread({}, state.myCommentedChannelIdsById, _defineProperty({}, contentClaimId, commentedChannelIds))\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_SUPER_CHAT_LIST_FAILED\"], function (state, action) {\n  return _objectSpread({}, state, {\n    isLoading: false\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_SUPER_CHAT_LIST_STARTED\"], function (state) {\n  return _objectSpread({}, state, {\n    isLoading: true\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_SUPER_CHAT_LIST_COMPLETED\"], function (state, action) {\n  var _action$data6 = action.data,\n      comments = _action$data6.comments,\n      totalAmount = _action$data6.totalAmount,\n      uri = _action$data6.uri;\n  return _objectSpread({}, state, {\n    superChatsByUri: _objectSpread({}, state.superChatsByUri, _defineProperty({}, uri, {\n      comments: comments,\n      totalAmount: totalAmount\n    })),\n    isLoading: false\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_LIST_FAILED\"], function (state, action) {\n  return _objectSpread({}, state, {\n    isLoading: false\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_LIST_RESET\"], function (state, action) {\n  var claimId = action.data.claimId;\n  var byId = Object.assign({}, state.byId);\n  var totalCommentsById = Object.assign({}, state.totalCommentsById);\n  var topLevelCommentsById = Object.assign({}, state.topLevelCommentsById); // was byId {ClaimId -> [commentIds...]}\n\n  var topLevelTotalCommentsById = Object.assign({}, state.topLevelTotalCommentsById);\n  var topLevelTotalPagesById = Object.assign({}, state.topLevelTotalPagesById);\n  var pinnedCommentsById = Object.assign({}, state.pinnedCommentsById);\n  var myReacts = Object.assign({}, state.myReactsByCommentId);\n  var othersReacts = Object.assign({}, state.othersReactsByCommentId);\n\n  function deleteReacts(reactObj, commentIdsToRemove) {\n    if (commentIdsToRemove && commentIdsToRemove.length > 0) {\n      var reactionKeys = Object.keys(reactObj);\n      reactionKeys.forEach(function (rk) {\n        var colonIndex = rk.indexOf(':');\n        var commentId = colonIndex === -1 ? rk : rk.substring(0, colonIndex);\n\n        if (commentIdsToRemove.includes(commentId)) {\n          delete reactObj[rk];\n        }\n      });\n    }\n  }\n\n  deleteReacts(myReacts, byId[claimId]);\n  deleteReacts(othersReacts, byId[claimId]);\n  delete byId[claimId];\n  delete totalCommentsById[claimId];\n  delete topLevelCommentsById[claimId];\n  delete topLevelTotalCommentsById[claimId];\n  delete topLevelTotalPagesById[claimId];\n  delete pinnedCommentsById[claimId];\n  return _objectSpread({}, state, {\n    byId: byId,\n    totalCommentsById: totalCommentsById,\n    topLevelCommentsById: topLevelCommentsById,\n    topLevelTotalCommentsById: topLevelTotalCommentsById,\n    topLevelTotalPagesById: topLevelTotalPagesById,\n    pinnedCommentsById: pinnedCommentsById,\n    myReactsByCommentId: myReacts,\n    othersReactsByCommentId: othersReacts\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_RECEIVED\"], function (state, action) {\n  var _action$data7 = action.data,\n      uri = _action$data7.uri,\n      claimId = _action$data7.claimId,\n      comment = _action$data7.comment;\n  var commentsByUri = Object.assign({}, state.commentsByUri);\n  var commentsByClaimId = Object.assign({}, state.byId);\n  var allCommentsById = Object.assign({}, state.commentById);\n  var topLevelCommentsById = Object.assign({}, state.topLevelCommentsById);\n  var superChatsByUri = Object.assign({}, state.superChatsByUri);\n  var commentsForId = topLevelCommentsById[claimId];\n  allCommentsById[comment.comment_id] = comment;\n  commentsByUri[uri] = claimId;\n\n  if (commentsForId) {\n    var newCommentsForId = commentsForId.slice();\n    var commentExists = newCommentsForId.includes(comment.comment_id);\n\n    if (!commentExists) {\n      newCommentsForId.unshift(comment.comment_id);\n    }\n\n    topLevelCommentsById[claimId] = newCommentsForId;\n  } else {\n    topLevelCommentsById[claimId] = [comment.comment_id];\n  } // We don't care to keep existing lower level comments since this is just for livestreams\n\n\n  commentsByClaimId[claimId] = topLevelCommentsById[claimId];\n\n  if (comment.support_amount > 0) {\n    var superChatForUri = superChatsByUri[uri];\n    var superChatCommentsForUri = superChatForUri && superChatForUri.comments;\n    var sortedSuperChatComments = [];\n    var hasAddedNewComment = false;\n\n    if (superChatCommentsForUri && superChatCommentsForUri.length > 0) {\n      // Go for the entire length of superChatCommentsForUri since a comment will be added to this list\n      for (var i = 0; i < superChatCommentsForUri.length; i++) {\n        var existingSuperChat = superChatCommentsForUri[i];\n\n        if (existingSuperChat.support_amount < comment.support_amount && !hasAddedNewComment) {\n          hasAddedNewComment = true;\n          sortedSuperChatComments.push(comment);\n          sortedSuperChatComments.push(existingSuperChat);\n        } else {\n          sortedSuperChatComments.push(existingSuperChat);\n        } // If the new superchat hasn't been added yet, it must be the smallest superchat in the list\n\n\n        if (i === superChatCommentsForUri.length - 1 && sortedSuperChatComments.length === superChatCommentsForUri.length) {\n          sortedSuperChatComments.push(comment);\n        }\n      }\n\n      superChatsByUri[uri].comments = sortedSuperChatComments;\n      superChatsByUri[uri].totalAmount += comment.support_amount;\n    } else {\n      superChatsByUri[uri] = {\n        comments: [comment],\n        totalAmount: comment.support_amount\n      };\n    }\n  }\n\n  return _objectSpread({}, state, {\n    byId: commentsByClaimId,\n    commentById: allCommentsById,\n    commentsByUri: commentsByUri,\n    topLevelCommentsById: topLevelCommentsById,\n    superChatsByUri: superChatsByUri\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_ABANDON_STARTED\"], function (state, action) {\n  return _objectSpread({}, state, {\n    isLoading: true\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_ABANDON_COMPLETED\"], function (state, action) {\n  var comment_id = action.data.comment_id;\n  var commentById = Object.assign({}, state.commentById);\n  var byId = Object.assign({}, state.byId);\n  var repliesByParentId = Object.assign({}, state.repliesByParentId); // {ParentCommentID -> [commentIds...] } list of reply comments\n\n  var totalCommentsById = Object.assign({}, state.totalCommentsById);\n  var comment = commentById[comment_id]; // to remove the comment and its references\n\n  var claimId = comment.claim_id;\n\n  if (byId[claimId]) {\n    for (var i = 0; i < byId[claimId].length; i++) {\n      if (byId[claimId][i] === comment_id) {\n        // immutable update\n        byId[claimId] = Array.from(byId[claimId]);\n        byId[claimId].splice(i, 1);\n        break;\n      }\n    }\n  } // Update replies\n\n\n  if (comment['parent_id'] && repliesByParentId[comment.parent_id]) {\n    var index = repliesByParentId[comment.parent_id].indexOf(comment.comment_id);\n\n    if (index > -1) {\n      repliesByParentId[comment.parent_id].splice(index, 1);\n\n      if (commentById[comment.parent_id]) {\n        commentById[comment.parent_id].replies = Math.max(0, (commentById[comment.parent_id].replies || 0) - 1);\n      }\n    }\n  }\n\n  if (totalCommentsById.hasOwnProperty(claimId)) {\n    totalCommentsById[claimId] = Math.max(0, totalCommentsById[claimId] - 1);\n  }\n\n  delete commentById[comment_id];\n  return _objectSpread({}, state, {\n    commentById: commentById,\n    byId: byId,\n    totalCommentsById: totalCommentsById,\n    repliesByParentId: repliesByParentId,\n    isLoading: false\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_ABANDON_FAILED\"], function (state, action) {\n  return _objectSpread({}, state, {\n    isCommenting: false\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_UPDATE_STARTED\"], function (state, action) {\n  return _objectSpread({}, state, {\n    isCommenting: true\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_UPDATE_COMPLETED\"], function (state, action) {\n  var comment = action.data.comment;\n  var commentById = Object.assign({}, state.commentById);\n  commentById[comment.comment_id] = comment;\n  return _objectSpread({}, state, {\n    commentById: commentById,\n    isCommenting: false\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_UPDATE_FAILED\"], function (state, action) {\n  return _objectSpread({}, state, {\n    isCmmenting: false\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_PIN_COMPLETED\"], function (state, action) {\n  var _action$data8 = action.data,\n      pinnedComment = _action$data8.pinnedComment,\n      claimId = _action$data8.claimId,\n      unpin = _action$data8.unpin;\n  var commentById = Object.assign({}, state.commentById);\n  var topLevelCommentsById = Object.assign({}, state.topLevelCommentsById);\n  var pinnedCommentsById = Object.assign({}, state.pinnedCommentsById);\n\n  if (pinnedComment) {\n    if (topLevelCommentsById[claimId]) {\n      var index = topLevelCommentsById[claimId].indexOf(pinnedComment.comment_id);\n\n      if (index > -1) {\n        topLevelCommentsById[claimId].splice(index, 1);\n      }\n    } else {\n      topLevelCommentsById[claimId] = [];\n    }\n\n    if (pinnedCommentsById[claimId]) {\n      var _index = pinnedCommentsById[claimId].indexOf(pinnedComment.comment_id);\n\n      if (_index > -1) {\n        pinnedCommentsById[claimId].splice(_index, 1);\n      }\n    } else {\n      pinnedCommentsById[claimId] = [];\n    }\n\n    if (unpin) {\n      // Without the sort score, I have no idea where to put it. Just\n      // dump it at the top. Users can refresh if they want it back to\n      // the correct sorted position.\n      topLevelCommentsById[claimId].unshift(pinnedComment.comment_id);\n    } else {\n      pinnedCommentsById[claimId].unshift(pinnedComment.comment_id);\n    }\n\n    if (commentById[pinnedComment.comment_id]) {\n      // Commentron's `comment.Pin` response places the creator's credentials\n      // in the 'channel_*' fields, which doesn't make sense. Maybe it is to\n      // show who signed/pinned it, but even if so, it shouldn't overload\n      // these variables which are already used by existing comment data structure.\n      // Ensure we don't override the existing/correct values, but fallback\n      // to whatever was given.\n      var _commentById$pinnedCo = commentById[pinnedComment.comment_id],\n          channel_id = _commentById$pinnedCo.channel_id,\n          channel_name = _commentById$pinnedCo.channel_name,\n          channel_url = _commentById$pinnedCo.channel_url;\n      commentById[pinnedComment.comment_id] = _objectSpread({}, pinnedComment, {\n        channel_id: channel_id || pinnedComment.channel_id,\n        channel_name: channel_name || pinnedComment.channel_name,\n        channel_url: channel_url || pinnedComment.channel_url\n      });\n    } else {\n      commentById[pinnedComment.comment_id] = pinnedComment;\n    }\n  }\n\n  return _objectSpread({}, state, {\n    commentById: commentById,\n    topLevelCommentsById: topLevelCommentsById,\n    pinnedCommentsById: pinnedCommentsById\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_MARK_AS_REMOVED\"], function (state, action) {\n  var comment_id = action.data.comment_id;\n  var commentById = Object.assign({}, state.commentById);\n\n  if (!commentById[comment_id]) {\n    return state;\n  }\n\n  commentById[comment_id] = _objectSpread({}, commentById[comment_id], {\n    removed: true\n  });\n  return _objectSpread({}, state, {\n    commentById: commentById\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_MODERATION_BLOCK_LIST_STARTED\"], function (state, action) {\n  return _objectSpread({}, state, {\n    fetchingModerationBlockList: true\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_MODERATION_BLOCK_LIST_COMPLETED\"], function (state, action) {\n  var _action$data9 = action.data,\n      personalBlockList = _action$data9.personalBlockList,\n      adminBlockList = _action$data9.adminBlockList,\n      moderatorBlockList = _action$data9.moderatorBlockList,\n      moderatorBlockListDelegatorsMap = _action$data9.moderatorBlockListDelegatorsMap,\n      personalTimeoutMap = _action$data9.personalTimeoutMap,\n      adminTimeoutMap = _action$data9.adminTimeoutMap,\n      moderatorTimeoutMap = _action$data9.moderatorTimeoutMap;\n  return _objectSpread({}, state, {\n    moderationBlockList: personalBlockList,\n    adminBlockList: adminBlockList,\n    moderatorBlockList: moderatorBlockList,\n    moderatorBlockListDelegatorsMap: moderatorBlockListDelegatorsMap,\n    personalTimeoutMap: personalTimeoutMap,\n    adminTimeoutMap: adminTimeoutMap,\n    moderatorTimeoutMap: moderatorTimeoutMap,\n    fetchingModerationBlockList: false\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_MODERATION_BLOCK_LIST_FAILED\"], function (state, action) {\n  return _objectSpread({}, state, {\n    fetchingModerationBlockList: false\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_MODERATION_BLOCK_STARTED\"], function (state, action) {\n  var _action$data10 = action.data,\n      blockedUri = _action$data10.blockedUri,\n      creatorUri = _action$data10.creatorUri,\n      blockLevel = _action$data10.blockLevel;\n\n  switch (blockLevel) {\n    default:\n    case constants_comment__WEBPACK_IMPORTED_MODULE_2__[\"BLOCK_LEVEL\"].SELF:\n    case constants_comment__WEBPACK_IMPORTED_MODULE_2__[\"BLOCK_LEVEL\"].ADMIN:\n      return _objectSpread({}, state, {\n        blockingByUri: _objectSpread({}, state.blockingByUri, _defineProperty({}, blockedUri, true))\n      });\n\n    case constants_comment__WEBPACK_IMPORTED_MODULE_2__[\"BLOCK_LEVEL\"].MODERATOR:\n      var newMap = Object.assign({}, state.togglingForDelegatorMap);\n      var togglingDelegatorsForBlockedUri = newMap[blockedUri];\n\n      if (togglingDelegatorsForBlockedUri) {\n        if (!togglingDelegatorsForBlockedUri.includes(creatorUri)) {\n          togglingDelegatorsForBlockedUri.push(creatorUri);\n        }\n      } else {\n        newMap[blockedUri] = [creatorUri];\n      }\n\n      return _objectSpread({}, state, {\n        togglingForDelegatorMap: newMap\n      });\n  }\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_MODERATION_UN_BLOCK_STARTED\"], function (state, action) {\n  var _action$data11 = action.data,\n      blockedUri = _action$data11.blockedUri,\n      creatorUri = _action$data11.creatorUri,\n      blockLevel = _action$data11.blockLevel;\n\n  switch (blockLevel) {\n    default:\n    case constants_comment__WEBPACK_IMPORTED_MODULE_2__[\"BLOCK_LEVEL\"].SELF:\n    case constants_comment__WEBPACK_IMPORTED_MODULE_2__[\"BLOCK_LEVEL\"].ADMIN:\n      return _objectSpread({}, state, {\n        unBlockingByUri: _objectSpread({}, state.unBlockingByUri, _defineProperty({}, blockedUri, true))\n      });\n\n    case constants_comment__WEBPACK_IMPORTED_MODULE_2__[\"BLOCK_LEVEL\"].MODERATOR:\n      var newMap = Object.assign({}, state.togglingForDelegatorMap);\n      var togglingDelegatorsForBlockedUri = newMap[blockedUri];\n\n      if (togglingDelegatorsForBlockedUri) {\n        if (!togglingDelegatorsForBlockedUri.includes(creatorUri)) {\n          togglingDelegatorsForBlockedUri.push(creatorUri);\n        }\n      } else {\n        newMap[blockedUri] = [creatorUri];\n      }\n\n      return _objectSpread({}, state, {\n        togglingForDelegatorMap: newMap\n      });\n  }\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_MODERATION_BLOCK_FAILED\"], function (state, action) {\n  var _action$data12 = action.data,\n      blockedUri = _action$data12.blockedUri,\n      creatorUri = _action$data12.creatorUri,\n      blockLevel = _action$data12.blockLevel;\n\n  switch (blockLevel) {\n    default:\n    case constants_comment__WEBPACK_IMPORTED_MODULE_2__[\"BLOCK_LEVEL\"].SELF:\n    case constants_comment__WEBPACK_IMPORTED_MODULE_2__[\"BLOCK_LEVEL\"].ADMIN:\n      return _objectSpread({}, state, {\n        blockingByUri: _objectSpread({}, state.blockingByUri, _defineProperty({}, blockedUri, false))\n      });\n\n    case constants_comment__WEBPACK_IMPORTED_MODULE_2__[\"BLOCK_LEVEL\"].MODERATOR:\n      var newMap = Object.assign({}, state.togglingForDelegatorMap);\n      var togglingDelegatorsForBlockedUri = newMap[blockedUri];\n\n      if (togglingDelegatorsForBlockedUri) {\n        newMap[blockedUri] = togglingDelegatorsForBlockedUri.filter(function (x) {\n          return x !== creatorUri;\n        });\n      }\n\n      return _objectSpread({}, state, {\n        togglingForDelegatorMap: newMap\n      });\n  }\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_MODERATION_UN_BLOCK_FAILED\"], function (state, action) {\n  var _action$data13 = action.data,\n      blockedUri = _action$data13.blockedUri,\n      creatorUri = _action$data13.creatorUri,\n      blockLevel = _action$data13.blockLevel;\n\n  switch (blockLevel) {\n    default:\n    case constants_comment__WEBPACK_IMPORTED_MODULE_2__[\"BLOCK_LEVEL\"].SELF:\n    case constants_comment__WEBPACK_IMPORTED_MODULE_2__[\"BLOCK_LEVEL\"].ADMIN:\n      return _objectSpread({}, state, {\n        unBlockingByUri: _objectSpread({}, state.unBlockingByUri, _defineProperty({}, blockedUri, false))\n      });\n\n    case constants_comment__WEBPACK_IMPORTED_MODULE_2__[\"BLOCK_LEVEL\"].MODERATOR:\n      var newMap = Object.assign({}, state.togglingForDelegatorMap);\n      var togglingDelegatorsForBlockedUri = newMap[blockedUri];\n\n      if (togglingDelegatorsForBlockedUri) {\n        newMap[blockedUri] = togglingDelegatorsForBlockedUri.filter(function (x) {\n          return x !== creatorUri;\n        });\n      }\n\n      return _objectSpread({}, state, {\n        togglingForDelegatorMap: newMap\n      });\n  }\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_MODERATION_BLOCK_COMPLETE\"], function (state, action) {\n  var _action$data14 = action.data,\n      blockedUri = _action$data14.blockedUri,\n      creatorUri = _action$data14.creatorUri,\n      blockLevel = _action$data14.blockLevel;\n  var commentById = Object.assign({}, state.commentById);\n  var blockingByUri = Object.assign({}, state.blockingByUri);\n\n  for (var commentId in commentById) {\n    var comment = commentById[commentId];\n\n    if (Object(util_lbryURI__WEBPACK_IMPORTED_MODULE_3__[\"isURIEqual\"])(blockedUri, comment.channel_url)) {\n      delete commentById[comment.comment_id];\n    }\n  }\n\n  switch (blockLevel) {\n    case constants_comment__WEBPACK_IMPORTED_MODULE_2__[\"BLOCK_LEVEL\"].SELF:\n      {\n        var _blockList = state.moderationBlockList || [];\n\n        var _newBlockList = _blockList.slice();\n\n        _newBlockList.push(blockedUri);\n\n        delete blockingByUri[blockedUri];\n        return _objectSpread({}, state, {\n          commentById: commentById,\n          blockingByUri: blockingByUri,\n          moderationBlockList: _newBlockList\n        });\n      }\n\n    case constants_comment__WEBPACK_IMPORTED_MODULE_2__[\"BLOCK_LEVEL\"].MODERATOR:\n      {\n        var _blockList2 = state.moderatorBlockList || [];\n\n        var _newBlockList2 = _blockList2.slice(); // Update main block list\n\n\n        if (!_newBlockList2.includes(blockedUri)) {\n          _newBlockList2.push(blockedUri);\n        } // Update list of delegators\n\n\n        var moderatorBlockListDelegatorsMap = Object.assign({}, state.moderatorBlockListDelegatorsMap);\n        var delegatorUrisForBlockedUri = moderatorBlockListDelegatorsMap[blockedUri];\n\n        if (delegatorUrisForBlockedUri) {\n          if (!delegatorUrisForBlockedUri.includes(creatorUri)) {\n            delegatorUrisForBlockedUri.push(creatorUri);\n          }\n        } else {\n          moderatorBlockListDelegatorsMap[blockedUri] = [creatorUri];\n        } // Remove \"toggling\" flag\n\n\n        var togglingMap = Object.assign({}, state.togglingForDelegatorMap);\n        var togglingDelegatorsForBlockedUri = togglingMap[blockedUri];\n\n        if (togglingDelegatorsForBlockedUri) {\n          togglingMap[blockedUri] = togglingDelegatorsForBlockedUri.filter(function (x) {\n            return x !== creatorUri;\n          });\n        }\n\n        return _objectSpread({}, state, {\n          commentById: commentById,\n          moderatorBlockList: _newBlockList2,\n          moderatorBlockListDelegatorsMap: moderatorBlockListDelegatorsMap,\n          togglingForDelegatorMap: togglingMap\n        });\n      }\n\n    case constants_comment__WEBPACK_IMPORTED_MODULE_2__[\"BLOCK_LEVEL\"].ADMIN:\n      var blockList = state.adminBlockList || [];\n      var newBlockList = blockList.slice();\n      newBlockList.push(blockedUri);\n      delete blockingByUri[blockedUri];\n      return _objectSpread({}, state, {\n        commentById: commentById,\n        blockingByUri: blockingByUri,\n        adminBlockList: newBlockList\n      });\n  }\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_MODERATION_UN_BLOCK_COMPLETE\"], function (state, action) {\n  var _action$data15 = action.data,\n      blockedUri = _action$data15.blockedUri,\n      creatorUri = _action$data15.creatorUri,\n      blockLevel = _action$data15.blockLevel;\n  var unBlockingByUri = Object.assign(state.unBlockingByUri, {});\n\n  switch (blockLevel) {\n    case constants_comment__WEBPACK_IMPORTED_MODULE_2__[\"BLOCK_LEVEL\"].SELF:\n      {\n        var blockList = state.moderationBlockList || [];\n        delete unBlockingByUri[blockedUri];\n        return _objectSpread({}, state, {\n          unBlockingByUri: unBlockingByUri,\n          moderationBlockList: blockList.slice().filter(function (uri) {\n            return uri !== blockedUri;\n          })\n        });\n      }\n\n    case constants_comment__WEBPACK_IMPORTED_MODULE_2__[\"BLOCK_LEVEL\"].ADMIN:\n      {\n        var _blockList3 = state.adminBlockList || [];\n\n        delete unBlockingByUri[blockedUri];\n        return _objectSpread({}, state, {\n          unBlockingByUri: unBlockingByUri,\n          adminBlockList: _blockList3.slice().filter(function (uri) {\n            return uri !== blockedUri;\n          })\n        });\n      }\n\n    case constants_comment__WEBPACK_IMPORTED_MODULE_2__[\"BLOCK_LEVEL\"].MODERATOR:\n      {\n        var _blockList4 = state.moderatorBlockList || [];\n\n        var newBlockList = _blockList4.slice();\n\n        var togglingMap = Object.assign({}, state.togglingForDelegatorMap);\n        var moderatorBlockListDelegatorsMap = Object.assign({}, state.moderatorBlockListDelegatorsMap);\n        var delegatorUrisForBlockedUri = moderatorBlockListDelegatorsMap[blockedUri];\n\n        if (delegatorUrisForBlockedUri) {\n          var index = delegatorUrisForBlockedUri.indexOf(creatorUri);\n\n          if (index > -1) {\n            // Remove from delegators list\n            delegatorUrisForBlockedUri.splice(index, 1); // // Remove blocked entry if it was removed for all delegators\n            // if (delegatorUrisForBlockedUri.length === 0) {\n            //   delete moderatorBlockListDelegatorsMap[blockedUri];\n            //   newBlockList = newBlockList.filter((uri) => uri !== blockedUri);\n            // }\n            // Remove from \"toggling\" flag\n\n            var togglingDelegatorsForBlockedUri = togglingMap[blockedUri];\n\n            if (togglingDelegatorsForBlockedUri) {\n              togglingMap[blockedUri] = togglingDelegatorsForBlockedUri.filter(function (x) {\n                return x !== creatorUri;\n              });\n            }\n          }\n        }\n\n        return _objectSpread({}, state, {\n          moderatorBlockList: newBlockList,\n          togglingForDelegatorMap: togglingMap\n        });\n      }\n  }\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_FETCH_MODERATION_DELEGATES_STARTED\"], function (state, action) {\n  return _objectSpread({}, state, {\n    fetchingModerationDelegates: true\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_FETCH_MODERATION_DELEGATES_FAILED\"], function (state, action) {\n  return _objectSpread({}, state, {\n    fetchingModerationDelegates: false\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_FETCH_MODERATION_DELEGATES_COMPLETED\"], function (state, action) {\n  var moderationDelegatesById = Object.assign({}, state.moderationDelegatesById);\n\n  if (action.data.delegates) {\n    moderationDelegatesById[action.data.id] = action.data.delegates.map(function (delegate) {\n      return {\n        channelId: delegate.channel_id,\n        channelName: delegate.channel_name\n      };\n    });\n  } else {\n    moderationDelegatesById[action.data.id] = [];\n  }\n\n  return _objectSpread({}, state, {\n    fetchingModerationDelegates: false,\n    moderationDelegatesById: moderationDelegatesById\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_MODERATION_AM_I_LIST_STARTED\"], function (state, action) {\n  return _objectSpread({}, state, {\n    fetchingModerationDelegators: true\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_MODERATION_AM_I_LIST_FAILED\"], function (state, action) {\n  return _objectSpread({}, state, {\n    fetchingModerationDelegators: true\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_MODERATION_AM_I_LIST_COMPLETED\"], function (state, action) {\n  return _objectSpread({}, state, {\n    fetchingModerationDelegators: true,\n    moderationDelegatorsById: action.data\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_FETCH_SETTINGS_STARTED\"], function (state, action) {\n  return _objectSpread({}, state, {\n    fetchingSettings: true\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_FETCH_SETTINGS_FAILED\"], function (state, action) {\n  return _objectSpread({}, state, {\n    fetchingSettings: false\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_FETCH_SETTINGS_COMPLETED\"], function (state, action) {\n  var _action$data16 = action.data,\n      channelId = _action$data16.channelId,\n      settings = _action$data16.settings,\n      partialUpdate = _action$data16.partialUpdate;\n  var settingsByChannelId = Object.assign({}, state.settingsByChannelId);\n\n  if (partialUpdate) {\n    settingsByChannelId[channelId] = _objectSpread({}, settingsByChannelId[channelId] || {}, {}, settings);\n  } else {\n    settingsByChannelId[channelId] = settings;\n\n    if (settings.words) {\n      settingsByChannelId[channelId].words = settings.words.split(',');\n    }\n  }\n\n  return _objectSpread({}, state, {\n    settingsByChannelId: settingsByChannelId,\n    fetchingSettings: false\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_FETCH_BLOCKED_WORDS_STARTED\"], function (state, action) {\n  return _objectSpread({}, state, {\n    fetchingBlockedWords: true\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_FETCH_BLOCKED_WORDS_FAILED\"], function (state, action) {\n  return _objectSpread({}, state, {\n    fetchingBlockedWords: false\n  });\n}), _defineProperty(_handleActions, constants_action_types__WEBPACK_IMPORTED_MODULE_0__[\"COMMENT_FETCH_BLOCKED_WORDS_COMPLETED\"], function (state, action) {\n  var blockedWordsByChannelId = action.data;\n  var settingsByChannelId = Object.assign({}, state.settingsByChannelId); // blockedWordsByChannelId: {string: [string]}\n\n  Object.entries(blockedWordsByChannelId).forEach(function (x) {\n    var channelId = x[0];\n\n    if (!settingsByChannelId[channelId]) {\n      settingsByChannelId[channelId] = {};\n    }\n\n    settingsByChannelId[channelId].words = x[1];\n  });\n  return _objectSpread({}, state, {\n    settingsByChannelId: settingsByChannelId,\n    fetchingBlockedWords: false\n  });\n}), _handleActions), defaultState));//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi4vdWkvcmVkdXgvcmVkdWNlcnMvY29tbWVudHMuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi4vdWkvcmVkdXgvcmVkdWNlcnMvY29tbWVudHMuanM/YjBmYyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBAZmxvd1xuaW1wb3J0ICogYXMgQUNUSU9OUyBmcm9tICdjb25zdGFudHMvYWN0aW9uX3R5cGVzJztcbmltcG9ydCB7IGhhbmRsZUFjdGlvbnMgfSBmcm9tICd1dGlsL3JlZHV4LXV0aWxzJztcbmltcG9ydCB7IEJMT0NLX0xFVkVMIH0gZnJvbSAnY29uc3RhbnRzL2NvbW1lbnQnO1xuaW1wb3J0IHsgaXNVUklFcXVhbCB9IGZyb20gJ3V0aWwvbGJyeVVSSSc7XG5cbi8vIFNlZSAnQ29tbWVudHNTdGF0ZScgZm9yIGRvY3VtZW50YXRpb24uXG5jb25zdCBkZWZhdWx0U3RhdGU6IENvbW1lbnRzU3RhdGUgPSB7XG4gIGNvbW1lbnRCeUlkOiB7fSxcbiAgYnlJZDoge30sXG4gIHRvdGFsQ29tbWVudHNCeUlkOiB7fSxcbiAgcmVwbGllc0J5UGFyZW50SWQ6IHt9LFxuICByZXBsaWVzVG90YWxQYWdlc0J5UGFyZW50SWQ6IHt9LFxuICB0b3BMZXZlbENvbW1lbnRzQnlJZDoge30sXG4gIHRvcExldmVsVG90YWxQYWdlc0J5SWQ6IHt9LFxuICB0b3BMZXZlbFRvdGFsQ29tbWVudHNCeUlkOiB7fSxcbiAgLy8gVE9ETzpcbiAgLy8gUmVtb3ZlIGNvbW1lbnRzQnlVcmlcbiAgLy8gSXQgaXMgbm90IG5lZWRlZCBhbmQgZG9lc24ndCBwcm92aWRlIGFueXRoaW5nIGJ1dCBjb25mdXNpb25cbiAgY29tbWVudHNCeVVyaToge30sIC8vIFVSSSAtPiBjbGFpbUlkXG4gIGZldGNoZWRDb21tZW50QW5jZXN0b3JzOiB7fSxcbiAgc3VwZXJDaGF0c0J5VXJpOiB7fSxcbiAgcGlubmVkQ29tbWVudHNCeUlkOiB7fSxcbiAgaXNMb2FkaW5nOiBmYWxzZSxcbiAgaXNMb2FkaW5nQnlJZDogZmFsc2UsXG4gIGlzTG9hZGluZ0J5UGFyZW50SWQ6IHt9LFxuICBpc0NvbW1lbnRpbmc6IGZhbHNlLFxuICBteUNvbW1lbnRzOiB1bmRlZmluZWQsXG4gIGlzRmV0Y2hpbmdSZWFjdHM6IGZhbHNlLFxuICBwZW5kaW5nQ29tbWVudFJlYWN0aW9uczogW10sXG4gIHR5cGVzUmVhY3Rpbmc6IFtdLFxuICBteVJlYWN0c0J5Q29tbWVudElkOiB1bmRlZmluZWQsXG4gIG90aGVyc1JlYWN0c0J5Q29tbWVudElkOiB1bmRlZmluZWQsXG4gIG1vZGVyYXRpb25CbG9ja0xpc3Q6IHVuZGVmaW5lZCxcbiAgYWRtaW5CbG9ja0xpc3Q6IHVuZGVmaW5lZCxcbiAgbW9kZXJhdG9yQmxvY2tMaXN0OiB1bmRlZmluZWQsXG4gIG1vZGVyYXRvckJsb2NrTGlzdERlbGVnYXRvcnNNYXA6IHt9LFxuICBmZXRjaGluZ01vZGVyYXRpb25CbG9ja0xpc3Q6IGZhbHNlLFxuICBtb2RlcmF0aW9uRGVsZWdhdGVzQnlJZDoge30sXG4gIGZldGNoaW5nTW9kZXJhdGlvbkRlbGVnYXRlczogZmFsc2UsXG4gIG1vZGVyYXRpb25EZWxlZ2F0b3JzQnlJZDoge30sXG4gIGZldGNoaW5nTW9kZXJhdGlvbkRlbGVnYXRvcnM6IGZhbHNlLFxuICBibG9ja2luZ0J5VXJpOiB7fSxcbiAgdW5CbG9ja2luZ0J5VXJpOiB7fSxcbiAgcGVyc29uYWxUaW1lb3V0TWFwOiB7fSxcbiAgYWRtaW5UaW1lb3V0TWFwOiB7fSxcbiAgbW9kZXJhdG9yVGltZW91dE1hcDoge30sXG4gIHRvZ2dsaW5nRm9yRGVsZWdhdG9yTWFwOiB7fSxcbiAgc2V0dGluZ3NCeUNoYW5uZWxJZDoge30sXG4gIGZldGNoaW5nU2V0dGluZ3M6IGZhbHNlLFxuICBmZXRjaGluZ0Jsb2NrZWRXb3JkczogZmFsc2UsXG4gIG15Q29tbWVudGVkQ2hhbm5lbElkc0J5SWQ6IHt9LFxufTtcblxuLy8gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuLy8gSW1tdXRhYmxlIGhlbHBlcnNcbi8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcblxuZnVuY3Rpb24gaW1tUHVzaFRvQXJyYXlJbk9iamVjdChvYmosIGtleSwgdmFsdWVUb1B1c2gpIHtcbiAgaWYgKCFvYmpba2V5XSkge1xuICAgIG9ialtrZXldID0gW3ZhbHVlVG9QdXNoXTtcbiAgfSBlbHNlIGlmICghb2JqW2tleV0uaW5jbHVkZXModmFsdWVUb1B1c2gpKSB7XG4gICAgLy8gRmlsdGVyIGR1cGxpY2F0ZXNcbiAgICBvYmpba2V5XSA9IG9ialtrZXldLmNvbmNhdCh2YWx1ZVRvUHVzaCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gaW1tQ29uY2F0VG9BcnJheUluT2JqZWN0KG9iaiwga2V5LCBhcnJheVRvTWVyZ2UpIHtcbiAgaWYgKG9ialtrZXldKSB7XG4gICAgb2JqW2tleV0gPSBvYmpba2V5XS5jb25jYXQoYXJyYXlUb01lcmdlKTtcbiAgfSBlbHNlIHtcbiAgICBvYmpba2V5XSA9IGFycmF5VG9NZXJnZTtcbiAgfVxufVxuXG5mdW5jdGlvbiBpbW1QcmVmaXhBcnJheUluT2JqZWN0KG9iaiwga2V5LCB2YWx1ZVRvSW5zZXJ0KSB7XG4gIGlmIChvYmpba2V5XSkge1xuICAgIG9ialtrZXldID0gW3ZhbHVlVG9JbnNlcnQsIC4uLm9ialtrZXldXTtcbiAgfSBlbHNlIHtcbiAgICBvYmpba2V5XSA9IFt2YWx1ZVRvSW5zZXJ0XTtcbiAgfVxufVxuXG4vLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4vLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG5cbmV4cG9ydCBkZWZhdWx0IGhhbmRsZUFjdGlvbnMoXG4gIHtcbiAgICBbQUNUSU9OUy5DT01NRU5UX0NSRUFURV9TVEFSVEVEXTogKHN0YXRlOiBDb21tZW50c1N0YXRlLCBhY3Rpb246IGFueSk6IENvbW1lbnRzU3RhdGUgPT4gKHtcbiAgICAgIC4uLnN0YXRlLFxuICAgICAgaXNDb21tZW50aW5nOiB0cnVlLFxuICAgIH0pLFxuXG4gICAgW0FDVElPTlMuQ09NTUVOVF9DUkVBVEVfRkFJTEVEXTogKHN0YXRlOiBDb21tZW50c1N0YXRlLCBhY3Rpb246IGFueSkgPT4gKHtcbiAgICAgIC4uLnN0YXRlLFxuICAgICAgaXNDb21tZW50aW5nOiBmYWxzZSxcbiAgICB9KSxcblxuICAgIFtBQ1RJT05TLkNPTU1FTlRfQ1JFQVRFX0NPTVBMRVRFRF06IChzdGF0ZTogQ29tbWVudHNTdGF0ZSwgYWN0aW9uOiBhbnkpOiBDb21tZW50c1N0YXRlID0+IHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgY29tbWVudCxcbiAgICAgICAgY2xhaW1JZCxcbiAgICAgICAgdXJpLFxuICAgICAgICBsaXZlc3RyZWFtLFxuICAgICAgfTogeyBjb21tZW50OiBDb21tZW50LCBjbGFpbUlkOiBzdHJpbmcsIHVyaTogc3RyaW5nLCBsaXZlc3RyZWFtOiBib29sZWFuIH0gPSBhY3Rpb24uZGF0YTtcblxuICAgICAgY29uc3QgY29tbWVudEJ5SWQgPSBPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS5jb21tZW50QnlJZCk7XG4gICAgICBjb25zdCBieUlkID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUuYnlJZCk7XG4gICAgICBjb25zdCB0b3RhbENvbW1lbnRzQnlJZCA9IE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLnRvdGFsQ29tbWVudHNCeUlkKTtcbiAgICAgIGNvbnN0IHRvcExldmVsQ29tbWVudHNCeUlkID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUudG9wTGV2ZWxDb21tZW50c0J5SWQpOyAvLyB3YXMgYnlJZCB7Q2xhaW1JZCAtPiBbY29tbWVudElkcy4uLl19XG4gICAgICBjb25zdCByZXBsaWVzQnlQYXJlbnRJZCA9IE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLnJlcGxpZXNCeVBhcmVudElkKTsgLy8ge1BhcmVudENvbW1lbnRJRCAtPiBbY29tbWVudElkcy4uLl0gfSBsaXN0IG9mIHJlcGx5IGNvbW1lbnRzXG4gICAgICBjb25zdCBjb21tZW50c0J5VXJpID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUuY29tbWVudHNCeVVyaSk7XG4gICAgICBjb25zdCBjb21tZW50cyA9IGJ5SWRbY2xhaW1JZF0gfHwgW107XG4gICAgICBjb25zdCBuZXdDb21tZW50SWRzID0gY29tbWVudHMuc2xpY2UoKTtcblxuICAgICAgLy8gSWYgaXQgd2FzIGNyZWF0ZWQgZHVyaW5nIGEgbGl2ZXN0cmVhbSwgbGV0IHRoZSB3ZWJzb2NrZXQgaGFuZGxlciBwZXJmb3JtIHRoZSBzdGF0ZSB1cGRhdGVcbiAgICAgIGlmICghbGl2ZXN0cmVhbSkge1xuICAgICAgICAvLyBhZGQgdGhlIGNvbW1lbnQgYnkgaXRzIElEXG4gICAgICAgIGNvbW1lbnRCeUlkW2NvbW1lbnQuY29tbWVudF9pZF0gPSBjb21tZW50O1xuXG4gICAgICAgIC8vIHB1c2ggdGhlIGNvbW1lbnRfaWQgdG8gdGhlIHRvcCBvZiBJRCBsaXN0XG4gICAgICAgIG5ld0NvbW1lbnRJZHMudW5zaGlmdChjb21tZW50LmNvbW1lbnRfaWQpO1xuICAgICAgICBieUlkW2NsYWltSWRdID0gbmV3Q29tbWVudElkcztcblxuICAgICAgICBpZiAodG90YWxDb21tZW50c0J5SWQuaGFzT3duUHJvcGVydHkoY2xhaW1JZCkpIHtcbiAgICAgICAgICB0b3RhbENvbW1lbnRzQnlJZFtjbGFpbUlkXSArPSAxO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNvbW1lbnRbJ3BhcmVudF9pZCddKSB7XG4gICAgICAgICAgaWYgKCFyZXBsaWVzQnlQYXJlbnRJZFtjb21tZW50LnBhcmVudF9pZF0pIHtcbiAgICAgICAgICAgIHJlcGxpZXNCeVBhcmVudElkW2NvbW1lbnQucGFyZW50X2lkXSA9IFtjb21tZW50LmNvbW1lbnRfaWRdO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXBsaWVzQnlQYXJlbnRJZFtjb21tZW50LnBhcmVudF9pZF0udW5zaGlmdChjb21tZW50LmNvbW1lbnRfaWQpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgcGFyZW50J3MgXCJyZXBsaWVzXCIgdmFsdWVcbiAgICAgICAgICBpZiAoY29tbWVudEJ5SWRbY29tbWVudC5wYXJlbnRfaWRdKSB7XG4gICAgICAgICAgICBjb21tZW50QnlJZFtjb21tZW50LnBhcmVudF9pZF0ucmVwbGllcyA9IChjb21tZW50QnlJZFtjb21tZW50LnBhcmVudF9pZF0ucmVwbGllcyB8fCAwKSArIDE7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmICghdG9wTGV2ZWxDb21tZW50c0J5SWRbY2xhaW1JZF0pIHtcbiAgICAgICAgICAgIGNvbW1lbnRzQnlVcmlbdXJpXSA9IGNsYWltSWQ7XG4gICAgICAgICAgICB0b3BMZXZlbENvbW1lbnRzQnlJZFtjbGFpbUlkXSA9IFtjb21tZW50LmNvbW1lbnRfaWRdO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0b3BMZXZlbENvbW1lbnRzQnlJZFtjbGFpbUlkXS51bnNoaWZ0KGNvbW1lbnQuY29tbWVudF9pZCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGxldCBteUNvbW1lbnRlZENoYW5uZWxJZHNCeUlkO1xuICAgICAgY29uc3QgY29tbWVudGVkQ2hhbm5lbElkcyA9IChzdGF0ZS5teUNvbW1lbnRlZENoYW5uZWxJZHNCeUlkW2NsYWltSWRdIHx8IFtdKS5zbGljZSgpO1xuICAgICAgaWYgKCFjb21tZW50ZWRDaGFubmVsSWRzLmluY2x1ZGVzKGNvbW1lbnQuY2hhbm5lbF9pZCkpIHtcbiAgICAgICAgY29tbWVudGVkQ2hhbm5lbElkcy5wdXNoKGNvbW1lbnQuY2hhbm5lbF9pZCk7XG4gICAgICAgIG15Q29tbWVudGVkQ2hhbm5lbElkc0J5SWQgPSB7XG4gICAgICAgICAgLi4uc3RhdGUubXlDb21tZW50ZWRDaGFubmVsSWRzQnlJZCxcbiAgICAgICAgICBbY2xhaW1JZF06IGNvbW1lbnRlZENoYW5uZWxJZHMsXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLnN0YXRlLFxuICAgICAgICB0b3BMZXZlbENvbW1lbnRzQnlJZCxcbiAgICAgICAgcmVwbGllc0J5UGFyZW50SWQsXG4gICAgICAgIGNvbW1lbnRCeUlkLFxuICAgICAgICBieUlkLFxuICAgICAgICB0b3RhbENvbW1lbnRzQnlJZCxcbiAgICAgICAgY29tbWVudHNCeVVyaSxcbiAgICAgICAgaXNMb2FkaW5nOiBmYWxzZSxcbiAgICAgICAgaXNDb21tZW50aW5nOiBmYWxzZSxcbiAgICAgICAgbXlDb21tZW50ZWRDaGFubmVsSWRzQnlJZDogbXlDb21tZW50ZWRDaGFubmVsSWRzQnlJZCB8fCBzdGF0ZS5teUNvbW1lbnRlZENoYW5uZWxJZHNCeUlkLFxuICAgICAgfTtcbiAgICB9LFxuXG4gICAgW0FDVElPTlMuQ09NTUVOVF9SRUFDVElPTl9MSVNUX1NUQVJURURdOiAoc3RhdGU6IENvbW1lbnRzU3RhdGUsIGFjdGlvbjogYW55KTogQ29tbWVudHNTdGF0ZSA9PiAoe1xuICAgICAgLi4uc3RhdGUsXG4gICAgICBpc0ZldGNoaW5nUmVhY3RzOiB0cnVlLFxuICAgIH0pLFxuXG4gICAgW0FDVElPTlMuQ09NTUVOVF9SRUFDVElPTl9MSVNUX0ZBSUxFRF06IChzdGF0ZTogQ29tbWVudHNTdGF0ZSwgYWN0aW9uOiBhbnkpID0+ICh7XG4gICAgICAuLi5zdGF0ZSxcbiAgICAgIGlzRmV0Y2hpbmdSZWFjdHM6IGZhbHNlLFxuICAgIH0pLFxuXG4gICAgW0FDVElPTlMuQ09NTUVOVF9SRUFDVF9GQUlMRURdOiAoc3RhdGU6IENvbW1lbnRzU3RhdGUsIGFjdGlvbjogYW55KTogQ29tbWVudHNTdGF0ZSA9PiB7XG4gICAgICBjb25zdCBjb21tZW50UmVhY3Rpb24gPSBhY3Rpb24uZGF0YTsgLy8gU3RyaW5nOiByZWFjdGlvbkhhc2ggKyB0eXBlXG4gICAgICBjb25zdCBuZXdSZWFjdGluZ1R5cGVzID0gbmV3IFNldChzdGF0ZS5wZW5kaW5nQ29tbWVudFJlYWN0aW9ucyk7XG4gICAgICBuZXdSZWFjdGluZ1R5cGVzLmRlbGV0ZShjb21tZW50UmVhY3Rpb24pO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5zdGF0ZSxcbiAgICAgICAgcGVuZGluZ0NvbW1lbnRSZWFjdGlvbnM6IEFycmF5LmZyb20obmV3UmVhY3RpbmdUeXBlcyksXG4gICAgICB9O1xuICAgIH0sXG5cbiAgICBbQUNUSU9OUy5DT01NRU5UX1JFQUNUX1NUQVJURURdOiAoc3RhdGU6IENvbW1lbnRzU3RhdGUsIGFjdGlvbjogYW55KTogQ29tbWVudHNTdGF0ZSA9PiB7XG4gICAgICBjb25zdCBjb21tZW50UmVhY3Rpb24gPSBhY3Rpb24uZGF0YTtcbiAgICAgIGNvbnN0IG5ld1JlYWN0aW5nVHlwZXMgPSBuZXcgU2V0KHN0YXRlLnBlbmRpbmdDb21tZW50UmVhY3Rpb25zKTtcbiAgICAgIG5ld1JlYWN0aW5nVHlwZXMuYWRkKGNvbW1lbnRSZWFjdGlvbik7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLnN0YXRlLFxuICAgICAgICBwZW5kaW5nQ29tbWVudFJlYWN0aW9uczogQXJyYXkuZnJvbShuZXdSZWFjdGluZ1R5cGVzKSxcbiAgICAgIH07XG4gICAgfSxcblxuICAgIFtBQ1RJT05TLkNPTU1FTlRfUkVBQ1RfQ09NUExFVEVEXTogKHN0YXRlOiBDb21tZW50c1N0YXRlLCBhY3Rpb246IGFueSk6IENvbW1lbnRzU3RhdGUgPT4ge1xuICAgICAgY29uc3QgY29tbWVudFJlYWN0aW9uID0gYWN0aW9uLmRhdGE7IC8vIFN0cmluZzogcmVhY3Rpb25IYXNoICsgdHlwZVxuICAgICAgY29uc3QgbmV3UmVhY3RpbmdUeXBlcyA9IG5ldyBTZXQoc3RhdGUucGVuZGluZ0NvbW1lbnRSZWFjdGlvbnMpO1xuICAgICAgbmV3UmVhY3RpbmdUeXBlcy5kZWxldGUoY29tbWVudFJlYWN0aW9uKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgIHBlbmRpbmdDb21tZW50UmVhY3Rpb25zOiBBcnJheS5mcm9tKG5ld1JlYWN0aW5nVHlwZXMpLFxuICAgICAgfTtcbiAgICB9LFxuXG4gICAgW0FDVElPTlMuQ09NTUVOVF9SRUFDVElPTl9MSVNUX0NPTVBMRVRFRF06IChzdGF0ZTogQ29tbWVudHNTdGF0ZSwgYWN0aW9uOiBhbnkpOiBDb21tZW50c1N0YXRlID0+IHtcbiAgICAgIGNvbnN0IHsgbXlSZWFjdGlvbnMsIG90aGVyc1JlYWN0aW9ucywgY2hhbm5lbElkLCBjb21tZW50SWRzIH0gPSBhY3Rpb24uZGF0YTtcbiAgICAgIGNvbnN0IG15UmVhY3RzID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUubXlSZWFjdHNCeUNvbW1lbnRJZCk7XG4gICAgICBjb25zdCBvdGhlcnNSZWFjdHMgPSBPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS5vdGhlcnNSZWFjdHNCeUNvbW1lbnRJZCk7XG5cbiAgICAgIGNvbnN0IG15UmVhY3Rpb25zRW50cmllcyA9IG15UmVhY3Rpb25zID8gT2JqZWN0LmVudHJpZXMobXlSZWFjdGlvbnMpIDogW107XG4gICAgICBjb25zdCBvdGhlcnNSZWFjdGlvbnNFbnRyaWVzID0gb3RoZXJzUmVhY3Rpb25zID8gT2JqZWN0LmVudHJpZXMob3RoZXJzUmVhY3Rpb25zKSA6IFtdO1xuXG4gICAgICBpZiAobXlSZWFjdGlvbnNFbnRyaWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgbXlSZWFjdGlvbnNFbnRyaWVzLmZvckVhY2goKFtjb21tZW50SWQsIHJlYWN0aW9uc10pID0+IHtcbiAgICAgICAgICBjb25zdCBrZXkgPSBjaGFubmVsSWQgPyBgJHtjb21tZW50SWR9OiR7Y2hhbm5lbElkfWAgOiBjb21tZW50SWQ7XG4gICAgICAgICAgbXlSZWFjdHNba2V5XSA9IE9iamVjdC5lbnRyaWVzKHJlYWN0aW9ucykucmVkdWNlKChhY2MsIFtuYW1lLCBjb3VudF0pID0+IHtcbiAgICAgICAgICAgIGlmIChjb3VudCA9PT0gMSkge1xuICAgICAgICAgICAgICBhY2MucHVzaChuYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBhY2M7XG4gICAgICAgICAgfSwgW10pO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbW1lbnRJZHMuZm9yRWFjaCgoY29tbWVudElkKSA9PiB7XG4gICAgICAgICAgY29uc3Qga2V5ID0gY2hhbm5lbElkID8gYCR7Y29tbWVudElkfToke2NoYW5uZWxJZH1gIDogY29tbWVudElkO1xuICAgICAgICAgIG15UmVhY3RzW2tleV0gPSBbXTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChvdGhlcnNSZWFjdGlvbnNFbnRyaWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgb3RoZXJzUmVhY3Rpb25zRW50cmllcy5mb3JFYWNoKChbY29tbWVudElkLCByZWFjdGlvbnNdKSA9PiB7XG4gICAgICAgICAgY29uc3Qga2V5ID0gY2hhbm5lbElkID8gYCR7Y29tbWVudElkfToke2NoYW5uZWxJZH1gIDogY29tbWVudElkO1xuICAgICAgICAgIG90aGVyc1JlYWN0c1trZXldID0gcmVhY3Rpb25zO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbW1lbnRJZHMuZm9yRWFjaCgoY29tbWVudElkKSA9PiB7XG4gICAgICAgICAgY29uc3Qga2V5ID0gY2hhbm5lbElkID8gYCR7Y29tbWVudElkfToke2NoYW5uZWxJZH1gIDogY29tbWVudElkO1xuICAgICAgICAgIG90aGVyc1JlYWN0c1trZXldID0ge307XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5zdGF0ZSxcbiAgICAgICAgaXNGZXRjaGluZ1JlYWN0czogZmFsc2UsXG4gICAgICAgIG15UmVhY3RzQnlDb21tZW50SWQ6IG15UmVhY3RzLFxuICAgICAgICBvdGhlcnNSZWFjdHNCeUNvbW1lbnRJZDogb3RoZXJzUmVhY3RzLFxuICAgICAgfTtcbiAgICB9LFxuXG4gICAgW0FDVElPTlMuQ09NTUVOVF9MSVNUX1NUQVJURURdOiAoc3RhdGUsIGFjdGlvbjogYW55KSA9PiB7XG4gICAgICBjb25zdCB7IHBhcmVudElkIH0gPSBhY3Rpb24uZGF0YTtcbiAgICAgIGNvbnN0IGlzTG9hZGluZ0J5UGFyZW50SWQgPSBPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS5pc0xvYWRpbmdCeVBhcmVudElkKTtcbiAgICAgIGlmIChwYXJlbnRJZCkge1xuICAgICAgICBpc0xvYWRpbmdCeVBhcmVudElkW3BhcmVudElkXSA9IHRydWU7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLnN0YXRlLFxuICAgICAgICBpc0xvYWRpbmc6IHRydWUsXG4gICAgICAgIGlzTG9hZGluZ0J5UGFyZW50SWQsXG4gICAgICB9O1xuICAgIH0sXG5cbiAgICBbQUNUSU9OUy5DT01NRU5UX0xJU1RfQ09NUExFVEVEXTogKHN0YXRlOiBDb21tZW50c1N0YXRlLCBhY3Rpb246IGFueSkgPT4ge1xuICAgICAgY29uc3Qge1xuICAgICAgICBjb21tZW50cyxcbiAgICAgICAgcGFyZW50SWQsXG4gICAgICAgIHRvdGFsSXRlbXMsXG4gICAgICAgIHRvdGFsRmlsdGVyZWRJdGVtcyxcbiAgICAgICAgdG90YWxQYWdlcyxcbiAgICAgICAgY2xhaW1JZCxcbiAgICAgICAgdXJpLFxuICAgICAgICBkaXNhYmxlZCxcbiAgICAgICAgY3JlYXRvckNsYWltSWQsXG4gICAgICAgIC8vIHJlc3RyaWN0ZWRUb01lbWJlcnNPbmx5LFxuICAgICAgfSA9IGFjdGlvbi5kYXRhO1xuXG4gICAgICBjb25zdCBjb21tZW50QnlJZCA9IE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLmNvbW1lbnRCeUlkKTtcbiAgICAgIGNvbnN0IGJ5SWQgPSBPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS5ieUlkKTtcbiAgICAgIGNvbnN0IHRvcExldmVsQ29tbWVudHNCeUlkID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUudG9wTGV2ZWxDb21tZW50c0J5SWQpOyAvLyB3YXMgYnlJZCB7Q2xhaW1JZCAtPiBbY29tbWVudElkcy4uLl19XG4gICAgICBjb25zdCB0b3BMZXZlbFRvdGFsQ29tbWVudHNCeUlkID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUudG9wTGV2ZWxUb3RhbENvbW1lbnRzQnlJZCk7XG4gICAgICBjb25zdCB0b3BMZXZlbFRvdGFsUGFnZXNCeUlkID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUudG9wTGV2ZWxUb3RhbFBhZ2VzQnlJZCk7XG4gICAgICBjb25zdCBjb21tZW50c0J5VXJpID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUuY29tbWVudHNCeVVyaSk7XG4gICAgICBjb25zdCByZXBsaWVzQnlQYXJlbnRJZCA9IE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLnJlcGxpZXNCeVBhcmVudElkKTtcbiAgICAgIGNvbnN0IHRvdGFsQ29tbWVudHNCeUlkID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUudG90YWxDb21tZW50c0J5SWQpO1xuICAgICAgY29uc3QgcGlubmVkQ29tbWVudHNCeUlkID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUucGlubmVkQ29tbWVudHNCeUlkKTtcbiAgICAgIGNvbnN0IHJlcGxpZXNUb3RhbFBhZ2VzQnlQYXJlbnRJZCA9IE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLnJlcGxpZXNUb3RhbFBhZ2VzQnlQYXJlbnRJZCk7XG4gICAgICBjb25zdCBpc0xvYWRpbmdCeVBhcmVudElkID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUuaXNMb2FkaW5nQnlQYXJlbnRJZCk7XG4gICAgICBjb25zdCBzZXR0aW5nc0J5Q2hhbm5lbElkID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUuc2V0dGluZ3NCeUNoYW5uZWxJZCk7XG5cbiAgICAgIC8vIHNhdmUgYW4gYXJyYXkgb2YgY2xhaW0gaWRzIG9mIG1lbWJlcnMtb25seSBjaGF0cyB0byBjaGVjayBkdXJpbmcgbGlzdFxuICAgICAgbGV0IG1lbWJlcnNPbmx5Q2hhdHMgPSBzZXR0aW5nc0J5Q2hhbm5lbElkW2NyZWF0b3JDbGFpbUlkXT8ubGl2ZXN0cmVhbV9jaGF0X21lbWJlcnNfb25seSB8fCBmYWxzZTtcbiAgICAgIC8vIGlmIChyZXN0cmljdGVkVG9NZW1iZXJzT25seSkge1xuICAgICAgLy8gICBtZW1iZXJzT25seUNoYXRzLnB1c2goY2xhaW1JZCk7XG4gICAgICAvLyB9XG5cbiAgICAgIHNldHRpbmdzQnlDaGFubmVsSWRbY3JlYXRvckNsYWltSWRdID0ge1xuICAgICAgICAuLi4oc2V0dGluZ3NCeUNoYW5uZWxJZFtjcmVhdG9yQ2xhaW1JZF0gfHwge30pLFxuICAgICAgICAvLyBjb21tZW50c19lbmFibGVkOiAhZGlzYWJsZWQsXG4gICAgICAgIGxpdmVzdHJlYW1fY2hhdF9tZW1iZXJzX29ubHk6IG1lbWJlcnNPbmx5Q2hhdHMsXG4gICAgICB9O1xuXG4gICAgICBpZiAocGFyZW50SWQpIHtcbiAgICAgICAgaXNMb2FkaW5nQnlQYXJlbnRJZFtwYXJlbnRJZF0gPSBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFkaXNhYmxlZCkge1xuICAgICAgICBpZiAocGFyZW50SWQpIHtcbiAgICAgICAgICByZXBsaWVzVG90YWxQYWdlc0J5UGFyZW50SWRbcGFyZW50SWRdID0gdG90YWxQYWdlcztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0b3RhbENvbW1lbnRzQnlJZFtjbGFpbUlkXSA9IHRvdGFsSXRlbXM7XG4gICAgICAgICAgdG9wTGV2ZWxUb3RhbENvbW1lbnRzQnlJZFtjbGFpbUlkXSA9IHRvdGFsRmlsdGVyZWRJdGVtcztcbiAgICAgICAgICB0b3BMZXZlbFRvdGFsUGFnZXNCeUlkW2NsYWltSWRdID0gdG90YWxQYWdlcztcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNvbW1vblVwZGF0ZUFjdGlvbiA9IChjb21tZW50LCBjb21tZW50QnlJZCwgY29tbWVudElkcywgaW5kZXgpID0+IHtcbiAgICAgICAgICAvLyBtYXAgdGhlIGNvbW1lbnRfaWRzIHRvIHRoZSBuZXcgY29tbWVudHNcbiAgICAgICAgICBjb21tZW50QnlJZFtjb21tZW50LmNvbW1lbnRfaWRdID0gY29tbWVudDtcbiAgICAgICAgICBjb21tZW50SWRzW2luZGV4XSA9IGNvbW1lbnQuY29tbWVudF9pZDtcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAoY29tbWVudHMpIHtcbiAgICAgICAgICAvLyB3ZSB1c2UgYW4gQXJyYXkgdG8gcHJlc2VydmUgb3JkZXIgb2YgbGlzdGluZ1xuICAgICAgICAgIC8vIGluIHJlYWxpdHkgdGhpcyBkb2Vzbid0IG1hdHRlciBhbmQgd2UgY2FuIGp1c3RcbiAgICAgICAgICAvLyBzb3J0IGNvbW1lbnRzIGJ5IHRoZWlyIHRpbWVzdGFtcFxuICAgICAgICAgIGNvbnN0IGNvbW1lbnRJZHMgPSBBcnJheShjb21tZW50cy5sZW5ndGgpO1xuXG4gICAgICAgICAgLy8gLS0tIFRvcC1sZXZlbCBjb21tZW50cyAtLS1cbiAgICAgICAgICBpZiAoIXBhcmVudElkKSB7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbW1lbnRzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICAgIGNvbnN0IGNvbW1lbnQgPSBjb21tZW50c1tpXTtcbiAgICAgICAgICAgICAgY29tbW9uVXBkYXRlQWN0aW9uKGNvbW1lbnQsIGNvbW1lbnRCeUlkLCBjb21tZW50SWRzLCBpKTtcbiAgICAgICAgICAgICAgaWYgKGNvbW1lbnQuaXNfcGlubmVkKSB7XG4gICAgICAgICAgICAgICAgaW1tUHVzaFRvQXJyYXlJbk9iamVjdChwaW5uZWRDb21tZW50c0J5SWQsIGNsYWltSWQsIGNvbW1lbnQuY29tbWVudF9pZCk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaW1tUHVzaFRvQXJyYXlJbk9iamVjdCh0b3BMZXZlbENvbW1lbnRzQnlJZCwgY2xhaW1JZCwgY29tbWVudC5jb21tZW50X2lkKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICAvLyAtLS0gUmVwbGllcyAtLS1cbiAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY29tbWVudHMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgICAgY29uc3QgY29tbWVudCA9IGNvbW1lbnRzW2ldO1xuICAgICAgICAgICAgICBjb21tb25VcGRhdGVBY3Rpb24oY29tbWVudCwgY29tbWVudEJ5SWQsIGNvbW1lbnRJZHMsIGkpO1xuICAgICAgICAgICAgICBpbW1QdXNoVG9BcnJheUluT2JqZWN0KHJlcGxpZXNCeVBhcmVudElkLCBwYXJlbnRJZCwgY29tbWVudC5jb21tZW50X2lkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpbW1Db25jYXRUb0FycmF5SW5PYmplY3QoYnlJZCwgY2xhaW1JZCwgY29tbWVudElkcyk7XG4gICAgICAgICAgY29tbWVudHNCeVVyaVt1cmldID0gY2xhaW1JZDtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5zdGF0ZSxcbiAgICAgICAgdG9wTGV2ZWxDb21tZW50c0J5SWQsXG4gICAgICAgIHRvcExldmVsVG90YWxDb21tZW50c0J5SWQsXG4gICAgICAgIHRvcExldmVsVG90YWxQYWdlc0J5SWQsXG4gICAgICAgIHJlcGxpZXNCeVBhcmVudElkLFxuICAgICAgICB0b3RhbENvbW1lbnRzQnlJZCxcbiAgICAgICAgcGlubmVkQ29tbWVudHNCeUlkLFxuICAgICAgICByZXBsaWVzVG90YWxQYWdlc0J5UGFyZW50SWQsXG4gICAgICAgIGJ5SWQsXG4gICAgICAgIGNvbW1lbnRCeUlkLFxuICAgICAgICBjb21tZW50c0J5VXJpLFxuICAgICAgICBpc0xvYWRpbmc6IGZhbHNlLFxuICAgICAgICBpc0xvYWRpbmdCeVBhcmVudElkLFxuICAgICAgICBzZXR0aW5nc0J5Q2hhbm5lbElkLFxuICAgICAgfTtcbiAgICB9LFxuXG4gICAgW0FDVElPTlMuQ09NTUVOVF9CWV9JRF9TVEFSVEVEXTogKHN0YXRlKSA9PiAoeyAuLi5zdGF0ZSwgaXNMb2FkaW5nQnlJZDogdHJ1ZSB9KSxcblxuICAgIFtBQ1RJT05TLkNPTU1FTlRfQllfSURfQ09NUExFVEVEXTogKHN0YXRlOiBDb21tZW50c1N0YXRlLCBhY3Rpb246IGFueSkgPT4ge1xuICAgICAgY29uc3QgeyBjb21tZW50LCBhbmNlc3RvcnMgfSA9IGFjdGlvbi5kYXRhO1xuICAgICAgY29uc3QgY2xhaW1JZCA9IGNvbW1lbnQuY2xhaW1faWQ7XG5cbiAgICAgIGNvbnN0IGNvbW1lbnRCeUlkID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUuY29tbWVudEJ5SWQpO1xuICAgICAgY29uc3QgYnlJZCA9IE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLmJ5SWQpO1xuICAgICAgY29uc3QgdG9wTGV2ZWxDb21tZW50c0J5SWQgPSBPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS50b3BMZXZlbENvbW1lbnRzQnlJZCk7IC8vIHdhcyBieUlkIHtDbGFpbUlkIC0+IFtjb21tZW50SWRzLi4uXX1cbiAgICAgIGNvbnN0IHRvcExldmVsVG90YWxDb21tZW50c0J5SWQgPSBPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS50b3BMZXZlbFRvdGFsQ29tbWVudHNCeUlkKTtcbiAgICAgIGNvbnN0IHRvcExldmVsVG90YWxQYWdlc0J5SWQgPSBPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS50b3BMZXZlbFRvdGFsUGFnZXNCeUlkKTtcbiAgICAgIGNvbnN0IHBpbm5lZENvbW1lbnRzQnlJZCA9IE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLnBpbm5lZENvbW1lbnRzQnlJZCk7XG4gICAgICBjb25zdCByZXBsaWVzQnlQYXJlbnRJZCA9IE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLnJlcGxpZXNCeVBhcmVudElkKTtcbiAgICAgIGNvbnN0IGZldGNoZWRDb21tZW50QW5jZXN0b3JzID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUuZmV0Y2hlZENvbW1lbnRBbmNlc3RvcnMpO1xuXG4gICAgICBjb25zdCB1cGRhdGVTdG9yZSA9IChjb21tZW50LCBjb21tZW50QnlJZCwgYnlJZCwgcmVwbGllc0J5UGFyZW50SWQsIHRvcExldmVsQ29tbWVudHNCeUlkKSA9PiB7XG4gICAgICAgIGNvbW1lbnRCeUlkW2NvbW1lbnQuY29tbWVudF9pZF0gPSBjb21tZW50O1xuICAgICAgICBpbW1QcmVmaXhBcnJheUluT2JqZWN0KGJ5SWQsIGNsYWltSWQsIGNvbW1lbnQuY29tbWVudF9pZCk7XG5cbiAgICAgICAgY29uc3QgcGFyZW50SWQgPSBjb21tZW50LnBhcmVudF9pZDtcbiAgICAgICAgaWYgKGNvbW1lbnQucGFyZW50X2lkKSB7XG4gICAgICAgICAgaW1tUHVzaFRvQXJyYXlJbk9iamVjdChyZXBsaWVzQnlQYXJlbnRJZCwgcGFyZW50SWQsIGNvbW1lbnQuY29tbWVudF9pZCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKGNvbW1lbnQuaXNfcGlubmVkKSB7XG4gICAgICAgICAgICBpbW1QdXNoVG9BcnJheUluT2JqZWN0KHBpbm5lZENvbW1lbnRzQnlJZCwgY2xhaW1JZCwgY29tbWVudC5jb21tZW50X2lkKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaW1tUHVzaFRvQXJyYXlJbk9iamVjdCh0b3BMZXZlbENvbW1lbnRzQnlJZCwgY2xhaW1JZCwgY29tbWVudC5jb21tZW50X2lkKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIHVwZGF0ZVN0b3JlKGNvbW1lbnQsIGNvbW1lbnRCeUlkLCBieUlkLCByZXBsaWVzQnlQYXJlbnRJZCwgdG9wTGV2ZWxDb21tZW50c0J5SWQpO1xuXG4gICAgICBpZiAoYW5jZXN0b3JzKSB7XG4gICAgICAgIGFuY2VzdG9ycy5mb3JFYWNoKChhbmNlc3RvcikgPT4ge1xuICAgICAgICAgIHVwZGF0ZVN0b3JlKGFuY2VzdG9yLCBjb21tZW50QnlJZCwgYnlJZCwgcmVwbGllc0J5UGFyZW50SWQsIHRvcExldmVsQ29tbWVudHNCeUlkKTtcbiAgICAgICAgICBpbW1QdXNoVG9BcnJheUluT2JqZWN0KGZldGNoZWRDb21tZW50QW5jZXN0b3JzLCBjb21tZW50LmNvbW1lbnRfaWQsIGFuY2VzdG9yLmNvbW1lbnRfaWQpO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgIGlzTG9hZGluZ0J5SWQ6IGZhbHNlLFxuICAgICAgICB0b3BMZXZlbENvbW1lbnRzQnlJZCxcbiAgICAgICAgdG9wTGV2ZWxUb3RhbENvbW1lbnRzQnlJZCxcbiAgICAgICAgdG9wTGV2ZWxUb3RhbFBhZ2VzQnlJZCxcbiAgICAgICAgcGlubmVkQ29tbWVudHNCeUlkLFxuICAgICAgICByZXBsaWVzQnlQYXJlbnRJZCxcbiAgICAgICAgYnlJZCxcbiAgICAgICAgY29tbWVudEJ5SWQsXG4gICAgICAgIGZldGNoZWRDb21tZW50QW5jZXN0b3JzLFxuICAgICAgfTtcbiAgICB9LFxuXG4gICAgW0FDVElPTlMuQ09NTUVOVF9GRVRDSF9NWV9DT01NRU5URURfQ0hBTk5FTFNfQ09NUExFVEVdOiAoc3RhdGU6IENvbW1lbnRzU3RhdGUsIGFjdGlvbjogYW55KSA9PiB7XG4gICAgICBjb25zdCB7IGNvbnRlbnRDbGFpbUlkLCBjb21tZW50ZWRDaGFubmVsSWRzIH0gPSBhY3Rpb24uZGF0YTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgIG15Q29tbWVudGVkQ2hhbm5lbElkc0J5SWQ6IHtcbiAgICAgICAgICAuLi5zdGF0ZS5teUNvbW1lbnRlZENoYW5uZWxJZHNCeUlkLFxuICAgICAgICAgIFtjb250ZW50Q2xhaW1JZF06IGNvbW1lbnRlZENoYW5uZWxJZHMsXG4gICAgICAgIH0sXG4gICAgICB9O1xuICAgIH0sXG5cbiAgICBbQUNUSU9OUy5DT01NRU5UX1NVUEVSX0NIQVRfTElTVF9GQUlMRURdOiAoc3RhdGU6IENvbW1lbnRzU3RhdGUsIGFjdGlvbjogYW55KSA9PiAoe1xuICAgICAgLi4uc3RhdGUsXG4gICAgICBpc0xvYWRpbmc6IGZhbHNlLFxuICAgIH0pLFxuICAgIFtBQ1RJT05TLkNPTU1FTlRfU1VQRVJfQ0hBVF9MSVNUX1NUQVJURURdOiAoc3RhdGUpID0+ICh7IC4uLnN0YXRlLCBpc0xvYWRpbmc6IHRydWUgfSksXG5cbiAgICBbQUNUSU9OUy5DT01NRU5UX1NVUEVSX0NIQVRfTElTVF9DT01QTEVURURdOiAoc3RhdGU6IENvbW1lbnRzU3RhdGUsIGFjdGlvbjogYW55KSA9PiB7XG4gICAgICBjb25zdCB7IGNvbW1lbnRzLCB0b3RhbEFtb3VudCwgdXJpIH0gPSBhY3Rpb24uZGF0YTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgIHN1cGVyQ2hhdHNCeVVyaToge1xuICAgICAgICAgIC4uLnN0YXRlLnN1cGVyQ2hhdHNCeVVyaSxcbiAgICAgICAgICBbdXJpXToge1xuICAgICAgICAgICAgY29tbWVudHMsXG4gICAgICAgICAgICB0b3RhbEFtb3VudCxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBpc0xvYWRpbmc6IGZhbHNlLFxuICAgICAgfTtcbiAgICB9LFxuXG4gICAgW0FDVElPTlMuQ09NTUVOVF9MSVNUX0ZBSUxFRF06IChzdGF0ZTogQ29tbWVudHNTdGF0ZSwgYWN0aW9uOiBhbnkpID0+ICh7XG4gICAgICAuLi5zdGF0ZSxcbiAgICAgIGlzTG9hZGluZzogZmFsc2UsXG4gICAgfSksXG5cbiAgICBbQUNUSU9OUy5DT01NRU5UX0xJU1RfUkVTRVRdOiAoc3RhdGU6IENvbW1lbnRzU3RhdGUsIGFjdGlvbjogYW55KSA9PiB7XG4gICAgICBjb25zdCB7IGNsYWltSWQgfSA9IGFjdGlvbi5kYXRhO1xuXG4gICAgICBjb25zdCBieUlkID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUuYnlJZCk7XG4gICAgICBjb25zdCB0b3RhbENvbW1lbnRzQnlJZCA9IE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLnRvdGFsQ29tbWVudHNCeUlkKTtcbiAgICAgIGNvbnN0IHRvcExldmVsQ29tbWVudHNCeUlkID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUudG9wTGV2ZWxDb21tZW50c0J5SWQpOyAvLyB3YXMgYnlJZCB7Q2xhaW1JZCAtPiBbY29tbWVudElkcy4uLl19XG4gICAgICBjb25zdCB0b3BMZXZlbFRvdGFsQ29tbWVudHNCeUlkID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUudG9wTGV2ZWxUb3RhbENvbW1lbnRzQnlJZCk7XG4gICAgICBjb25zdCB0b3BMZXZlbFRvdGFsUGFnZXNCeUlkID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUudG9wTGV2ZWxUb3RhbFBhZ2VzQnlJZCk7XG4gICAgICBjb25zdCBwaW5uZWRDb21tZW50c0J5SWQgPSBPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS5waW5uZWRDb21tZW50c0J5SWQpO1xuICAgICAgY29uc3QgbXlSZWFjdHMgPSBPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS5teVJlYWN0c0J5Q29tbWVudElkKTtcbiAgICAgIGNvbnN0IG90aGVyc1JlYWN0cyA9IE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLm90aGVyc1JlYWN0c0J5Q29tbWVudElkKTtcblxuICAgICAgZnVuY3Rpb24gZGVsZXRlUmVhY3RzKHJlYWN0T2JqLCBjb21tZW50SWRzVG9SZW1vdmUpIHtcbiAgICAgICAgaWYgKGNvbW1lbnRJZHNUb1JlbW92ZSAmJiBjb21tZW50SWRzVG9SZW1vdmUubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGxldCByZWFjdGlvbktleXMgPSBPYmplY3Qua2V5cyhyZWFjdE9iaik7XG4gICAgICAgICAgcmVhY3Rpb25LZXlzLmZvckVhY2goKHJrKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjb2xvbkluZGV4ID0gcmsuaW5kZXhPZignOicpO1xuICAgICAgICAgICAgY29uc3QgY29tbWVudElkID0gY29sb25JbmRleCA9PT0gLTEgPyByayA6IHJrLnN1YnN0cmluZygwLCBjb2xvbkluZGV4KTtcbiAgICAgICAgICAgIGlmIChjb21tZW50SWRzVG9SZW1vdmUuaW5jbHVkZXMoY29tbWVudElkKSkge1xuICAgICAgICAgICAgICBkZWxldGUgcmVhY3RPYmpbcmtdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGRlbGV0ZVJlYWN0cyhteVJlYWN0cywgYnlJZFtjbGFpbUlkXSk7XG4gICAgICBkZWxldGVSZWFjdHMob3RoZXJzUmVhY3RzLCBieUlkW2NsYWltSWRdKTtcblxuICAgICAgZGVsZXRlIGJ5SWRbY2xhaW1JZF07XG4gICAgICBkZWxldGUgdG90YWxDb21tZW50c0J5SWRbY2xhaW1JZF07XG4gICAgICBkZWxldGUgdG9wTGV2ZWxDb21tZW50c0J5SWRbY2xhaW1JZF07XG4gICAgICBkZWxldGUgdG9wTGV2ZWxUb3RhbENvbW1lbnRzQnlJZFtjbGFpbUlkXTtcbiAgICAgIGRlbGV0ZSB0b3BMZXZlbFRvdGFsUGFnZXNCeUlkW2NsYWltSWRdO1xuICAgICAgZGVsZXRlIHBpbm5lZENvbW1lbnRzQnlJZFtjbGFpbUlkXTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgIGJ5SWQsXG4gICAgICAgIHRvdGFsQ29tbWVudHNCeUlkLFxuICAgICAgICB0b3BMZXZlbENvbW1lbnRzQnlJZCxcbiAgICAgICAgdG9wTGV2ZWxUb3RhbENvbW1lbnRzQnlJZCxcbiAgICAgICAgdG9wTGV2ZWxUb3RhbFBhZ2VzQnlJZCxcbiAgICAgICAgcGlubmVkQ29tbWVudHNCeUlkLFxuICAgICAgICBteVJlYWN0c0J5Q29tbWVudElkOiBteVJlYWN0cyxcbiAgICAgICAgb3RoZXJzUmVhY3RzQnlDb21tZW50SWQ6IG90aGVyc1JlYWN0cyxcbiAgICAgIH07XG4gICAgfSxcblxuICAgIFtBQ1RJT05TLkNPTU1FTlRfUkVDRUlWRURdOiAoc3RhdGU6IENvbW1lbnRzU3RhdGUsIGFjdGlvbjogYW55KSA9PiB7XG4gICAgICBjb25zdCB7IHVyaSwgY2xhaW1JZCwgY29tbWVudCB9ID0gYWN0aW9uLmRhdGE7XG4gICAgICBjb25zdCBjb21tZW50c0J5VXJpID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUuY29tbWVudHNCeVVyaSk7XG4gICAgICBjb25zdCBjb21tZW50c0J5Q2xhaW1JZCA9IE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLmJ5SWQpO1xuICAgICAgY29uc3QgYWxsQ29tbWVudHNCeUlkID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUuY29tbWVudEJ5SWQpO1xuICAgICAgY29uc3QgdG9wTGV2ZWxDb21tZW50c0J5SWQgPSBPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS50b3BMZXZlbENvbW1lbnRzQnlJZCk7XG4gICAgICBjb25zdCBzdXBlckNoYXRzQnlVcmkgPSBPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS5zdXBlckNoYXRzQnlVcmkpO1xuICAgICAgY29uc3QgY29tbWVudHNGb3JJZCA9IHRvcExldmVsQ29tbWVudHNCeUlkW2NsYWltSWRdO1xuXG4gICAgICBhbGxDb21tZW50c0J5SWRbY29tbWVudC5jb21tZW50X2lkXSA9IGNvbW1lbnQ7XG4gICAgICBjb21tZW50c0J5VXJpW3VyaV0gPSBjbGFpbUlkO1xuXG4gICAgICBpZiAoY29tbWVudHNGb3JJZCkge1xuICAgICAgICBjb25zdCBuZXdDb21tZW50c0ZvcklkID0gY29tbWVudHNGb3JJZC5zbGljZSgpO1xuICAgICAgICBjb25zdCBjb21tZW50RXhpc3RzID0gbmV3Q29tbWVudHNGb3JJZC5pbmNsdWRlcyhjb21tZW50LmNvbW1lbnRfaWQpO1xuICAgICAgICBpZiAoIWNvbW1lbnRFeGlzdHMpIHtcbiAgICAgICAgICBuZXdDb21tZW50c0ZvcklkLnVuc2hpZnQoY29tbWVudC5jb21tZW50X2lkKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRvcExldmVsQ29tbWVudHNCeUlkW2NsYWltSWRdID0gbmV3Q29tbWVudHNGb3JJZDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRvcExldmVsQ29tbWVudHNCeUlkW2NsYWltSWRdID0gW2NvbW1lbnQuY29tbWVudF9pZF07XG4gICAgICB9XG5cbiAgICAgIC8vIFdlIGRvbid0IGNhcmUgdG8ga2VlcCBleGlzdGluZyBsb3dlciBsZXZlbCBjb21tZW50cyBzaW5jZSB0aGlzIGlzIGp1c3QgZm9yIGxpdmVzdHJlYW1zXG4gICAgICBjb21tZW50c0J5Q2xhaW1JZFtjbGFpbUlkXSA9IHRvcExldmVsQ29tbWVudHNCeUlkW2NsYWltSWRdO1xuXG4gICAgICBpZiAoY29tbWVudC5zdXBwb3J0X2Ftb3VudCA+IDApIHtcbiAgICAgICAgY29uc3Qgc3VwZXJDaGF0Rm9yVXJpID0gc3VwZXJDaGF0c0J5VXJpW3VyaV07XG4gICAgICAgIGNvbnN0IHN1cGVyQ2hhdENvbW1lbnRzRm9yVXJpID0gc3VwZXJDaGF0Rm9yVXJpICYmIHN1cGVyQ2hhdEZvclVyaS5jb21tZW50cztcblxuICAgICAgICBsZXQgc29ydGVkU3VwZXJDaGF0Q29tbWVudHMgPSBbXTtcbiAgICAgICAgbGV0IGhhc0FkZGVkTmV3Q29tbWVudCA9IGZhbHNlO1xuICAgICAgICBpZiAoc3VwZXJDaGF0Q29tbWVudHNGb3JVcmkgJiYgc3VwZXJDaGF0Q29tbWVudHNGb3JVcmkubGVuZ3RoID4gMCkge1xuICAgICAgICAgIC8vIEdvIGZvciB0aGUgZW50aXJlIGxlbmd0aCBvZiBzdXBlckNoYXRDb21tZW50c0ZvclVyaSBzaW5jZSBhIGNvbW1lbnQgd2lsbCBiZSBhZGRlZCB0byB0aGlzIGxpc3RcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN1cGVyQ2hhdENvbW1lbnRzRm9yVXJpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBleGlzdGluZ1N1cGVyQ2hhdCA9IHN1cGVyQ2hhdENvbW1lbnRzRm9yVXJpW2ldO1xuICAgICAgICAgICAgaWYgKGV4aXN0aW5nU3VwZXJDaGF0LnN1cHBvcnRfYW1vdW50IDwgY29tbWVudC5zdXBwb3J0X2Ftb3VudCAmJiAhaGFzQWRkZWROZXdDb21tZW50KSB7XG4gICAgICAgICAgICAgIGhhc0FkZGVkTmV3Q29tbWVudCA9IHRydWU7XG4gICAgICAgICAgICAgIHNvcnRlZFN1cGVyQ2hhdENvbW1lbnRzLnB1c2goY29tbWVudCk7XG4gICAgICAgICAgICAgIHNvcnRlZFN1cGVyQ2hhdENvbW1lbnRzLnB1c2goZXhpc3RpbmdTdXBlckNoYXQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgc29ydGVkU3VwZXJDaGF0Q29tbWVudHMucHVzaChleGlzdGluZ1N1cGVyQ2hhdCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIElmIHRoZSBuZXcgc3VwZXJjaGF0IGhhc24ndCBiZWVuIGFkZGVkIHlldCwgaXQgbXVzdCBiZSB0aGUgc21hbGxlc3Qgc3VwZXJjaGF0IGluIHRoZSBsaXN0XG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgIGkgPT09IHN1cGVyQ2hhdENvbW1lbnRzRm9yVXJpLmxlbmd0aCAtIDEgJiZcbiAgICAgICAgICAgICAgc29ydGVkU3VwZXJDaGF0Q29tbWVudHMubGVuZ3RoID09PSBzdXBlckNoYXRDb21tZW50c0ZvclVyaS5sZW5ndGhcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICBzb3J0ZWRTdXBlckNoYXRDb21tZW50cy5wdXNoKGNvbW1lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIHN1cGVyQ2hhdHNCeVVyaVt1cmldLmNvbW1lbnRzID0gc29ydGVkU3VwZXJDaGF0Q29tbWVudHM7XG4gICAgICAgICAgc3VwZXJDaGF0c0J5VXJpW3VyaV0udG90YWxBbW91bnQgKz0gY29tbWVudC5zdXBwb3J0X2Ftb3VudDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzdXBlckNoYXRzQnlVcmlbdXJpXSA9IHsgY29tbWVudHM6IFtjb21tZW50XSwgdG90YWxBbW91bnQ6IGNvbW1lbnQuc3VwcG9ydF9hbW91bnQgfTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5zdGF0ZSxcbiAgICAgICAgYnlJZDogY29tbWVudHNCeUNsYWltSWQsXG4gICAgICAgIGNvbW1lbnRCeUlkOiBhbGxDb21tZW50c0J5SWQsXG4gICAgICAgIGNvbW1lbnRzQnlVcmksXG4gICAgICAgIHRvcExldmVsQ29tbWVudHNCeUlkLFxuICAgICAgICBzdXBlckNoYXRzQnlVcmksXG4gICAgICB9O1xuICAgIH0sXG5cbiAgICBbQUNUSU9OUy5DT01NRU5UX0FCQU5ET05fU1RBUlRFRF06IChzdGF0ZTogQ29tbWVudHNTdGF0ZSwgYWN0aW9uOiBhbnkpID0+ICh7XG4gICAgICAuLi5zdGF0ZSxcbiAgICAgIGlzTG9hZGluZzogdHJ1ZSxcbiAgICB9KSxcbiAgICBbQUNUSU9OUy5DT01NRU5UX0FCQU5ET05fQ09NUExFVEVEXTogKHN0YXRlOiBDb21tZW50c1N0YXRlLCBhY3Rpb246IGFueSkgPT4ge1xuICAgICAgY29uc3QgeyBjb21tZW50X2lkIH0gPSBhY3Rpb24uZGF0YTtcbiAgICAgIGNvbnN0IGNvbW1lbnRCeUlkID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUuY29tbWVudEJ5SWQpO1xuICAgICAgY29uc3QgYnlJZCA9IE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLmJ5SWQpO1xuICAgICAgY29uc3QgcmVwbGllc0J5UGFyZW50SWQgPSBPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS5yZXBsaWVzQnlQYXJlbnRJZCk7IC8vIHtQYXJlbnRDb21tZW50SUQgLT4gW2NvbW1lbnRJZHMuLi5dIH0gbGlzdCBvZiByZXBseSBjb21tZW50c1xuICAgICAgY29uc3QgdG90YWxDb21tZW50c0J5SWQgPSBPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS50b3RhbENvbW1lbnRzQnlJZCk7XG5cbiAgICAgIGNvbnN0IGNvbW1lbnQgPSBjb21tZW50QnlJZFtjb21tZW50X2lkXTtcblxuICAgICAgLy8gdG8gcmVtb3ZlIHRoZSBjb21tZW50IGFuZCBpdHMgcmVmZXJlbmNlc1xuICAgICAgY29uc3QgY2xhaW1JZCA9IGNvbW1lbnQuY2xhaW1faWQ7XG5cbiAgICAgIGlmIChieUlkW2NsYWltSWRdKSB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYnlJZFtjbGFpbUlkXS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGlmIChieUlkW2NsYWltSWRdW2ldID09PSBjb21tZW50X2lkKSB7XG4gICAgICAgICAgICAvLyBpbW11dGFibGUgdXBkYXRlXG4gICAgICAgICAgICBieUlkW2NsYWltSWRdID0gQXJyYXkuZnJvbShieUlkW2NsYWltSWRdKTtcbiAgICAgICAgICAgIGJ5SWRbY2xhaW1JZF0uc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIFVwZGF0ZSByZXBsaWVzXG4gICAgICBpZiAoY29tbWVudFsncGFyZW50X2lkJ10gJiYgcmVwbGllc0J5UGFyZW50SWRbY29tbWVudC5wYXJlbnRfaWRdKSB7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gcmVwbGllc0J5UGFyZW50SWRbY29tbWVudC5wYXJlbnRfaWRdLmluZGV4T2YoY29tbWVudC5jb21tZW50X2lkKTtcbiAgICAgICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgICAgICByZXBsaWVzQnlQYXJlbnRJZFtjb21tZW50LnBhcmVudF9pZF0uc3BsaWNlKGluZGV4LCAxKTtcblxuICAgICAgICAgIGlmIChjb21tZW50QnlJZFtjb21tZW50LnBhcmVudF9pZF0pIHtcbiAgICAgICAgICAgIGNvbW1lbnRCeUlkW2NvbW1lbnQucGFyZW50X2lkXS5yZXBsaWVzID0gTWF0aC5tYXgoMCwgKGNvbW1lbnRCeUlkW2NvbW1lbnQucGFyZW50X2lkXS5yZXBsaWVzIHx8IDApIC0gMSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmICh0b3RhbENvbW1lbnRzQnlJZC5oYXNPd25Qcm9wZXJ0eShjbGFpbUlkKSkge1xuICAgICAgICB0b3RhbENvbW1lbnRzQnlJZFtjbGFpbUlkXSA9IE1hdGgubWF4KDAsIHRvdGFsQ29tbWVudHNCeUlkW2NsYWltSWRdIC0gMSk7XG4gICAgICB9XG5cbiAgICAgIGRlbGV0ZSBjb21tZW50QnlJZFtjb21tZW50X2lkXTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgIGNvbW1lbnRCeUlkLFxuICAgICAgICBieUlkLFxuICAgICAgICB0b3RhbENvbW1lbnRzQnlJZCxcbiAgICAgICAgcmVwbGllc0J5UGFyZW50SWQsXG4gICAgICAgIGlzTG9hZGluZzogZmFsc2UsXG4gICAgICB9O1xuICAgIH0sXG5cbiAgICBbQUNUSU9OUy5DT01NRU5UX0FCQU5ET05fRkFJTEVEXTogKHN0YXRlOiBDb21tZW50c1N0YXRlLCBhY3Rpb246IGFueSkgPT4gKHtcbiAgICAgIC4uLnN0YXRlLFxuICAgICAgaXNDb21tZW50aW5nOiBmYWxzZSxcbiAgICB9KSxcbiAgICBbQUNUSU9OUy5DT01NRU5UX1VQREFURV9TVEFSVEVEXTogKHN0YXRlOiBDb21tZW50c1N0YXRlLCBhY3Rpb246IGFueSkgPT4gKHtcbiAgICAgIC4uLnN0YXRlLFxuICAgICAgaXNDb21tZW50aW5nOiB0cnVlLFxuICAgIH0pLFxuICAgIFtBQ1RJT05TLkNPTU1FTlRfVVBEQVRFX0NPTVBMRVRFRF06IChzdGF0ZTogQ29tbWVudHNTdGF0ZSwgYWN0aW9uOiBhbnkpID0+IHtcbiAgICAgIGNvbnN0IHsgY29tbWVudCB9ID0gYWN0aW9uLmRhdGE7XG4gICAgICBjb25zdCBjb21tZW50QnlJZCA9IE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLmNvbW1lbnRCeUlkKTtcbiAgICAgIGNvbW1lbnRCeUlkW2NvbW1lbnQuY29tbWVudF9pZF0gPSBjb21tZW50O1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5zdGF0ZSxcbiAgICAgICAgY29tbWVudEJ5SWQsXG4gICAgICAgIGlzQ29tbWVudGluZzogZmFsc2UsXG4gICAgICB9O1xuICAgIH0sXG4gICAgW0FDVElPTlMuQ09NTUVOVF9VUERBVEVfRkFJTEVEXTogKHN0YXRlOiBDb21tZW50c1N0YXRlLCBhY3Rpb246IGFueSkgPT4gKHtcbiAgICAgIC4uLnN0YXRlLFxuICAgICAgaXNDbW1lbnRpbmc6IGZhbHNlLFxuICAgIH0pLFxuXG4gICAgW0FDVElPTlMuQ09NTUVOVF9QSU5fQ09NUExFVEVEXTogKHN0YXRlOiBDb21tZW50c1N0YXRlLCBhY3Rpb246IGFueSkgPT4ge1xuICAgICAgY29uc3QgeyBwaW5uZWRDb21tZW50LCBjbGFpbUlkLCB1bnBpbiB9ID0gYWN0aW9uLmRhdGE7XG4gICAgICBjb25zdCBjb21tZW50QnlJZCA9IE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLmNvbW1lbnRCeUlkKTtcbiAgICAgIGNvbnN0IHRvcExldmVsQ29tbWVudHNCeUlkID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUudG9wTGV2ZWxDb21tZW50c0J5SWQpO1xuICAgICAgY29uc3QgcGlubmVkQ29tbWVudHNCeUlkID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUucGlubmVkQ29tbWVudHNCeUlkKTtcblxuICAgICAgaWYgKHBpbm5lZENvbW1lbnQpIHtcbiAgICAgICAgaWYgKHRvcExldmVsQ29tbWVudHNCeUlkW2NsYWltSWRdKSB7XG4gICAgICAgICAgY29uc3QgaW5kZXggPSB0b3BMZXZlbENvbW1lbnRzQnlJZFtjbGFpbUlkXS5pbmRleE9mKHBpbm5lZENvbW1lbnQuY29tbWVudF9pZCk7XG4gICAgICAgICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgICAgICAgIHRvcExldmVsQ29tbWVudHNCeUlkW2NsYWltSWRdLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRvcExldmVsQ29tbWVudHNCeUlkW2NsYWltSWRdID0gW107XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocGlubmVkQ29tbWVudHNCeUlkW2NsYWltSWRdKSB7XG4gICAgICAgICAgY29uc3QgaW5kZXggPSBwaW5uZWRDb21tZW50c0J5SWRbY2xhaW1JZF0uaW5kZXhPZihwaW5uZWRDb21tZW50LmNvbW1lbnRfaWQpO1xuICAgICAgICAgIGlmIChpbmRleCA+IC0xKSB7XG4gICAgICAgICAgICBwaW5uZWRDb21tZW50c0J5SWRbY2xhaW1JZF0uc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcGlubmVkQ29tbWVudHNCeUlkW2NsYWltSWRdID0gW107XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodW5waW4pIHtcbiAgICAgICAgICAvLyBXaXRob3V0IHRoZSBzb3J0IHNjb3JlLCBJIGhhdmUgbm8gaWRlYSB3aGVyZSB0byBwdXQgaXQuIEp1c3RcbiAgICAgICAgICAvLyBkdW1wIGl0IGF0IHRoZSB0b3AuIFVzZXJzIGNhbiByZWZyZXNoIGlmIHRoZXkgd2FudCBpdCBiYWNrIHRvXG4gICAgICAgICAgLy8gdGhlIGNvcnJlY3Qgc29ydGVkIHBvc2l0aW9uLlxuICAgICAgICAgIHRvcExldmVsQ29tbWVudHNCeUlkW2NsYWltSWRdLnVuc2hpZnQocGlubmVkQ29tbWVudC5jb21tZW50X2lkKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBwaW5uZWRDb21tZW50c0J5SWRbY2xhaW1JZF0udW5zaGlmdChwaW5uZWRDb21tZW50LmNvbW1lbnRfaWQpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNvbW1lbnRCeUlkW3Bpbm5lZENvbW1lbnQuY29tbWVudF9pZF0pIHtcbiAgICAgICAgICAvLyBDb21tZW50cm9uJ3MgYGNvbW1lbnQuUGluYCByZXNwb25zZSBwbGFjZXMgdGhlIGNyZWF0b3IncyBjcmVkZW50aWFsc1xuICAgICAgICAgIC8vIGluIHRoZSAnY2hhbm5lbF8qJyBmaWVsZHMsIHdoaWNoIGRvZXNuJ3QgbWFrZSBzZW5zZS4gTWF5YmUgaXQgaXMgdG9cbiAgICAgICAgICAvLyBzaG93IHdobyBzaWduZWQvcGlubmVkIGl0LCBidXQgZXZlbiBpZiBzbywgaXQgc2hvdWxkbid0IG92ZXJsb2FkXG4gICAgICAgICAgLy8gdGhlc2UgdmFyaWFibGVzIHdoaWNoIGFyZSBhbHJlYWR5IHVzZWQgYnkgZXhpc3RpbmcgY29tbWVudCBkYXRhIHN0cnVjdHVyZS5cbiAgICAgICAgICAvLyBFbnN1cmUgd2UgZG9uJ3Qgb3ZlcnJpZGUgdGhlIGV4aXN0aW5nL2NvcnJlY3QgdmFsdWVzLCBidXQgZmFsbGJhY2tcbiAgICAgICAgICAvLyB0byB3aGF0ZXZlciB3YXMgZ2l2ZW4uXG4gICAgICAgICAgY29uc3QgeyBjaGFubmVsX2lkLCBjaGFubmVsX25hbWUsIGNoYW5uZWxfdXJsIH0gPSBjb21tZW50QnlJZFtwaW5uZWRDb21tZW50LmNvbW1lbnRfaWRdO1xuICAgICAgICAgIGNvbW1lbnRCeUlkW3Bpbm5lZENvbW1lbnQuY29tbWVudF9pZF0gPSB7XG4gICAgICAgICAgICAuLi5waW5uZWRDb21tZW50LFxuICAgICAgICAgICAgY2hhbm5lbF9pZDogY2hhbm5lbF9pZCB8fCBwaW5uZWRDb21tZW50LmNoYW5uZWxfaWQsXG4gICAgICAgICAgICBjaGFubmVsX25hbWU6IGNoYW5uZWxfbmFtZSB8fCBwaW5uZWRDb21tZW50LmNoYW5uZWxfbmFtZSxcbiAgICAgICAgICAgIGNoYW5uZWxfdXJsOiBjaGFubmVsX3VybCB8fCBwaW5uZWRDb21tZW50LmNoYW5uZWxfdXJsLFxuICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29tbWVudEJ5SWRbcGlubmVkQ29tbWVudC5jb21tZW50X2lkXSA9IHBpbm5lZENvbW1lbnQ7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgIGNvbW1lbnRCeUlkLFxuICAgICAgICB0b3BMZXZlbENvbW1lbnRzQnlJZCxcbiAgICAgICAgcGlubmVkQ29tbWVudHNCeUlkLFxuICAgICAgfTtcbiAgICB9LFxuXG4gICAgLy8gW0FDVElPTlMuTUVNQkVSU19PTkxZX0NIQVRfVE9HR0xFRF06IChzdGF0ZTogQ29tbWVudHNTdGF0ZSwgYWN0aW9uOiBhbnkpID0+IHtcbiAgICAvLyAgIGwoJ2FjdGlvbicpO1xuICAgIC8vICAgbChhY3Rpb24pXG4gICAgLy8gICByZXR1cm4gc3RhdGU7XG4gICAgLy8gICAvLyBjb25zdCB7IG1lbWJlcnNPbmx5Q2hhdEVuYWJsZWQgfSA9IGFjdGlvbi5kYXRhO1xuICAgIC8vICAgLy8gY29uc3QgY29tbWVudEJ5SWQgPSBPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS5jb21tZW50QnlJZCk7XG4gICAgLy8gICAvL1xuICAgIC8vICAgLy8gaWYgKCFjb21tZW50QnlJZFtjb21tZW50X2lkXSkge1xuICAgIC8vICAgLy8gICByZXR1cm4gc3RhdGU7XG4gICAgLy8gICAvLyB9XG4gICAgLy8gICAvL1xuICAgIC8vICAgLy8gY29tbWVudEJ5SWRbY29tbWVudF9pZF0gPSB7IC4uLmNvbW1lbnRCeUlkW2NvbW1lbnRfaWRdLCByZW1vdmVkOiB0cnVlIH07XG4gICAgLy8gICAvLyByZXR1cm4geyAuLi5zdGF0ZSwgY29tbWVudEJ5SWQgfTtcbiAgICAvLyB9LFxuXG4gICAgW0FDVElPTlMuQ09NTUVOVF9NQVJLX0FTX1JFTU9WRURdOiAoc3RhdGU6IENvbW1lbnRzU3RhdGUsIGFjdGlvbjogYW55KSA9PiB7XG4gICAgICBjb25zdCB7IGNvbW1lbnRfaWQgfSA9IGFjdGlvbi5kYXRhO1xuICAgICAgY29uc3QgY29tbWVudEJ5SWQgPSBPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS5jb21tZW50QnlJZCk7XG5cbiAgICAgIGlmICghY29tbWVudEJ5SWRbY29tbWVudF9pZF0pIHtcbiAgICAgICAgcmV0dXJuIHN0YXRlO1xuICAgICAgfVxuXG4gICAgICBjb21tZW50QnlJZFtjb21tZW50X2lkXSA9IHsgLi4uY29tbWVudEJ5SWRbY29tbWVudF9pZF0sIHJlbW92ZWQ6IHRydWUgfTtcbiAgICAgIHJldHVybiB7IC4uLnN0YXRlLCBjb21tZW50QnlJZCB9O1xuICAgIH0sXG5cbiAgICBbQUNUSU9OUy5DT01NRU5UX01PREVSQVRJT05fQkxPQ0tfTElTVF9TVEFSVEVEXTogKHN0YXRlOiBDb21tZW50c1N0YXRlLCBhY3Rpb246IGFueSkgPT4gKHtcbiAgICAgIC4uLnN0YXRlLFxuICAgICAgZmV0Y2hpbmdNb2RlcmF0aW9uQmxvY2tMaXN0OiB0cnVlLFxuICAgIH0pLFxuICAgIFtBQ1RJT05TLkNPTU1FTlRfTU9ERVJBVElPTl9CTE9DS19MSVNUX0NPTVBMRVRFRF06IChzdGF0ZTogQ29tbWVudHNTdGF0ZSwgYWN0aW9uOiBhbnkpID0+IHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgcGVyc29uYWxCbG9ja0xpc3QsXG4gICAgICAgIGFkbWluQmxvY2tMaXN0LFxuICAgICAgICBtb2RlcmF0b3JCbG9ja0xpc3QsXG4gICAgICAgIG1vZGVyYXRvckJsb2NrTGlzdERlbGVnYXRvcnNNYXAsXG4gICAgICAgIHBlcnNvbmFsVGltZW91dE1hcCxcbiAgICAgICAgYWRtaW5UaW1lb3V0TWFwLFxuICAgICAgICBtb2RlcmF0b3JUaW1lb3V0TWFwLFxuICAgICAgfSA9IGFjdGlvbi5kYXRhO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5zdGF0ZSxcbiAgICAgICAgbW9kZXJhdGlvbkJsb2NrTGlzdDogcGVyc29uYWxCbG9ja0xpc3QsXG4gICAgICAgIGFkbWluQmxvY2tMaXN0OiBhZG1pbkJsb2NrTGlzdCxcbiAgICAgICAgbW9kZXJhdG9yQmxvY2tMaXN0OiBtb2RlcmF0b3JCbG9ja0xpc3QsXG4gICAgICAgIG1vZGVyYXRvckJsb2NrTGlzdERlbGVnYXRvcnNNYXAsXG4gICAgICAgIHBlcnNvbmFsVGltZW91dE1hcCxcbiAgICAgICAgYWRtaW5UaW1lb3V0TWFwLFxuICAgICAgICBtb2RlcmF0b3JUaW1lb3V0TWFwLFxuICAgICAgICBmZXRjaGluZ01vZGVyYXRpb25CbG9ja0xpc3Q6IGZhbHNlLFxuICAgICAgfTtcbiAgICB9LFxuICAgIFtBQ1RJT05TLkNPTU1FTlRfTU9ERVJBVElPTl9CTE9DS19MSVNUX0ZBSUxFRF06IChzdGF0ZTogQ29tbWVudHNTdGF0ZSwgYWN0aW9uOiBhbnkpID0+ICh7XG4gICAgICAuLi5zdGF0ZSxcbiAgICAgIGZldGNoaW5nTW9kZXJhdGlvbkJsb2NrTGlzdDogZmFsc2UsXG4gICAgfSksXG5cbiAgICBbQUNUSU9OUy5DT01NRU5UX01PREVSQVRJT05fQkxPQ0tfU1RBUlRFRF06IChzdGF0ZTogQ29tbWVudHNTdGF0ZSwgYWN0aW9uOiBhbnkpID0+IHtcbiAgICAgIGNvbnN0IHsgYmxvY2tlZFVyaSwgY3JlYXRvclVyaSwgYmxvY2tMZXZlbCB9ID0gYWN0aW9uLmRhdGE7XG5cbiAgICAgIHN3aXRjaCAoYmxvY2tMZXZlbCkge1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICBjYXNlIEJMT0NLX0xFVkVMLlNFTEY6XG4gICAgICAgIGNhc2UgQkxPQ0tfTEVWRUwuQURNSU46XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIC4uLnN0YXRlLFxuICAgICAgICAgICAgYmxvY2tpbmdCeVVyaToge1xuICAgICAgICAgICAgICAuLi5zdGF0ZS5ibG9ja2luZ0J5VXJpLFxuICAgICAgICAgICAgICBbYmxvY2tlZFVyaV06IHRydWUsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH07XG5cbiAgICAgICAgY2FzZSBCTE9DS19MRVZFTC5NT0RFUkFUT1I6XG4gICAgICAgICAgY29uc3QgbmV3TWFwID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUudG9nZ2xpbmdGb3JEZWxlZ2F0b3JNYXApO1xuICAgICAgICAgIGNvbnN0IHRvZ2dsaW5nRGVsZWdhdG9yc0ZvckJsb2NrZWRVcmkgPSBuZXdNYXBbYmxvY2tlZFVyaV07XG4gICAgICAgICAgaWYgKHRvZ2dsaW5nRGVsZWdhdG9yc0ZvckJsb2NrZWRVcmkpIHtcbiAgICAgICAgICAgIGlmICghdG9nZ2xpbmdEZWxlZ2F0b3JzRm9yQmxvY2tlZFVyaS5pbmNsdWRlcyhjcmVhdG9yVXJpKSkge1xuICAgICAgICAgICAgICB0b2dnbGluZ0RlbGVnYXRvcnNGb3JCbG9ja2VkVXJpLnB1c2goY3JlYXRvclVyaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG5ld01hcFtibG9ja2VkVXJpXSA9IFtjcmVhdG9yVXJpXTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgICAgICB0b2dnbGluZ0ZvckRlbGVnYXRvck1hcDogbmV3TWFwLFxuICAgICAgICAgIH07XG4gICAgICB9XG4gICAgfSxcblxuICAgIFtBQ1RJT05TLkNPTU1FTlRfTU9ERVJBVElPTl9VTl9CTE9DS19TVEFSVEVEXTogKHN0YXRlOiBDb21tZW50c1N0YXRlLCBhY3Rpb246IGFueSkgPT4ge1xuICAgICAgY29uc3QgeyBibG9ja2VkVXJpLCBjcmVhdG9yVXJpLCBibG9ja0xldmVsIH0gPSBhY3Rpb24uZGF0YTtcblxuICAgICAgc3dpdGNoIChibG9ja0xldmVsKSB7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGNhc2UgQkxPQ0tfTEVWRUwuU0VMRjpcbiAgICAgICAgY2FzZSBCTE9DS19MRVZFTC5BRE1JTjpcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgICAgICB1bkJsb2NraW5nQnlVcmk6IHtcbiAgICAgICAgICAgICAgLi4uc3RhdGUudW5CbG9ja2luZ0J5VXJpLFxuICAgICAgICAgICAgICBbYmxvY2tlZFVyaV06IHRydWUsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH07XG5cbiAgICAgICAgY2FzZSBCTE9DS19MRVZFTC5NT0RFUkFUT1I6XG4gICAgICAgICAgY29uc3QgbmV3TWFwID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUudG9nZ2xpbmdGb3JEZWxlZ2F0b3JNYXApO1xuICAgICAgICAgIGNvbnN0IHRvZ2dsaW5nRGVsZWdhdG9yc0ZvckJsb2NrZWRVcmkgPSBuZXdNYXBbYmxvY2tlZFVyaV07XG4gICAgICAgICAgaWYgKHRvZ2dsaW5nRGVsZWdhdG9yc0ZvckJsb2NrZWRVcmkpIHtcbiAgICAgICAgICAgIGlmICghdG9nZ2xpbmdEZWxlZ2F0b3JzRm9yQmxvY2tlZFVyaS5pbmNsdWRlcyhjcmVhdG9yVXJpKSkge1xuICAgICAgICAgICAgICB0b2dnbGluZ0RlbGVnYXRvcnNGb3JCbG9ja2VkVXJpLnB1c2goY3JlYXRvclVyaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG5ld01hcFtibG9ja2VkVXJpXSA9IFtjcmVhdG9yVXJpXTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgICAgICB0b2dnbGluZ0ZvckRlbGVnYXRvck1hcDogbmV3TWFwLFxuICAgICAgICAgIH07XG4gICAgICB9XG4gICAgfSxcblxuICAgIFtBQ1RJT05TLkNPTU1FTlRfTU9ERVJBVElPTl9CTE9DS19GQUlMRURdOiAoc3RhdGU6IENvbW1lbnRzU3RhdGUsIGFjdGlvbjogYW55KSA9PiB7XG4gICAgICBjb25zdCB7IGJsb2NrZWRVcmksIGNyZWF0b3JVcmksIGJsb2NrTGV2ZWwgfSA9IGFjdGlvbi5kYXRhO1xuXG4gICAgICBzd2l0Y2ggKGJsb2NrTGV2ZWwpIHtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgY2FzZSBCTE9DS19MRVZFTC5TRUxGOlxuICAgICAgICBjYXNlIEJMT0NLX0xFVkVMLkFETUlOOlxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAuLi5zdGF0ZSxcbiAgICAgICAgICAgIGJsb2NraW5nQnlVcmk6IHtcbiAgICAgICAgICAgICAgLi4uc3RhdGUuYmxvY2tpbmdCeVVyaSxcbiAgICAgICAgICAgICAgW2Jsb2NrZWRVcmldOiBmYWxzZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfTtcblxuICAgICAgICBjYXNlIEJMT0NLX0xFVkVMLk1PREVSQVRPUjpcbiAgICAgICAgICBjb25zdCBuZXdNYXAgPSBPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS50b2dnbGluZ0ZvckRlbGVnYXRvck1hcCk7XG4gICAgICAgICAgY29uc3QgdG9nZ2xpbmdEZWxlZ2F0b3JzRm9yQmxvY2tlZFVyaSA9IG5ld01hcFtibG9ja2VkVXJpXTtcbiAgICAgICAgICBpZiAodG9nZ2xpbmdEZWxlZ2F0b3JzRm9yQmxvY2tlZFVyaSkge1xuICAgICAgICAgICAgbmV3TWFwW2Jsb2NrZWRVcmldID0gdG9nZ2xpbmdEZWxlZ2F0b3JzRm9yQmxvY2tlZFVyaS5maWx0ZXIoKHgpID0+IHggIT09IGNyZWF0b3JVcmkpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAuLi5zdGF0ZSxcbiAgICAgICAgICAgIHRvZ2dsaW5nRm9yRGVsZWdhdG9yTWFwOiBuZXdNYXAsXG4gICAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgW0FDVElPTlMuQ09NTUVOVF9NT0RFUkFUSU9OX1VOX0JMT0NLX0ZBSUxFRF06IChzdGF0ZTogQ29tbWVudHNTdGF0ZSwgYWN0aW9uOiBhbnkpID0+IHtcbiAgICAgIGNvbnN0IHsgYmxvY2tlZFVyaSwgY3JlYXRvclVyaSwgYmxvY2tMZXZlbCB9ID0gYWN0aW9uLmRhdGE7XG5cbiAgICAgIHN3aXRjaCAoYmxvY2tMZXZlbCkge1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICBjYXNlIEJMT0NLX0xFVkVMLlNFTEY6XG4gICAgICAgIGNhc2UgQkxPQ0tfTEVWRUwuQURNSU46XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIC4uLnN0YXRlLFxuICAgICAgICAgICAgdW5CbG9ja2luZ0J5VXJpOiB7XG4gICAgICAgICAgICAgIC4uLnN0YXRlLnVuQmxvY2tpbmdCeVVyaSxcbiAgICAgICAgICAgICAgW2Jsb2NrZWRVcmldOiBmYWxzZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfTtcblxuICAgICAgICBjYXNlIEJMT0NLX0xFVkVMLk1PREVSQVRPUjpcbiAgICAgICAgICBjb25zdCBuZXdNYXAgPSBPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS50b2dnbGluZ0ZvckRlbGVnYXRvck1hcCk7XG4gICAgICAgICAgY29uc3QgdG9nZ2xpbmdEZWxlZ2F0b3JzRm9yQmxvY2tlZFVyaSA9IG5ld01hcFtibG9ja2VkVXJpXTtcbiAgICAgICAgICBpZiAodG9nZ2xpbmdEZWxlZ2F0b3JzRm9yQmxvY2tlZFVyaSkge1xuICAgICAgICAgICAgbmV3TWFwW2Jsb2NrZWRVcmldID0gdG9nZ2xpbmdEZWxlZ2F0b3JzRm9yQmxvY2tlZFVyaS5maWx0ZXIoKHgpID0+IHggIT09IGNyZWF0b3JVcmkpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAuLi5zdGF0ZSxcbiAgICAgICAgICAgIHRvZ2dsaW5nRm9yRGVsZWdhdG9yTWFwOiBuZXdNYXAsXG4gICAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgW0FDVElPTlMuQ09NTUVOVF9NT0RFUkFUSU9OX0JMT0NLX0NPTVBMRVRFXTogKHN0YXRlOiBDb21tZW50c1N0YXRlLCBhY3Rpb246IGFueSkgPT4ge1xuICAgICAgY29uc3QgeyBibG9ja2VkVXJpLCBjcmVhdG9yVXJpLCBibG9ja0xldmVsIH0gPSBhY3Rpb24uZGF0YTtcbiAgICAgIGNvbnN0IGNvbW1lbnRCeUlkID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUuY29tbWVudEJ5SWQpO1xuICAgICAgY29uc3QgYmxvY2tpbmdCeVVyaSA9IE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLmJsb2NraW5nQnlVcmkpO1xuXG4gICAgICBmb3IgKGNvbnN0IGNvbW1lbnRJZCBpbiBjb21tZW50QnlJZCkge1xuICAgICAgICBjb25zdCBjb21tZW50ID0gY29tbWVudEJ5SWRbY29tbWVudElkXTtcblxuICAgICAgICBpZiAoaXNVUklFcXVhbChibG9ja2VkVXJpLCBjb21tZW50LmNoYW5uZWxfdXJsKSkge1xuICAgICAgICAgIGRlbGV0ZSBjb21tZW50QnlJZFtjb21tZW50LmNvbW1lbnRfaWRdO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHN3aXRjaCAoYmxvY2tMZXZlbCkge1xuICAgICAgICBjYXNlIEJMT0NLX0xFVkVMLlNFTEY6IHtcbiAgICAgICAgICBjb25zdCBibG9ja0xpc3QgPSBzdGF0ZS5tb2RlcmF0aW9uQmxvY2tMaXN0IHx8IFtdO1xuICAgICAgICAgIGNvbnN0IG5ld0Jsb2NrTGlzdCA9IGJsb2NrTGlzdC5zbGljZSgpO1xuICAgICAgICAgIG5ld0Jsb2NrTGlzdC5wdXNoKGJsb2NrZWRVcmkpO1xuICAgICAgICAgIGRlbGV0ZSBibG9ja2luZ0J5VXJpW2Jsb2NrZWRVcmldO1xuXG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIC4uLnN0YXRlLFxuICAgICAgICAgICAgY29tbWVudEJ5SWQsXG4gICAgICAgICAgICBibG9ja2luZ0J5VXJpLFxuICAgICAgICAgICAgbW9kZXJhdGlvbkJsb2NrTGlzdDogbmV3QmxvY2tMaXN0LFxuICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBjYXNlIEJMT0NLX0xFVkVMLk1PREVSQVRPUjoge1xuICAgICAgICAgIGNvbnN0IGJsb2NrTGlzdCA9IHN0YXRlLm1vZGVyYXRvckJsb2NrTGlzdCB8fCBbXTtcbiAgICAgICAgICBjb25zdCBuZXdCbG9ja0xpc3QgPSBibG9ja0xpc3Quc2xpY2UoKTtcblxuICAgICAgICAgIC8vIFVwZGF0ZSBtYWluIGJsb2NrIGxpc3RcbiAgICAgICAgICBpZiAoIW5ld0Jsb2NrTGlzdC5pbmNsdWRlcyhibG9ja2VkVXJpKSkge1xuICAgICAgICAgICAgbmV3QmxvY2tMaXN0LnB1c2goYmxvY2tlZFVyaSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gVXBkYXRlIGxpc3Qgb2YgZGVsZWdhdG9yc1xuICAgICAgICAgIGNvbnN0IG1vZGVyYXRvckJsb2NrTGlzdERlbGVnYXRvcnNNYXAgPSBPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS5tb2RlcmF0b3JCbG9ja0xpc3REZWxlZ2F0b3JzTWFwKTtcbiAgICAgICAgICBjb25zdCBkZWxlZ2F0b3JVcmlzRm9yQmxvY2tlZFVyaSA9IG1vZGVyYXRvckJsb2NrTGlzdERlbGVnYXRvcnNNYXBbYmxvY2tlZFVyaV07XG4gICAgICAgICAgaWYgKGRlbGVnYXRvclVyaXNGb3JCbG9ja2VkVXJpKSB7XG4gICAgICAgICAgICBpZiAoIWRlbGVnYXRvclVyaXNGb3JCbG9ja2VkVXJpLmluY2x1ZGVzKGNyZWF0b3JVcmkpKSB7XG4gICAgICAgICAgICAgIGRlbGVnYXRvclVyaXNGb3JCbG9ja2VkVXJpLnB1c2goY3JlYXRvclVyaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG1vZGVyYXRvckJsb2NrTGlzdERlbGVnYXRvcnNNYXBbYmxvY2tlZFVyaV0gPSBbY3JlYXRvclVyaV07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gUmVtb3ZlIFwidG9nZ2xpbmdcIiBmbGFnXG4gICAgICAgICAgY29uc3QgdG9nZ2xpbmdNYXAgPSBPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS50b2dnbGluZ0ZvckRlbGVnYXRvck1hcCk7XG4gICAgICAgICAgY29uc3QgdG9nZ2xpbmdEZWxlZ2F0b3JzRm9yQmxvY2tlZFVyaSA9IHRvZ2dsaW5nTWFwW2Jsb2NrZWRVcmldO1xuICAgICAgICAgIGlmICh0b2dnbGluZ0RlbGVnYXRvcnNGb3JCbG9ja2VkVXJpKSB7XG4gICAgICAgICAgICB0b2dnbGluZ01hcFtibG9ja2VkVXJpXSA9IHRvZ2dsaW5nRGVsZWdhdG9yc0ZvckJsb2NrZWRVcmkuZmlsdGVyKCh4KSA9PiB4ICE9PSBjcmVhdG9yVXJpKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgICAgICBjb21tZW50QnlJZCxcbiAgICAgICAgICAgIG1vZGVyYXRvckJsb2NrTGlzdDogbmV3QmxvY2tMaXN0LFxuICAgICAgICAgICAgbW9kZXJhdG9yQmxvY2tMaXN0RGVsZWdhdG9yc01hcCxcbiAgICAgICAgICAgIHRvZ2dsaW5nRm9yRGVsZWdhdG9yTWFwOiB0b2dnbGluZ01hcCxcbiAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgY2FzZSBCTE9DS19MRVZFTC5BRE1JTjpcbiAgICAgICAgICBjb25zdCBibG9ja0xpc3QgPSBzdGF0ZS5hZG1pbkJsb2NrTGlzdCB8fCBbXTtcbiAgICAgICAgICBjb25zdCBuZXdCbG9ja0xpc3QgPSBibG9ja0xpc3Quc2xpY2UoKTtcbiAgICAgICAgICBuZXdCbG9ja0xpc3QucHVzaChibG9ja2VkVXJpKTtcbiAgICAgICAgICBkZWxldGUgYmxvY2tpbmdCeVVyaVtibG9ja2VkVXJpXTtcblxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAuLi5zdGF0ZSxcbiAgICAgICAgICAgIGNvbW1lbnRCeUlkLFxuICAgICAgICAgICAgYmxvY2tpbmdCeVVyaSxcbiAgICAgICAgICAgIGFkbWluQmxvY2tMaXN0OiBuZXdCbG9ja0xpc3QsXG4gICAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9LFxuICAgIFtBQ1RJT05TLkNPTU1FTlRfTU9ERVJBVElPTl9VTl9CTE9DS19DT01QTEVURV06IChzdGF0ZTogQ29tbWVudHNTdGF0ZSwgYWN0aW9uOiBhbnkpID0+IHtcbiAgICAgIGNvbnN0IHsgYmxvY2tlZFVyaSwgY3JlYXRvclVyaSwgYmxvY2tMZXZlbCB9ID0gYWN0aW9uLmRhdGE7XG4gICAgICBjb25zdCB1bkJsb2NraW5nQnlVcmkgPSBPYmplY3QuYXNzaWduKHN0YXRlLnVuQmxvY2tpbmdCeVVyaSwge30pO1xuXG4gICAgICBzd2l0Y2ggKGJsb2NrTGV2ZWwpIHtcbiAgICAgICAgY2FzZSBCTE9DS19MRVZFTC5TRUxGOiB7XG4gICAgICAgICAgY29uc3QgYmxvY2tMaXN0ID0gc3RhdGUubW9kZXJhdGlvbkJsb2NrTGlzdCB8fCBbXTtcbiAgICAgICAgICBkZWxldGUgdW5CbG9ja2luZ0J5VXJpW2Jsb2NrZWRVcmldO1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAuLi5zdGF0ZSxcbiAgICAgICAgICAgIHVuQmxvY2tpbmdCeVVyaSxcbiAgICAgICAgICAgIG1vZGVyYXRpb25CbG9ja0xpc3Q6IGJsb2NrTGlzdC5zbGljZSgpLmZpbHRlcigodXJpKSA9PiB1cmkgIT09IGJsb2NrZWRVcmkpLFxuICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBjYXNlIEJMT0NLX0xFVkVMLkFETUlOOiB7XG4gICAgICAgICAgY29uc3QgYmxvY2tMaXN0ID0gc3RhdGUuYWRtaW5CbG9ja0xpc3QgfHwgW107XG4gICAgICAgICAgZGVsZXRlIHVuQmxvY2tpbmdCeVVyaVtibG9ja2VkVXJpXTtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgICAgICB1bkJsb2NraW5nQnlVcmksXG4gICAgICAgICAgICBhZG1pbkJsb2NrTGlzdDogYmxvY2tMaXN0LnNsaWNlKCkuZmlsdGVyKCh1cmkpID0+IHVyaSAhPT0gYmxvY2tlZFVyaSksXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNhc2UgQkxPQ0tfTEVWRUwuTU9ERVJBVE9SOiB7XG4gICAgICAgICAgY29uc3QgYmxvY2tMaXN0ID0gc3RhdGUubW9kZXJhdG9yQmxvY2tMaXN0IHx8IFtdO1xuICAgICAgICAgIGNvbnN0IG5ld0Jsb2NrTGlzdCA9IGJsb2NrTGlzdC5zbGljZSgpO1xuICAgICAgICAgIGNvbnN0IHRvZ2dsaW5nTWFwID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUudG9nZ2xpbmdGb3JEZWxlZ2F0b3JNYXApO1xuXG4gICAgICAgICAgY29uc3QgbW9kZXJhdG9yQmxvY2tMaXN0RGVsZWdhdG9yc01hcCA9IE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLm1vZGVyYXRvckJsb2NrTGlzdERlbGVnYXRvcnNNYXApO1xuICAgICAgICAgIGNvbnN0IGRlbGVnYXRvclVyaXNGb3JCbG9ja2VkVXJpID0gbW9kZXJhdG9yQmxvY2tMaXN0RGVsZWdhdG9yc01hcFtibG9ja2VkVXJpXTtcbiAgICAgICAgICBpZiAoZGVsZWdhdG9yVXJpc0ZvckJsb2NrZWRVcmkpIHtcbiAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gZGVsZWdhdG9yVXJpc0ZvckJsb2NrZWRVcmkuaW5kZXhPZihjcmVhdG9yVXJpKTtcbiAgICAgICAgICAgIGlmIChpbmRleCA+IC0xKSB7XG4gICAgICAgICAgICAgIC8vIFJlbW92ZSBmcm9tIGRlbGVnYXRvcnMgbGlzdFxuICAgICAgICAgICAgICBkZWxlZ2F0b3JVcmlzRm9yQmxvY2tlZFVyaS5zcGxpY2UoaW5kZXgsIDEpO1xuXG4gICAgICAgICAgICAgIC8vIC8vIFJlbW92ZSBibG9ja2VkIGVudHJ5IGlmIGl0IHdhcyByZW1vdmVkIGZvciBhbGwgZGVsZWdhdG9yc1xuICAgICAgICAgICAgICAvLyBpZiAoZGVsZWdhdG9yVXJpc0ZvckJsb2NrZWRVcmkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgIC8vICAgZGVsZXRlIG1vZGVyYXRvckJsb2NrTGlzdERlbGVnYXRvcnNNYXBbYmxvY2tlZFVyaV07XG4gICAgICAgICAgICAgIC8vICAgbmV3QmxvY2tMaXN0ID0gbmV3QmxvY2tMaXN0LmZpbHRlcigodXJpKSA9PiB1cmkgIT09IGJsb2NrZWRVcmkpO1xuICAgICAgICAgICAgICAvLyB9XG5cbiAgICAgICAgICAgICAgLy8gUmVtb3ZlIGZyb20gXCJ0b2dnbGluZ1wiIGZsYWdcbiAgICAgICAgICAgICAgY29uc3QgdG9nZ2xpbmdEZWxlZ2F0b3JzRm9yQmxvY2tlZFVyaSA9IHRvZ2dsaW5nTWFwW2Jsb2NrZWRVcmldO1xuICAgICAgICAgICAgICBpZiAodG9nZ2xpbmdEZWxlZ2F0b3JzRm9yQmxvY2tlZFVyaSkge1xuICAgICAgICAgICAgICAgIHRvZ2dsaW5nTWFwW2Jsb2NrZWRVcmldID0gdG9nZ2xpbmdEZWxlZ2F0b3JzRm9yQmxvY2tlZFVyaS5maWx0ZXIoKHgpID0+IHggIT09IGNyZWF0b3JVcmkpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIC4uLnN0YXRlLFxuICAgICAgICAgICAgbW9kZXJhdG9yQmxvY2tMaXN0OiBuZXdCbG9ja0xpc3QsXG4gICAgICAgICAgICB0b2dnbGluZ0ZvckRlbGVnYXRvck1hcDogdG9nZ2xpbmdNYXAsXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG5cbiAgICBbQUNUSU9OUy5DT01NRU5UX0ZFVENIX01PREVSQVRJT05fREVMRUdBVEVTX1NUQVJURURdOiAoc3RhdGU6IENvbW1lbnRzU3RhdGUsIGFjdGlvbjogYW55KSA9PiAoe1xuICAgICAgLi4uc3RhdGUsXG4gICAgICBmZXRjaGluZ01vZGVyYXRpb25EZWxlZ2F0ZXM6IHRydWUsXG4gICAgfSksXG4gICAgW0FDVElPTlMuQ09NTUVOVF9GRVRDSF9NT0RFUkFUSU9OX0RFTEVHQVRFU19GQUlMRURdOiAoc3RhdGU6IENvbW1lbnRzU3RhdGUsIGFjdGlvbjogYW55KSA9PiAoe1xuICAgICAgLi4uc3RhdGUsXG4gICAgICBmZXRjaGluZ01vZGVyYXRpb25EZWxlZ2F0ZXM6IGZhbHNlLFxuICAgIH0pLFxuICAgIFtBQ1RJT05TLkNPTU1FTlRfRkVUQ0hfTU9ERVJBVElPTl9ERUxFR0FURVNfQ09NUExFVEVEXTogKHN0YXRlOiBDb21tZW50c1N0YXRlLCBhY3Rpb246IGFueSkgPT4ge1xuICAgICAgY29uc3QgbW9kZXJhdGlvbkRlbGVnYXRlc0J5SWQgPSBPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS5tb2RlcmF0aW9uRGVsZWdhdGVzQnlJZCk7XG4gICAgICBpZiAoYWN0aW9uLmRhdGEuZGVsZWdhdGVzKSB7XG4gICAgICAgIG1vZGVyYXRpb25EZWxlZ2F0ZXNCeUlkW2FjdGlvbi5kYXRhLmlkXSA9IGFjdGlvbi5kYXRhLmRlbGVnYXRlcy5tYXAoKGRlbGVnYXRlKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNoYW5uZWxJZDogZGVsZWdhdGUuY2hhbm5lbF9pZCxcbiAgICAgICAgICAgIGNoYW5uZWxOYW1lOiBkZWxlZ2F0ZS5jaGFubmVsX25hbWUsXG4gICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBtb2RlcmF0aW9uRGVsZWdhdGVzQnlJZFthY3Rpb24uZGF0YS5pZF0gPSBbXTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgIGZldGNoaW5nTW9kZXJhdGlvbkRlbGVnYXRlczogZmFsc2UsXG4gICAgICAgIG1vZGVyYXRpb25EZWxlZ2F0ZXNCeUlkOiBtb2RlcmF0aW9uRGVsZWdhdGVzQnlJZCxcbiAgICAgIH07XG4gICAgfSxcblxuICAgIFtBQ1RJT05TLkNPTU1FTlRfTU9ERVJBVElPTl9BTV9JX0xJU1RfU1RBUlRFRF06IChzdGF0ZTogQ29tbWVudHNTdGF0ZSwgYWN0aW9uOiBhbnkpID0+ICh7XG4gICAgICAuLi5zdGF0ZSxcbiAgICAgIGZldGNoaW5nTW9kZXJhdGlvbkRlbGVnYXRvcnM6IHRydWUsXG4gICAgfSksXG5cbiAgICBbQUNUSU9OUy5DT01NRU5UX01PREVSQVRJT05fQU1fSV9MSVNUX0ZBSUxFRF06IChzdGF0ZTogQ29tbWVudHNTdGF0ZSwgYWN0aW9uOiBhbnkpID0+ICh7XG4gICAgICAuLi5zdGF0ZSxcbiAgICAgIGZldGNoaW5nTW9kZXJhdGlvbkRlbGVnYXRvcnM6IHRydWUsXG4gICAgfSksXG5cbiAgICBbQUNUSU9OUy5DT01NRU5UX01PREVSQVRJT05fQU1fSV9MSVNUX0NPTVBMRVRFRF06IChzdGF0ZTogQ29tbWVudHNTdGF0ZSwgYWN0aW9uOiBhbnkpID0+IHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLnN0YXRlLFxuICAgICAgICBmZXRjaGluZ01vZGVyYXRpb25EZWxlZ2F0b3JzOiB0cnVlLFxuICAgICAgICBtb2RlcmF0aW9uRGVsZWdhdG9yc0J5SWQ6IGFjdGlvbi5kYXRhLFxuICAgICAgfTtcbiAgICB9LFxuXG4gICAgW0FDVElPTlMuQ09NTUVOVF9GRVRDSF9TRVRUSU5HU19TVEFSVEVEXTogKHN0YXRlOiBDb21tZW50c1N0YXRlLCBhY3Rpb246IGFueSkgPT4gKHtcbiAgICAgIC4uLnN0YXRlLFxuICAgICAgZmV0Y2hpbmdTZXR0aW5nczogdHJ1ZSxcbiAgICB9KSxcbiAgICBbQUNUSU9OUy5DT01NRU5UX0ZFVENIX1NFVFRJTkdTX0ZBSUxFRF06IChzdGF0ZTogQ29tbWVudHNTdGF0ZSwgYWN0aW9uOiBhbnkpID0+ICh7XG4gICAgICAuLi5zdGF0ZSxcbiAgICAgIGZldGNoaW5nU2V0dGluZ3M6IGZhbHNlLFxuICAgIH0pLFxuICAgIFtBQ1RJT05TLkNPTU1FTlRfRkVUQ0hfU0VUVElOR1NfQ09NUExFVEVEXTogKHN0YXRlOiBDb21tZW50c1N0YXRlLCBhY3Rpb246IGFueSkgPT4ge1xuICAgICAgY29uc3QgeyBjaGFubmVsSWQsIHNldHRpbmdzLCBwYXJ0aWFsVXBkYXRlIH0gPSBhY3Rpb24uZGF0YTtcbiAgICAgIGNvbnN0IHNldHRpbmdzQnlDaGFubmVsSWQgPSBPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS5zZXR0aW5nc0J5Q2hhbm5lbElkKTtcblxuICAgICAgaWYgKHBhcnRpYWxVcGRhdGUpIHtcbiAgICAgICAgc2V0dGluZ3NCeUNoYW5uZWxJZFtjaGFubmVsSWRdID0ge1xuICAgICAgICAgIC8vIFRoZSBleGlzdGluZyBtYXkgY29udGFpbiBhZGRpdGlvbmFsIENyZWF0b3IgU2V0dGluZ3MgKGUuZy4gJ3dvcmRzJylcbiAgICAgICAgICAuLi4oc2V0dGluZ3NCeUNoYW5uZWxJZFtjaGFubmVsSWRdIHx8IHt9KSxcbiAgICAgICAgICAvLyBTcHJlYWQgbmV3IHNldHRpbmdzLlxuICAgICAgICAgIC4uLnNldHRpbmdzLFxuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2V0dGluZ3NCeUNoYW5uZWxJZFtjaGFubmVsSWRdID0gc2V0dGluZ3M7XG4gICAgICAgIGlmIChzZXR0aW5ncy53b3Jkcykge1xuICAgICAgICAgIHNldHRpbmdzQnlDaGFubmVsSWRbY2hhbm5lbElkXS53b3JkcyA9IHNldHRpbmdzLndvcmRzLnNwbGl0KCcsJyk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgIHNldHRpbmdzQnlDaGFubmVsSWQsXG4gICAgICAgIGZldGNoaW5nU2V0dGluZ3M6IGZhbHNlLFxuICAgICAgfTtcbiAgICB9LFxuXG4gICAgW0FDVElPTlMuQ09NTUVOVF9GRVRDSF9CTE9DS0VEX1dPUkRTX1NUQVJURURdOiAoc3RhdGU6IENvbW1lbnRzU3RhdGUsIGFjdGlvbjogYW55KSA9PiAoe1xuICAgICAgLi4uc3RhdGUsXG4gICAgICBmZXRjaGluZ0Jsb2NrZWRXb3JkczogdHJ1ZSxcbiAgICB9KSxcbiAgICBbQUNUSU9OUy5DT01NRU5UX0ZFVENIX0JMT0NLRURfV09SRFNfRkFJTEVEXTogKHN0YXRlOiBDb21tZW50c1N0YXRlLCBhY3Rpb246IGFueSkgPT4gKHtcbiAgICAgIC4uLnN0YXRlLFxuICAgICAgZmV0Y2hpbmdCbG9ja2VkV29yZHM6IGZhbHNlLFxuICAgIH0pLFxuICAgIFtBQ1RJT05TLkNPTU1FTlRfRkVUQ0hfQkxPQ0tFRF9XT1JEU19DT01QTEVURURdOiAoc3RhdGU6IENvbW1lbnRzU3RhdGUsIGFjdGlvbjogYW55KSA9PiB7XG4gICAgICBjb25zdCBibG9ja2VkV29yZHNCeUNoYW5uZWxJZCA9IGFjdGlvbi5kYXRhO1xuICAgICAgY29uc3Qgc2V0dGluZ3NCeUNoYW5uZWxJZCA9IE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLnNldHRpbmdzQnlDaGFubmVsSWQpO1xuXG4gICAgICAvLyBibG9ja2VkV29yZHNCeUNoYW5uZWxJZDoge3N0cmluZzogW3N0cmluZ119XG4gICAgICBPYmplY3QuZW50cmllcyhibG9ja2VkV29yZHNCeUNoYW5uZWxJZCkuZm9yRWFjaCgoeCkgPT4ge1xuICAgICAgICBjb25zdCBjaGFubmVsSWQgPSB4WzBdO1xuICAgICAgICBpZiAoIXNldHRpbmdzQnlDaGFubmVsSWRbY2hhbm5lbElkXSkge1xuICAgICAgICAgIHNldHRpbmdzQnlDaGFubmVsSWRbY2hhbm5lbElkXSA9IHt9O1xuICAgICAgICB9XG4gICAgICAgIHNldHRpbmdzQnlDaGFubmVsSWRbY2hhbm5lbElkXS53b3JkcyA9IHhbMV07XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgIHNldHRpbmdzQnlDaGFubmVsSWQsXG4gICAgICAgIGZldGNoaW5nQmxvY2tlZFdvcmRzOiBmYWxzZSxcbiAgICAgIH07XG4gICAgfSxcbiAgfSxcbiAgZGVmYXVsdFN0YXRlXG4pO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBNUNBO0FBZ0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFFQTtBQUZBO0FBRkE7QUFPQTtBQUVBO0FBRkE7QUFQQTtBQVlBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFKQTtBQUNBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFWQTtBQVlBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVZBO0FBekVBO0FBdUZBO0FBRUE7QUFGQTtBQXZGQTtBQTRGQTtBQUVBO0FBRkE7QUE1RkE7QUFrR0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUVBO0FBRkE7QUF0R0E7QUE2R0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUZBO0FBakhBO0FBd0hBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFFQTtBQUZBO0FBNUhBO0FBa0lBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUpBO0FBRkE7QUFEQTtBQVdBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFGQTtBQURBO0FBTUE7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFKQTtBQXZLQTtBQStLQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUhBO0FBdExBO0FBNkxBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUhBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFUQTtBQUFBO0FBYUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWRBO0FBdlJBO0FBeVNBO0FBQUE7QUFBQTtBQXpTQTtBQTJTQTtBQUFBO0FBQUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQWJBO0FBQ0E7QUFlQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVZBO0FBalZBO0FBK1ZBO0FBQUE7QUFBQTtBQUdBO0FBRUE7QUFGQTtBQWxXQTtBQTJXQTtBQUVBO0FBRkE7QUEzV0E7QUErV0E7QUFBQTtBQUFBO0FBL1dBO0FBaVhBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFFQTtBQUdBO0FBQ0E7QUFGQTtBQUtBO0FBVEE7QUFwWEE7QUFpWUE7QUFFQTtBQUZBO0FBallBO0FBc1lBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVRBO0FBemFBO0FBc2JBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUEE7QUFTQTtBQXJCQTtBQUNBO0FBQ0E7QUF1QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFQQTtBQUNBO0FBQ0E7QUFTQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXRCQTtBQXdCQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBbmZBO0FBNmZBO0FBRUE7QUFGQTtBQTdmQTtBQWlnQkE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFwQkE7QUFDQTtBQUNBO0FBc0JBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQTFpQkE7QUFvakJBO0FBRUE7QUFGQTtBQXBqQkE7QUF3akJBO0FBRUE7QUFGQTtBQXhqQkE7QUE0akJBO0FBRUE7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUhBO0FBamtCQTtBQXVrQkE7QUFFQTtBQUZBO0FBdmtCQTtBQTRrQkE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFKQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFBQTtBQUFBO0FBQUE7QUFRQTtBQUVBO0FBQ0E7QUFDQTtBQUpBO0FBUkE7QUFlQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBSkE7QUFqb0JBO0FBd3BCQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQWpxQkE7QUFvcUJBO0FBRUE7QUFGQTtBQXBxQkE7QUF3cUJBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFXQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFUQTtBQW5yQkE7QUErckJBO0FBRUE7QUFGQTtBQS9yQkE7QUFvc0JBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFGQTtBQUNBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUZBO0FBdkJBO0FBdnNCQTtBQXF1QkE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUZBO0FBQ0E7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRkE7QUF2QkE7QUF4dUJBO0FBc3dCQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRkE7QUFDQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUZBO0FBbkJBO0FBendCQTtBQW15QkE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUZBO0FBQ0E7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFGQTtBQW5CQTtBQXR5QkE7QUFnMEJBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFKQTtBQU1BO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQUNBO0FBQ0E7QUFRQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFqQkE7QUFDQTtBQUNBO0FBbUJBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFKQTtBQXpEQTtBQTcwQkE7QUE4NEJBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFIQTtBQUtBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBSEE7QUFLQTtBQXJEQTtBQWw1QkE7QUEyOEJBO0FBRUE7QUFGQTtBQTM4QkE7QUErOEJBO0FBRUE7QUFGQTtBQS84QkE7QUFvOUJBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFEQTtBQURBO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBSEE7QUFoK0JBO0FBdStCQTtBQUVBO0FBRkE7QUF2K0JBO0FBNCtCQTtBQUVBO0FBRkE7QUE1K0JBO0FBay9CQTtBQUVBO0FBQ0E7QUFIQTtBQWwvQkE7QUF5L0JBO0FBRUE7QUFGQTtBQXovQkE7QUE2L0JBO0FBRUE7QUFGQTtBQTcvQkE7QUFpZ0NBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQVFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBSEE7QUFuaENBO0FBMGhDQTtBQUVBO0FBRkE7QUExaENBO0FBOGhDQTtBQUVBO0FBRkE7QUE5aENBO0FBbWlDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBTEE7QUFRQTtBQUVBO0FBQ0E7QUFIQTtBQS9pQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///../ui/redux/reducers/comments.js\n");

/***/ })

})